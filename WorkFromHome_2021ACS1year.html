<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Work From Home: Who Can and Who Does?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="WorkFromHome_2021ACS1year_files/libs/clipboard/clipboard.min.js"></script>
<script src="WorkFromHome_2021ACS1year_files/libs/quarto-html/quarto.js"></script>
<script src="WorkFromHome_2021ACS1year_files/libs/quarto-html/popper.min.js"></script>
<script src="WorkFromHome_2021ACS1year_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="WorkFromHome_2021ACS1year_files/libs/quarto-html/anchor.min.js"></script>
<link href="WorkFromHome_2021ACS1year_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="WorkFromHome_2021ACS1year_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="WorkFromHome_2021ACS1year_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="WorkFromHome_2021ACS1year_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="WorkFromHome_2021ACS1year_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="WorkFromHome_2021ACS1year_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="WorkFromHome_2021ACS1year_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#getting-data" id="toc-getting-data" class="nav-link active" data-scroll-target="#getting-data">Getting Data</a></li>
  <li><a href="#acs-data-notes" id="toc-acs-data-notes" class="nav-link" data-scroll-target="#acs-data-notes">ACS data Notes</a>
  <ul class="collapse">
  <li><a href="#year-data" id="toc-year-data" class="nav-link" data-scroll-target="#year-data">2021 1-Year Data</a>
  <ul class="collapse">
  <li><a href="#occupation-codes" id="toc-occupation-codes" class="nav-link" data-scroll-target="#occupation-codes">Occupation codes</a></li>
  </ul></li>
  <li><a href="#pumas-and-shapefiles" id="toc-pumas-and-shapefiles" class="nav-link" data-scroll-target="#pumas-and-shapefiles">PUMAs and Shapefiles</a></li>
  </ul></li>
  <li><a href="#stuff-im-not-ready-to-delete-yet" id="toc-stuff-im-not-ready-to-delete-yet" class="nav-link" data-scroll-target="#stuff-im-not-ready-to-delete-yet">Stuff I’m not ready to delete yet</a>
  <ul class="collapse">
  <li><a href="#chatgpt-attempt" id="toc-chatgpt-attempt" class="nav-link" data-scroll-target="#chatgpt-attempt">ChatGPT attempt</a>
  <ul class="collapse">
  <li><a href="#summary-tables-of-households-in-il-state-2016-2020-acs" id="toc-summary-tables-of-households-in-il-state-2016-2020-acs" class="nav-link" data-scroll-target="#summary-tables-of-households-in-il-state-2016-2020-acs">Summary tables of Households in IL State, 2016-2020 ACS</a></li>
  </ul></li>
  <li><a href="#acs-2019-5-year-data---original-download" id="toc-acs-2019-5-year-data---original-download" class="nav-link" data-scroll-target="#acs-2019-5-year-data---original-download">ACS 2019 5-year Data - Original Download</a>
  <ul class="collapse">
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  </ul></li>
  <li><a href="#xiaoyans-merging-notes" id="toc-xiaoyans-merging-notes" class="nav-link" data-scroll-target="#xiaoyans-merging-notes">Xiaoyan’s Merging Notes</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Work From Home: Who Can and Who Does?</h1>
<p class="subtitle lead">Using 2021 1-Year ACS Data</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="getting-data" class="level1">
<h1>Getting Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reldist)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pollster)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(weights)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tigris)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ipumsr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("naniar")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="acs-data-notes" class="level1">
<h1>ACS data Notes</h1>
<ul>
<li><p>INCWAGE is topcoded only at the 99.5th percentile within a state. So almost ALL obs should be close their actual income.</p>
<ul>
<li>Incwage coding procedure <a href="https://usa.ipums.org/usa-action/variables/INCWAGE#editing_procedure_section">link</a></li>
</ul></li>
<li><p>INCTOT includes self-employment income, INCWAGE does not.</p>
<ul>
<li>Some industries (e.g.&nbsp;farming) may not be included in sample if using INCWAGE. Does that matter?</li>
<li>Bottom coded at -$19,988, is not top coded</li>
</ul></li>
<li><p>INCEARN includes salaries, wages, and business/farm income. Use this one I think</p>
<ul>
<li><p>INCEARN is made from summing INCWAGE, INCBUS, and INCFARM</p></li>
<li><p>INCEARN is not itself topcoded, but some of the other variables may be, especially for early years of data collection (which don’t apply to us)</p></li>
</ul></li>
</ul>
<section id="year-data" class="level2">
<h2 class="anchored" data-anchor-id="year-data">2021 1-Year Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ddi &lt;- read_ipums_ddi("usa_00009.xml") # 45 variables</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># same sample but with 150+ variables. </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>ddi <span class="ot">&lt;-</span> <span class="fu">read_ipums_ddi</span>(<span class="st">"usa_00011.xml"</span>) <span class="co"># downloaded April 10 2023</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_ipums_micro</span>(ddi) <span class="co"># 126623 observations before any filtering</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Use of data from IPUMS USA is subject to conditions including that users should
cite the data appropriately. Use command `ipums_conditions()` for more details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same sample but with 150+ variables. </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ddi &lt;- read_ipums_ddi("C:/Users/aleaw/Box/Fiscal Futures/FY22_Working/WFH/Data/IL_2021_1yrACSlabels.xml") # downloaded April 10 2023</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(INCEARN, INCWAGE, INCTOT,TRANWORK, OCCSOC,CLASSWKR, EMPSTAT, LABFORCE, PERWT, COUNTYFIP, PUMA, PWSTATE2, AGE, STRATA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="occupation-codes" class="level3">
<h3 class="anchored" data-anchor-id="occupation-codes">Occupation codes</h3>
<p><code>OCC2010</code> is a harmonized occupation coding scheme as broad groups. These are 4 characters long and are the first 4 characters of the longer ONET &amp; SOC codes.</p>
<p><code>OCCSOC</code> is 6 digits long. It is the first 6 digits of 8-digit ONET code.</p>
<ul>
<li>Please note that in some cases the SOC occupation codes are aggregated if they do not have an exact match to a Census occupation code or to preserve confidentiality in cases where the category contained fewer than 10,000 people nationwide.</li>
</ul>
<p><code>LABFORCE</code> for if in labor force. 1 = not in labor force, 2 = in labor force, 0 is NA</p>
<p><code>EMPSTAT</code> and <code>EMPSTATD</code> for employment status (simple and the detailed version). 1=employed, 2=unemployed, 3=not in labor force for empstat, 0 is NA</p>
<p><code>CLASSWKRD</code> might be useful. Contains info on self-employed, wages, salary, etc for class of worker.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For persons who are unemployed, the data refer to the most recent job if it was within the last 5 years.</p>
</div>
</div>
<p>IPUMS <a href="https://usa.ipums.org/usa/repwt.shtml">link for Survey package</a></p>
<p>IPUMS OCC codes over time <a href="https://usa.ipums.org/usa/volii/occsoc18.shtml">link</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replaces 0 with NA for variables listed. Allows topline to calculate "Valid Percent" when it recognizes missing values</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">replace_with_na</span>(<span class="at">replace =</span> <span class="fu">list</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">EMPSTAT=</span> <span class="fu">c</span>(<span class="dv">0</span>), </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">LABFORCE=</span><span class="fu">c</span>(<span class="dv">0</span>), </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CLASSWKR =</span> <span class="fu">c</span>(<span class="dv">0</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">TRANWORK =</span> <span class="fu">c</span>(<span class="st">"N/A"</span>,<span class="st">"0"</span>)))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>EMPSTAT) <span class="co"># unweighted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     3 
59259  4194 41289 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">as_factor</span>(EMPSTAT)) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">weightedcount=</span><span class="fu">sum</span>(PERWT),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">unweightedcount =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span>  <span class="co">#weighted</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_weight =</span> weightedcount<span class="sc">/</span><span class="fu">sum</span>(weightedcount),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_noweight =</span> unweightedcount<span class="sc">/</span><span class="fu">sum</span>(unweightedcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["as_factor(EMPSTAT)"],"name":[1],"type":["fct"],"align":["left"]},{"label":["weightedcount"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["unweightedcount"],"name":[3],"type":["int"],"align":["right"]},{"label":["pct_weight"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pct_noweight"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employed","2":"6102522","3":"59259","4":"0.48159546","5":"0.46799555"},{"1":"Unemployed","2":"479879","3":"4194","4":"0.03787083","5":"0.03312194"},{"1":"Not in labor force","2":"3625811","3":"41289","4":"0.28613975","5":"0.32607820"},{"1":"NA","2":"2463257","3":"21881","4":"0.19439396","5":"0.17280431"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topline</span>(data, EMPSTAT, PERWT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `EMPSTAT = forcats::fct_explicit_na(EMPSTAT)`.
Caused by warning:
! `fct_explicit_na()` was deprecated in forcats 1.0.0.
ℹ Please use `fct_na_value_to_level()` instead.
ℹ The deprecated feature was likely used in the pollster package.
  Please report the issue to the authors.</code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Response"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Frequency"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Valid Percent"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Cumulative Percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employed","2":"6102522","3":"48.159546","4":"59.780518","5":"59.78052"},{"1":"Unemployed","2":"479879","3":"3.787083","4":"4.700911","5":"64.48143"},{"1":"Not in labor force","2":"3625811","3":"28.613975","4":"35.518571","5":"100.00000"},{"1":"(Missing)","2":"2463257","3":"19.439396","4":"NA","5":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">as_factor</span>(LABFORCE)) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">weightedcount=</span><span class="fu">sum</span>(PERWT),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">unweightedcount =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span>  <span class="co">#weighted</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_weight =</span> weightedcount<span class="sc">/</span><span class="fu">sum</span>(weightedcount),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_noweight =</span> unweightedcount<span class="sc">/</span><span class="fu">sum</span>(unweightedcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["as_factor(LABFORCE)"],"name":[1],"type":["fct"],"align":["left"]},{"label":["weightedcount"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["unweightedcount"],"name":[3],"type":["int"],"align":["right"]},{"label":["pct_weight"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pct_noweight"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"No, not in the labor force","2":"3625811","3":"41289","4":"0.2861398","5":"0.3260782"},{"1":"Yes, in the labor force","2":"6582401","3":"63453","4":"0.5194663","5":"0.5011175"},{"1":"NA","2":"2463257","3":"21881","4":"0.1943940","5":"0.1728043"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">as_factor</span>(CLASSWKR)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">weightedcount=</span><span class="fu">sum</span>(PERWT),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">unweightedcount =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span>  <span class="co">#weighted</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_weight =</span> weightedcount<span class="sc">/</span><span class="fu">sum</span>(weightedcount),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_noweight =</span> unweightedcount<span class="sc">/</span><span class="fu">sum</span>(unweightedcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["as_factor(CLASSWKR)"],"name":[1],"type":["fct"],"align":["left"]},{"label":["weightedcount"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["unweightedcount"],"name":[3],"type":["int"],"align":["right"]},{"label":["pct_weight"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["pct_noweight"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Self-employed","2":"690965","3":"7183","4":"0.05452919","5":"0.05672745"},{"1":"Works for wages","2":"6926530","3":"68388","4":"0.54662407","5":"0.54009145"},{"1":"NA","2":"5053974","3":"51052","4":"0.39884673","5":"0.40318110"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data %&gt;% </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(as_factor(TRANWORK)) %&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::summarize(weightedcount=sum(PERWT),</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                    unweightedcount = n()) %&gt;%  #weighted</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(pct_weight = weightedcount/sum(weightedcount),</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          pct_noweight = unweightedcount/sum(unweightedcount))</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">topline</span>(<span class="at">df =</span> data, <span class="at">variable =</span> LABFORCE, <span class="at">weight =</span> PERWT )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Response"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Frequency"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Valid Percent"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Cumulative Percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"No, not in the labor force","2":"3625811","3":"28.61398","4":"35.51857","5":"35.51857"},{"1":"Yes, in the labor force","2":"6582401","3":"51.94663","4":"64.48143","5":"100.00000"},{"1":"(Missing)","2":"2463257","3":"19.43940","4":"NA","5":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><em>Unweighted -</em></p>
<p><em>EMPSTAT: 59,259 observations are employed, 4,194 unemployed observations, and 41,289 observations are not in the workforce (21,881 NAs)</em></p>
<p><em>LABFORCE: 63,453 are in labor force, 41,289 are not. (21,881 NAs)</em></p>
<p><em>CLASSWKR: Of these, 68,388 work for wages and 7183 people are self-employed. (51,052 NA)</em></p>
<p><u><strong>Weighted</strong></u> <strong>-</strong></p>
<p>EMPSTAT: 6,102,522 people are employed (49%), 479,879people are unemployed(3.8%), and 3,624,811 are not in the labor force (29%). There are 2,463,257 missing values; Same as LABFORCE.</p>
<p>LABFORCE: 6,582,401 people (52%) are in the labor force. 3,625,811 (28%) of people are not in the labor force. 2,463,257 (20%) of observations missing values.</p>
<ul>
<li>employed and unemployed equal number of people in labor force - that’s good</li>
</ul>
<p>Location of primary workplace: 5.8 million people located in Illinois.</p>
<p>Compare average income for counties in Illinois to Summary tables from Census.</p>
<p>For the counties that can be identified in the data (populations &gt; 60,000 or 100,000 or 200,000? Double check), the census summary tables are close but not identical to the tables calculated with the ACS sample data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">as_factor</span>(EMPSTAT), COUNTYFIP) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">weightedcount=</span><span class="fu">sum</span>(PERWT),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">unweightedcount =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span>  <span class="co">#weighted</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_weight =</span> weightedcount<span class="sc">/</span><span class="fu">sum</span>(weightedcount),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_noweight =</span> unweightedcount<span class="sc">/</span><span class="fu">sum</span>(unweightedcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'as_factor(EMPSTAT)'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["as_factor(EMPSTAT)"],"name":[1],"type":["fct"],"align":["left"]},{"label":["COUNTYFIP"],"name":[2],"type":["dbl+lbl"],"align":["right"]},{"label":["weightedcount"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["unweightedcount"],"name":[4],"type":["int"],"align":["right"]},{"label":["pct_weight"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["pct_noweight"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employed","2":"0","3":"1053559","4":"14831","5":"0.172643212","6":"0.250274220"},{"1":"Employed","2":"19","3":"102960","4":"962","5":"0.016871713","6":"0.016233821"},{"1":"Employed","2":"31","3":"2512888","4":"20088","5":"0.411778606","6":"0.338986483"},{"1":"Employed","2":"37","3":"52945","4":"529","5":"0.008675921","6":"0.008926914"},{"1":"Employed","2":"43","3":"475704","4":"4889","5":"0.077952034","6":"0.082502236"},{"1":"Employed","2":"89","3":"262196","4":"2070","5":"0.042965187","6":"0.034931403"},{"1":"Employed","2":"91","3":"50962","4":"594","5":"0.008350974","6":"0.010023794"},{"1":"Employed","2":"97","3":"357181","4":"3479","5":"0.058530063","6":"0.058708382"},{"1":"Employed","2":"99","3":"51354","4":"673","5":"0.008415209","6":"0.011356925"},{"1":"Employed","2":"111","3":"162846","4":"1469","5":"0.026685033","6":"0.024789483"},{"1":"Employed","2":"113","3":"87051","4":"979","5":"0.014264758","6":"0.016520697"},{"1":"Employed","2":"115","3":"41785","4":"515","5":"0.006847169","6":"0.008690663"},{"1":"Employed","2":"119","3":"125376","4":"1129","5":"0.020544948","6":"0.019051958"},{"1":"Employed","2":"143","3":"80808","4":"787","5":"0.013241738","6":"0.013280683"},{"1":"Employed","2":"161","3":"62231","4":"691","5":"0.010197587","6":"0.011660676"},{"1":"Employed","2":"163","3":"119921","4":"905","5":"0.019651056","6":"0.015271942"},{"1":"Employed","2":"167","3":"88121","4":"962","5":"0.014440095","6":"0.016233821"},{"1":"Employed","2":"179","3":"62616","4":"747","5":"0.010260676","6":"0.012605680"},{"1":"Employed","2":"197","3":"352018","4":"2960","5":"0.057684020","6":"0.049950219"},{"1":"Unemployed","2":"0","3":"73573","4":"922","5":"0.153315732","6":"0.219837864"},{"1":"Unemployed","2":"19","3":"4481","4":"34","5":"0.009337771","6":"0.008106819"},{"1":"Unemployed","2":"31","3":"236043","4":"1789","5":"0.491880245","6":"0.426561755"},{"1":"Unemployed","2":"37","3":"2418","4":"22","5":"0.005038770","6":"0.005245589"},{"1":"Unemployed","2":"43","3":"31027","4":"288","5":"0.064655882","6":"0.068669528"},{"1":"Unemployed","2":"89","3":"18036","4":"152","5":"0.037584474","6":"0.036242251"},{"1":"Unemployed","2":"91","3":"3065","4":"38","5":"0.006387027","6":"0.009060563"},{"1":"Unemployed","2":"97","3":"25336","4":"216","5":"0.052796642","6":"0.051502146"},{"1":"Unemployed","2":"99","3":"4695","4":"47","5":"0.009783716","6":"0.011206485"},{"1":"Unemployed","2":"111","3":"10626","4":"89","5":"0.022143082","6":"0.021220792"},{"1":"Unemployed","2":"113","3":"3321","4":"45","5":"0.006920495","6":"0.010729614"},{"1":"Unemployed","2":"115","3":"5846","4":"44","5":"0.012182238","6":"0.010491178"},{"1":"Unemployed","2":"119","3":"6917","4":"54","5":"0.014414050","6":"0.012875536"},{"1":"Unemployed","2":"143","3":"6232","4":"54","5":"0.012986607","6":"0.012875536"},{"1":"Unemployed","2":"161","3":"6064","4":"62","5":"0.012636519","6":"0.014783023"},{"1":"Unemployed","2":"163","3":"8344","4":"62","5":"0.017387716","6":"0.014783023"},{"1":"Unemployed","2":"167","3":"8002","4":"58","5":"0.016675037","6":"0.013829280"},{"1":"Unemployed","2":"179","3":"3345","4":"36","5":"0.006970507","6":"0.008583691"},{"1":"Unemployed","2":"197","3":"22508","4":"182","5":"0.046903490","6":"0.043395327"},{"1":"Not in labor force","2":"0","3":"795877","4":"13094","5":"0.219503168","6":"0.317130471"},{"1":"Not in labor force","2":"19","3":"62173","4":"712","5":"0.017147336","6":"0.017244302"},{"1":"Not in labor force","2":"31","3":"1442085","4":"12678","5":"0.397727570","6":"0.307055148"},{"1":"Not in labor force","2":"37","3":"25143","4":"340","5":"0.006934449","6":"0.008234639"},{"1":"Not in labor force","2":"43","3":"236756","4":"2812","5":"0.065297391","6":"0.068105306"},{"1":"Not in labor force","2":"89","3":"123348","4":"1067","5":"0.034019424","6":"0.025842234"},{"1":"Not in labor force","2":"91","3":"31806","4":"445","5":"0.008772106","6":"0.010777689"},{"1":"Not in labor force","2":"97","3":"182664","4":"1987","5":"0.050378798","6":"0.048124198"},{"1":"Not in labor force","2":"99","3":"33673","4":"520","5":"0.009287026","6":"0.012594153"},{"1":"Not in labor force","2":"111","3":"75451","4":"785","5":"0.020809413","6":"0.019012328"},{"1":"Not in labor force","2":"113","3":"48821","4":"590","5":"0.013464850","6":"0.014289520"},{"1":"Not in labor force","2":"115","3":"35192","4":"455","5":"0.009705966","6":"0.011019884"},{"1":"Not in labor force","2":"119","3":"81694","4":"863","5":"0.022531235","6":"0.020901451"},{"1":"Not in labor force","2":"143","3":"54378","4":"616","5":"0.014997472","6":"0.014919228"},{"1":"Not in labor force","2":"161","3":"45596","4":"585","5":"0.012575393","6":"0.014168423"},{"1":"Not in labor force","2":"163","3":"73662","4":"722","5":"0.020316007","6":"0.017486498"},{"1":"Not in labor force","2":"167","3":"60549","4":"746","5":"0.016699436","6":"0.018067766"},{"1":"Not in labor force","2":"179","3":"38066","4":"507","5":"0.010498617","6":"0.012279300"},{"1":"Not in labor force","2":"197","3":"178877","4":"1765","5":"0.049334342","6":"0.042747463"},{"1":"NA","2":"0","3":"455049","4":"5948","5":"0.184734683","6":"0.271834011"},{"1":"NA","2":"19","3":"35411","4":"278","5":"0.014375682","6":"0.012705087"},{"1":"NA","2":"31","3":"982895","4":"6851","5":"0.399022514","6":"0.313102692"},{"1":"NA","2":"37","3":"19587","4":"204","5":"0.007951667","6":"0.009323157"},{"1":"NA","2":"43","3":"181091","4":"1736","5":"0.073516892","6":"0.079338239"},{"1":"NA","2":"89","3":"111493","4":"723","5":"0.045262431","6":"0.033042366"},{"1":"NA","2":"91","3":"21202","4":"218","5":"0.008607303","6":"0.009962982"},{"1":"NA","2":"97","3":"144864","4":"1370","5":"0.058809941","6":"0.062611398"},{"1":"NA","2":"99","3":"19396","4":"253","5":"0.007874128","6":"0.011562543"},{"1":"NA","2":"111","3":"62482","4":"507","5":"0.025365603","6":"0.023170787"},{"1":"NA","2":"113","3":"32218","4":"356","5":"0.013079431","6":"0.016269823"},{"1":"NA","2":"115","3":"19492","4":"187","5":"0.007913100","6":"0.008546227"},{"1":"NA","2":"119","3":"50673","4":"439","5":"0.020571544","6":"0.020063068"},{"1":"NA","2":"143","3":"38435","4":"369","5":"0.015603325","6":"0.016863946"},{"1":"NA","2":"161","3":"28858","4":"259","5":"0.011715383","6":"0.011836753"},{"1":"NA","2":"163","3":"52854","4":"393","5":"0.021456957","6":"0.017960788"},{"1":"NA","2":"167","3":"37379","4":"340","5":"0.015174624","6":"0.015538595"},{"1":"NA","2":"179","3":"26409","4":"313","5":"0.010721171","6":"0.014304648"},{"1":"NA","2":"197","3":"143469","4":"1137","5":"0.058243618","6":"0.051962890"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crosstab</span>(data, COUNTYFIP, EMPSTAT, <span class="at">weight=</span>PERWT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["COUNTYFIP"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Employed"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Unemployed"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Not in labor force"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"County not identifiable from public-use data (1950-onward)*","2":"54.78700","3":"3.825931","4":"41.38707","5":"1923009"},{"1":"19","2":"60.70254","3":"2.641881","4":"36.65558","5":"169614"},{"1":"31","2":"59.95892","3":"5.632119","4":"34.40896","5":"4191016"},{"1":"37","2":"65.76528","3":"3.003503","4":"31.23121","5":"80506"},{"1":"43","2":"63.98283","3":"4.173173","4":"31.84400","5":"743487"},{"1":"89","2":"64.96754","3":"4.469002","4":"30.56346","5":"403580"},{"1":"91","2":"59.37343","3":"3.570888","4":"37.05568","5":"85833"},{"1":"97","2":"63.19763","3":"4.482812","4":"32.31956","5":"565181"},{"1":"99","2":"57.23680","3":"5.232830","4":"37.53037","5":"89722"},{"1":"111","2":"65.42023","3":"4.268790","4":"30.31098","5":"248923"},{"1":"113","2":"62.53978","3":"2.385896","4":"35.07432","5":"139193"},{"1":"115","2":"50.45096","3":"7.058426","4":"42.49061","5":"82823"},{"1":"119","2":"58.59048","3":"3.232439","4":"38.17709","5":"213987"},{"1":"143","2":"57.14124","3":"4.406794","4":"38.45197","5":"141418"},{"1":"161","2":"54.64084","3":"5.324389","4":"40.03477","5":"113891"},{"1":"163","2":"59.38829","3":"4.132186","4":"36.47952","5":"201927"},{"1":"167","2":"56.24553","3":"5.107486","4":"38.64698","5":"156672"},{"1":"179","2":"60.19207","3":"3.215511","4":"36.59242","5":"104027"},{"1":"197","2":"63.60970","3":"4.067199","4":"32.32310","5":"553403"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>19 is Champaign, 31 is Cook, 37 is DeKalb, 43 is DuPage, 89 is Kane, 111 is McHenry, etc.</p>
<p>Economic Characteristics summary table: <a href="https://data.census.gov/table?t=Employment&amp;g=040XX00US17,17$0500000&amp;tid=ACSDP1Y2021.DP03&amp;moe=false&amp;tp=false">link</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># State worked in:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#0=NA, 17=Illinois</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ipums_var_desc(data, PWSTATE2)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PWSTATE2_clean =</span> <span class="fu">as_factor</span>(<span class="fu">lbl_na_if</span>(PWSTATE2, <span class="sc">~</span>.val <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>))))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PWSTATE2) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">sum</span>(PERWT)) <span class="sc">%&gt;%</span> <span class="co">#number of people that match that observation</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pct))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["PWSTATE2"],"name":[1],"type":["int+lbl"],"align":["right"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["pct"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"6694338","3":"5.283001e-01"},{"1":"17","2":"5792408","3":"4.571221e-01"},{"1":"29","2":"65391","3":"5.160491e-03"},{"1":"19","2":"35106","3":"2.770476e-03"},{"1":"18","2":"31262","3":"2.467117e-03"},{"1":"55","2":"30124","3":"2.377309e-03"},{"1":"21","2":"6720","3":"5.303253e-04"},{"1":"26","2":"2601","3":"2.052643e-04"},{"1":"36","2":"1672","3":"1.319500e-04"},{"1":"6","2":"1218","3":"9.612145e-05"},{"1":"48","2":"1106","3":"8.728270e-05"},{"1":"12","2":"986","3":"7.781260e-05"},{"1":"13","2":"931","3":"7.347214e-05"},{"1":"4","2":"798","3":"6.297612e-05"},{"1":"42","2":"768","3":"6.060860e-05"},{"1":"45","2":"684","3":"5.397953e-05"},{"1":"39","2":"576","3":"4.545645e-05"},{"1":"51","2":"517","3":"4.080032e-05"},{"1":"25","2":"509","3":"4.016898e-05"},{"1":"47","2":"418","3":"3.298749e-05"},{"1":"31","2":"400","3":"3.156698e-05"},{"1":"83","2":"311","3":"2.454333e-05"},{"1":"34","2":"280","3":"2.209689e-05"},{"1":"24","2":"262","3":"2.067637e-05"},{"1":"27","2":"246","3":"1.941369e-05"},{"1":"20","2":"231","3":"1.822993e-05"},{"1":"53","2":"178","3":"1.404731e-05"},{"1":"30","2":"174","3":"1.373164e-05"},{"1":"8","2":"137","3":"1.081169e-05"},{"1":"1","2":"120","3":"9.470094e-06"},{"1":"82","2":"117","3":"9.233341e-06"},{"1":"28","2":"115","3":"9.075507e-06"},{"1":"5","2":"106","3":"8.365250e-06"},{"1":"56","2":"92","3":"7.260405e-06"},{"1":"37","2":"82","3":"6.471231e-06"},{"1":"11","2":"80","3":"6.313396e-06"},{"1":"2","2":"76","3":"5.997726e-06"},{"1":"46","2":"74","3":"5.839891e-06"},{"1":"85","2":"61","3":"4.813964e-06"},{"1":"49","2":"59","3":"4.656129e-06"},{"1":"86","2":"59","3":"4.656129e-06"},{"1":"22","2":"50","3":"3.945872e-06"},{"1":"54","2":"26","3":"2.051854e-06"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCEARN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  -8000       0    1000   30361   42000  949000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 999999 is missing values and want positive income values</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(INCEARN<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> INCWAGE <span class="sc">!=</span> <span class="dv">999999</span> <span class="sc">&amp;</span> INCWAGE <span class="sc">!=</span> <span class="dv">999998</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AGE <span class="sc">&gt;</span> <span class="dv">25</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 104,689 obs remaining if &gt;=0</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 65113 obs if &gt; 0</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 55332 observations if also older than 25</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCEARN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1   25000   48000   66320   80000  949000 </code></pre>
</div>
</div>
<p>Xiaoyan decile cutoffs:</p>
<p>summarize incearn, detail</p>
<p>*generate percentile and percent (equal frequency)</p>
<p>pctile pct=incearn, nq(10) genp(percent)</p>
<p>list percent pct in 1/10</p>
<p>*how to incorporate svy weight in dividing the percentiles?</p>
<p>*generate percentile range based on perentile calculation</p>
<p>gen pctr=“(0,10%]” if incearn&lt;= 2024</p>
<p>replace pctr=“(10%,20%]” if incearn&gt; 2024&amp;incearn&lt;=13558</p>
<p>replace pctr=“(20%,30%]” if incearn&gt;13558&amp;incearn&lt;=23417</p>
<p>replace pctr=“(30%,40%]” if incearn&gt;23417&amp;incearn&lt;=31961</p>
<p>replace pctr=“(40%,50%]” if incearn&gt;31961&amp;incearn&lt;=40725</p>
<p>replace pctr=“(50%,60%]” if incearn&gt;40725&amp;incearn&lt;=51104</p>
<p>replace pctr=“(60%,70%]” if incearn&gt;51104&amp;incearn&lt;=63922</p>
<p>replace pctr=“(70%,80%]” if incearn&gt;63922&amp;incearn&lt;=81000</p>
<p>replace pctr=“(80%,90%]” if incearn&gt;81000&amp;incearn&lt;=111993</p>
<p>replace pctr=“(90%,100%]” if incearn&gt;111993</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>telework<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"teleworkable2018onward.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 1881 Columns: 9
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(2): occ_codes, Notes dbl (1): teleworkable lgl (6): ...3, ...4, ...5, ...6,
...7, ...8
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...3`
• `` -&gt; `...4`
• `` -&gt; `...5`
• `` -&gt; `...6`
• `` -&gt; `...7`
• `` -&gt; `...8`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>telework <span class="ot">&lt;-</span> telework <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CanWorkFromHome =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  teleworkable <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No WFH"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  teleworkable <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Some WFH"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  teleworkable <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Can WFH"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Check Me"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(telework<span class="sc">$</span>CanWorkFromHome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Can WFH   No WFH Some WFH 
     480     1135      266 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># causes problems for any occupation code that has XX in it!! </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data2$OCCSOC_num &lt;- as.numeric(data2$OCCSOC)</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>joined<span class="ot">&lt;-</span><span class="fu">left_join</span>(data, telework, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span><span class="ot">=</span> <span class="st">"occ_codes"</span>))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(joined<span class="sc">$</span>teleworkable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.0000  0.4256  1.0000  1.0000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># teleworkable values are an average of occupations with same first 5 digits and first 4 digits.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>joined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(teleworkable<span class="sc">==</span><span class="st">"Some WFH"</span>) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(OCCSOC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["OCCSOC"],"name":[1],"type":["chr"],"align":["left"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'srvyr'

The following object is masked from 'package:Hmisc':

    summarize

The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dstrata <span class="ot">&lt;-</span> joined <span class="sc">%&gt;%</span> <span class="fu">as_survey</span>(<span class="at">strata =</span> STRATA , <span class="at">weights =</span> PERWT)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>dstrata <span class="ot">&lt;-</span> dstrata <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentile =</span> <span class="fu">ntile</span>(INCEARN,<span class="dv">100</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">decile =</span> <span class="fu">ntile</span>(INCEARN, <span class="dv">10</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>         <span class="co">#,decile2 = survey_quantile(INCEARN, c(0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9)))</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>dstrata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stratified Independent Sampling design (with replacement)
Called via srvyr
Sampling variables:
 - ids: `1`
 - strata: STRATA
 - weights: PERWT
Data variables: INCEARN (dbl+lbl), INCWAGE (dbl+lbl), INCTOT (dbl+lbl),
  TRANWORK (int+lbl), OCCSOC (chr), CLASSWKR (int+lbl), EMPSTAT (int+lbl),
  LABFORCE (int+lbl), PERWT (dbl), COUNTYFIP (dbl+lbl), PUMA (dbl+lbl),
  PWSTATE2 (int+lbl), AGE (int+lbl), STRATA (dbl), PWSTATE2_clean (fct),
  teleworkable (dbl), ...3 (lgl), ...4 (lgl), ...5 (lgl), ...6 (lgl), ...7
  (lgl), ...8 (lgl), Notes (chr), CanWorkFromHome (chr), percentile (int),
  decile (int)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>summary <span class="ot">&lt;-</span> dstrata <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decile) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">min =</span> <span class="fu">min</span>(INCEARN),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">max=</span><span class="fu">max</span>(INCEARN),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_income =</span> <span class="fu">mean</span>(INCEARN),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">average_income =</span> <span class="fu">survey_mean</span>(INCEARN),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">pop_represented =</span> <span class="fu">sum</span>(PERWT),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">obs_count =</span> <span class="fu">n</span>())</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(summary<span class="sc">$</span>pop_represented)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5577485</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>summary </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["decile"],"name":[1],"type":["int"],"align":["right"]},{"label":["min"],"name":[2],"type":["dbl+lbl"],"align":["right"]},{"label":["max"],"name":[3],"type":["dbl+lbl"],"align":["right"]},{"label":["avg_income"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["average_income"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["average_income_se"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["pop_represented"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["obs_count"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"10000","4":"4432.085","5":"4443.862","6":"51.78869","7":"523809","8":"5534"},{"1":"2","2":"10000","3":"20000","4":"15062.194","5":"15082.844","6":"58.08256","7":"559596","8":"5534"},{"1":"3","2":"20000","3":"30000","4":"25202.556","5":"25222.990","6":"57.35135","7":"560981","8":"5533"},{"1":"4","2":"30000","3":"39000","4":"33757.302","5":"33728.342","6":"47.59755","7":"571019","8":"5533"},{"1":"5","2":"39000","3":"48000","4":"42615.317","5":"42600.541","6":"48.22652","7":"574792","8":"5533"},{"1":"6","2":"48000","3":"60000","4":"52572.490","5":"52522.642","6":"56.07018","7":"539450","8":"5533"},{"1":"7","2":"60000","3":"72000","4":"64919.367","5":"64935.838","6":"74.00542","7":"562806","8":"5533"},{"1":"8","2":"72000","3":"90000","4":"81100.672","5":"81145.790","6":"97.43023","7":"572790","8":"5533"},{"1":"9","2":"90000","3":"125000","4":"105881.984","5":"105636.268","6":"162.76269","7":"566393","8":"5533"},{"1":"10","2":"125000","3":"949000","4":"237677.399","5":"236950.094","6":"2391.58751","7":"545849","8":"5533"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>summary <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>decile, <span class="at">y=</span>average_income)) <span class="sc">+</span> <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>dstrata <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>decile)) <span class="sc">+</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>CanWorkFromHome), <span class="at">position=</span><span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `as_data_frame()` was deprecated in tibble 2.0.0.
ℹ Please use `as_tibble()` (with slightly different semantics) to convert to a
  tibble, or `as.data.frame()` to convert to a data frame.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dstrata <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>decile)) <span class="sc">+</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> (..count..<span class="sc">/</span><span class="fu">sum</span>(..count..)), <span class="at">fill=</span>CanWorkFromHome), <span class="at">position=</span><span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dstrata <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>decile, <span class="at">y =</span> (..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..)<span class="sc">*</span><span class="dv">10</span>, <span class="at">fill =</span> CanWorkFromHome)) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_bar(aes(fill=CanWorkFromHome), position="dodge")+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> CanWorkFromHome), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span>   <span class="co">#geom_text(aes(y = ((..count..)/sum(..count..)), label = scales::percent((..count..)/sum(..count..))), stat = "count", vjust = -0.25) +</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>     <span class="co"># scale_y_reverse(limits = rev)+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Bottom 10%"</span>, <span class="st">"20%"</span>, <span class="st">"30%"</span>, <span class="st">"40%"</span>, <span class="st">"50%"</span>, <span class="st">"60%"</span>, <span class="st">"70%"</span>, <span class="st">"80%"</span>, <span class="st">"90%"</span>, <span class="st">"Top 10%"</span>))<span class="sc">+</span> </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)<span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Able to work from home by income decile"</span>, </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percent of Workers in each Income Decile"</span>,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"n = 55,332 observations in 2021 1-year sample. </span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="st">       Represents the 5.58 million people in Illinois' workforce older than 25 and with earned income &gt; $0.</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="st">       Reading image example: If 10% of workers in the 'Bottom 10%' income decile cannot work from home, </span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="st">       that is roughly equivalent to 1% of the labor force who can't work from home."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dstrata <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_data_frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>decile, <span class="at">y =</span> (..count..<span class="sc">/</span><span class="fu">sum</span>(..count..)<span class="sc">*</span><span class="dv">10</span>))) <span class="sc">+</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>CanWorkFromHome), <span class="at">position=</span><span class="st">"dodge"</span>)<span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Bottom 10%"</span>, <span class="st">"20%"</span>, <span class="st">"30%"</span>, <span class="st">"40%"</span>, <span class="st">"50%"</span>, <span class="st">"60%"</span>, <span class="st">"70%"</span>, <span class="st">"80%"</span>, <span class="st">"90%"</span>, <span class="st">"Top 10%"</span>))<span class="sc">+</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)<span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Able to work from home by income decile"</span>, </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percent of Workers in each Income Decile"</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"n = 55,332 observations in sample. </span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="st">       Represents the 5.58 million people in Illinois with INCEARN&gt;0 and older than 25."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-3-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCTOT))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  -1896   30000   50000   72126   85000 1243000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCEARN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1   25000   48000   66320   80000  949000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(data<span class="sc">$</span>INCTOT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$labels
                                   $9,900 (1980) 
                                           -9995 
                                 Net loss (1950) 
                                              -1 
                                            None 
                                               0 
1 or break even (2000, 2005-onward ACS and PRCS) 
                                               1 
                                             N/A 
                                         9999999 

$label
[1] "Total personal income"

$var_desc
[1] "INCTOT reports each respondent's total pre-tax personal income or losses from all sources for the previous year. The censuses collected information on income received from these sources during the previous calendar year; for the ACS and the PRCS, the reference period was the past 12 months. Amounts are expressed in contemporary dollars, and users studying change over time must adjust for inflation:\n\nUsers studying change over time must adjust for inflation. Consumer Price Index adjustment factors for the appropriate years can be found in the CPI99 variable.\n\nThe exception is the ACS/PRCS multi-year files, where all dollar amounts have been standardized to dollars as valued in the final year of data included in the file (e.g., 2007 dollars for the 2005-2007 3-year file). Additionally, more detail may be available than exists in the original ACS samples.\n\nUser Note: ACS respondents are surveyed throughout the year, and amounts do not reflect calendar year dollars. While the Census Bureau provides an adjustment factor (available in ADJUST), this is an imperfect solution. See the ACS income variables note for further details.\n\nFor a more complete discussion of the use of these factors to adjust for inflation, users may wish to see the IPUMS-CPS note on adjusting dollar amount variables for inflation."

$class
[1] "haven_labelled" "vctrs_vctr"     "double"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(data<span class="sc">$</span>INCEARN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$labels
                                   No earnings 
                                             0 
1 or break even (2000, 2005-2007 ACS and PRCS) 
                                             1 

$label
[1] "Total personal earned income"

$var_desc
[1] "INCEARN reports income earned from wages or a person's own business or farm for the previous year. The censuses collected information on income received from these sources during the previous calendar year; for the ACS and the PRCS, the reference period was the past 12 months. The value of INCEARN is the total for the IPUMS variables INCWAGE, INCBUS, and INCFARM (for 1990) and for INCWAGE and INCBUS00 (for the 2000 census, the ACS, and the PRCS). Note that these components of INCEARN are themselves already Top coded. See those variables for further discussion.  Because the universe for those variables is age 16+, all persons under age 16 have a value of 0 for INCEARN.\n\nAmounts are expressed in contemporary dollars, and users studying change over time must adjust for inflation (See INCTOT for Consumer Price Index adjustment factors).  The exception is the ACS/PRCS multi-year files, where all dollar amounts have been standardized to dollars as valued in the final year of data included in the file (e.g., 2007 dollars for the 2005-2007 3-year file). Additionally, more detail may be available than exists in the original ACS samples.  \n\nUser Note: ACS respondents are surveyed throughout the year, and amounts do not reflect calendar year dollars. While the Census Bureau provides an adjustment factor (available in ADJUST), this is an imperfect solution. See the ACS income variables note for further details."

$class
[1] "haven_labelled" "vctrs_vctr"     "double"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">incearn_decile =</span> <span class="fu">ntile</span>(INCEARN, <span class="dv">10</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">percent_weight =</span> PERWT <span class="sc">/</span> <span class="fu">sum</span>(PERWT)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="co">#adds a variable to indicate which decile an observation falls within</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perwt_decile =</span> <span class="fu">ntile</span>(percent_weight, <span class="dv">10</span>))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>breaksummary <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(perwt_decile)<span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#group_by(incearn_decile) %&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">decile_min =</span> <span class="fu">min</span>(INCEARN),</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">decile_max =</span> <span class="fu">max</span>(INCEARN)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>            ) </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>breaksummary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["perwt_decile"],"name":[1],"type":["int"],"align":["right"]},{"label":["decile_min"],"name":[2],"type":["dbl+lbl"],"align":["right"]},{"label":["decile_max"],"name":[3],"type":["dbl+lbl"],"align":["right"]}],"data":[{"1":"1","2":"10","3":"674000"},{"1":"2","2":"4","3":"949000"},{"1":"3","2":"4","3":"949000"},{"1":"4","2":"4","3":"949000"},{"1":"5","2":"4","3":"949000"},{"1":"6","2":"1","3":"949000"},{"1":"7","2":"30","3":"949000"},{"1":"8","2":"1","3":"949000"},{"1":"9","2":"4","3":"949000"},{"1":"10","2":"10","3":"949000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>incearn_decile) <span class="co">#equal number of people, yay</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3    4    5    6    7    8    9   10 
5534 5534 5533 5533 5533 5533 5533 5533 5533 5533 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>INCEARN))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/incearn-descripstats-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data %&gt;% ggplot() +</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_col(aes(x=INCEARN, y=PERWT))+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_bin(bins=10)#+ scale_x_continuous(labels = label_dollar())</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of wages and salary income</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  # unweighted</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># data %&gt;% ggplot(aes(x=INCEARN)) + </span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   stat_bin(bins=30)+ </span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(labels = label_dollar())</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co">#unweighted</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>h_unweighted<span class="ot">&lt;-</span><span class="fu">wtd.hist</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCEARN), <span class="at">breaks =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/incearn-descripstats-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#weighted</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>h_weighted <span class="ot">&lt;-</span> <span class="fu">wtd.hist</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCEARN), <span class="at">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight =</span> data<span class="sc">$</span>PERWT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/incearn-descripstats-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>h_unweighted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
 [1] 0e+00 1e+05 2e+05 3e+05 4e+05 5e+05 6e+05 7e+05 8e+05 9e+05 1e+06

$counts
 [1] 46882  6448  1024   217    27   697    16     0     0    21

$intensities
 [1] 8.472855e-06 1.165329e-06 1.850647e-07 3.921781e-08 4.879636e-09
 [6] 1.259669e-07 2.891636e-09 0.000000e+00 0.000000e+00 3.795272e-09

$density
 [1] 8.472855e-06 1.165329e-06 1.850647e-07 3.921781e-08 4.879636e-09
 [6] 1.259669e-07 2.891636e-09 0.000000e+00 0.000000e+00 3.795272e-09

$mids
 [1]  50000 150000 250000 350000 450000 550000 650000 750000 850000 950000

$xname
[1] "as.numeric(data$INCEARN)"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>h_weighted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$breaks
 [1] 0e+00 1e+05 2e+05 3e+05 4e+05 5e+05 6e+05 7e+05 8e+05 9e+05 1e+06

$counts
 [1] 4739136  640501  102955   21124    2905   67175    1394       0       0
[10]    2295

$intensities
 [1] 8.496905e-06 1.148369e-06 1.845904e-07 3.787370e-08 5.208441e-09
 [6] 1.204396e-07 2.499334e-09 0.000000e+00 0.000000e+00 4.114758e-09

$density
 [1] 8.496905e-06 1.148369e-06 1.845904e-07 3.787370e-08 5.208441e-09
 [6] 1.204396e-07 2.499334e-09 0.000000e+00 0.000000e+00 4.114758e-09

$mids
 [1]  50000 150000 250000 350000 450000 550000 650000 750000 850000 950000

$xname
[1] "as.numeric(data$INCEARN)"

$equidist
[1] TRUE

attr(,"class")
[1] "histogram"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>h_unweighted<span class="sc">$</span>breaks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0e+00 1e+05 2e+05 3e+05 4e+05 5e+05 6e+05 7e+05 8e+05 9e+05 1e+06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>h_weighted<span class="sc">$</span>breaks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0e+00 1e+05 2e+05 3e+05 4e+05 5e+05 6e+05 7e+05 8e+05 9e+05 1e+06</code></pre>
</div>
</div>
<section id="adding-occupation-codes" class="level4">
<h4 class="anchored" data-anchor-id="adding-occupation-codes">Adding Occupation codes</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># noOCCSOC&lt;- data %&gt;% </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(OCCSOC == 0) #98205 with occsoc=0</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># table(noOCCSOC$EMPSTAT)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># before filtering out the incwage and inctot variables for 0's and negatives, </span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #98% of the people without Occupation codes are not in the labor force. Makes sense</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># all observations have occsoc codes after filtering for INCWAGE and INCTOT and previous steps</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(OCCSOC <span class="sc">!=</span> <span class="dv">0</span>) <span class="co"># none are dropped</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="fu">topline</span>(<span class="at">df =</span> data2, <span class="at">variable =</span> EMPSTAT, <span class="at">weight =</span> PERWT )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Response"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Frequency"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Percent"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Valid Percent"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Cumulative Percent"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Employed","2":"5195611","3":"93.153294","4":"93.153294","5":"93.15329"},{"1":"Unemployed","2":"156905","3":"2.813186","4":"2.813186","5":"95.96648"},{"1":"Not in labor force","2":"224969","3":"4.033520","4":"4.033520","5":"100.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(data2<span class="sc">$</span>PERWT) <span class="co"># 5.58 million people represented by remaining observations in sample</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5577485</code></pre>
</div>
</div>
<p>Look at decile breaks for INCEARN:</p>
<p><em>These are different than Xiaoyans</em>? Double check??</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>income_deciles <span class="ot">&lt;-</span> data2 <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">ntile</span>(INCWAGE, <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean_inc =</span> <span class="fu">mean</span>(INCWAGE)) </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>income_deciles</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ntile(INCWAGE, 10)"],"name":[1],"type":["int"],"align":["right"]},{"label":["mean_inc"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1115.802"},{"1":"2","2":"10798.591"},{"1":"3","2":"22200.831"},{"1":"4","2":"31882.469"},{"1":"5","2":"40858.992"},{"1":"6","2":"50746.431"},{"1":"7","2":"63311.043"},{"1":"8","2":"79072.474"},{"1":"9","2":"103379.722"},{"1":"10","2":"225562.082"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">ntile</span>(INCWAGE,<span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean_inc =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(INCWAGE)) )<span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">INCWAGE_decile=</span><span class="st">'ntile(INCWAGE,10)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ntile</span>(INCWAGE_decile,<span class="dv">10</span>), <span class="at">y=</span>mean_inc)) <span class="sc">+</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Income decile"</span>, <span class="at">y=</span><span class="st">"Mean Income"</span>, <span class="at">title =</span> <span class="st">"Average Income for each Income Decile."</span>) <span class="sc">+</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>teleworkable2010.csv has the 6digit OCCSOC codes. I also added the 5 digit broader version that ends with a 0 in the 6th digit to increase the chances of matching.</p>
<p>Updated teleworkable2010.csv again with 4digitXX codes and 5digitXcodes to increase matching.</p>
<p>teleworkable2018onwards.csv has all codes (2010, 2019 transition, &amp; new 2018 codes)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#telework csv uses data from Dingle and Nieman</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/jdingel/DingelNeiman-workathome/blob/master/occ_manual_scores/input/Teleworkable_BNJDopinion.csv</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#telework&lt;- read_csv("teleworkable2010.csv")</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>telework<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"teleworkable2018onward.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 1881 Columns: 9
── Column specification
──────────────────────────────────────────────────────── Delimiter: "," chr
(2): occ_codes, Notes dbl (1): teleworkable lgl (6): ...3, ...4, ...5, ...6,
...7, ...8
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...3`
• `` -&gt; `...4`
• `` -&gt; `...5`
• `` -&gt; `...6`
• `` -&gt; `...7`
• `` -&gt; `...8`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>telework <span class="ot">&lt;-</span> telework <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CanWorkFromHome =</span> <span class="fu">case_when</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  teleworkable <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"No WFH"</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  teleworkable <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Some WFH"</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  teleworkable <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Can WFH"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Check Me"</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(telework<span class="sc">$</span>CanWorkFromHome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Can WFH   No WFH Some WFH 
     480     1135      266 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># causes problems for any occupation code that has XX in it!! </span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data2$OCCSOC_num &lt;- as.numeric(data2$OCCSOC)</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>innerjoined<span class="ot">&lt;-</span><span class="fu">inner_join</span>(data2, telework, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span><span class="ot">=</span> <span class="st">"occ_codes"</span>))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 65113 obs in innerjoin</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(innerjoined<span class="sc">$</span>teleworkable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.0000  0.4256  1.0000  1.0000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># teleworkable values are an average of occupations with same first 5 digits and first 4 digits. </span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>innerjoined <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"55332"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(innerjoined, <span class="fu">aes</span>(INCEARN))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width=</span><span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `position_stack()` requires non-overlapping x intervals</code></pre>
</div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">weight =</span> PERWT),<span class="at">width=</span><span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `position_stack()` requires non-overlapping x intervals</code></pre>
</div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(innerjoined<span class="sc">$</span>PERWT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5577485</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># innerjoined  %&gt;% ggplot() +</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(aes(ntile(INCEARN,10)), weight=PERWT, bins = 10)+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Unweighted Income Distribution")</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(innerjoined) +</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(aes(x=ntile(INCEARN,10), weight = PERWT), bins = 10, stat = "identity")+</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Unweighted Income Distribution")</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # didn't change =[ </span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(innerjoined, aes(INCEARN)) +</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_histogram(aes(weight =  data2$PERWT), bins = 100, stat = "freq")+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Weighted Income Distribution")</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(innerjoined, aes(INCEARN)) +</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_histogram(aes(), bins = 10)+</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Unweighted Income Distribution")</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="co"># didn't change =[ </span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>h_w <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(innerjoined, <span class="fu">aes</span>(INCEARN)) <span class="sc">+</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">weight =</span>  data2<span class="sc">$</span>PERWT), <span class="at">bins =</span> <span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weighted Income Distribution"</span>)</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>h_w<span class="sc">$</span>breaks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>innerjoined <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">ntile</span>(INCWAGE,<span class="dv">10</span>), <span class="at">y=</span>PERWT, <span class="at">fill =</span> CanWorkFromHome), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ability to Work from Home based on Occupation Characteristics"</span>, <span class="at">x =</span> <span class="st">"Income decile"</span>, <span class="at">caption=</span> <span class="st">"Based on D&amp;N teleworkable categorization and expanded for new 2018 SOC OCC codes. </span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="st">       Sample: 2021 ACS 1-Year, 65,113 observations </span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="st">       representing 6.67 million people in Illinois' workforce."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>innerjoined <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">ntile</span>(INCWAGE,<span class="dv">10</span>), <span class="at">fill =</span> CanWorkFromHome), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ability to Work from Home based on Occupation Characteristics"</span>, <span class="at">x =</span> <span class="st">"Income decile"</span>, <span class="at">caption=</span> <span class="st">"Based on D&amp;N teleworkable categorization and expanded for new 2018 SOC OCC codes. </span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="st">       Sample: 2021 ACS 1-Year, 65,113 observations </span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="st">       representing 6.67 million people in Illinois' workforce."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>leftjoined<span class="ot">&lt;-</span><span class="fu">left_join</span>(data2, telework, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span><span class="ot">=</span> <span class="st">"occ_codes"</span>))</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(innerjoined<span class="sc">$</span>teleworkable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.0000  0.4256  1.0000  1.0000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#innerjoined&lt;-inner_join(data2, telework, by = c("OCCSOC_num"= "BroadGroupCode"))</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#leftjoined&lt;-left_join(data2, telework, by = c("OCCSOC_num"= "BroadGroupCode"))</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># keeps all observations in data 2 even if they don't match</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co">#antijoin &lt;-anti_join(data2, telework, by = c("OCCSOC_num"= "onetsoc_6digits"))</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 158525. Many were aggregated to 5digits with 6digit as 0.</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 91403 obs after updating teleworkable file to 5digits with 6digit as 0</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co">#couldnt use _num version due to XX in values.</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co">#antijoin &lt;-anti_join(data2, telework, by = c("OCCSOC"= "onetsoc_6digits"))</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 50,659 obs after adding 5digitsX and 4digitsXX and 5digits with sixth as 0 to csv file</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(antijoin$OCCSOC) #121 unique codes did not match.</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co"># down to 67 after adding 5digitsX and 4digitsXX and 5digits with sixth as 0 to csv file</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="co">#joined &lt;- joined %&gt;% mutate(occsoc5digits = substr(OCCSOC,1,5))</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="co">#table(joined$occsoc5digits)</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a><span class="co">#table(joined$Teleworkable)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Drops a lot of observations using inner join (equivalent to Stata merge==1) this join. 67,299 observations match SOC codes. I think so many do not match due to the use of 2010 , 2019 transition, and 2018 SOC OCC codes. To check this, I try joining the ACS data with the updated 2018 codes. (Authors used 2010 codes in original paper but they did do one for states that appear to have the 2018 codes?) Double check this.</p>
<ul>
<li>Using the 2021 ACS 1-year Sample should use only 2018 OCC codes since that data should be collected after they transitioned their occupation codes.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>occ_2018 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"2018OCCcodes.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">soc2018_6figs =</span> <span class="fu">as.character</span>(soc2018_6figs))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>joined2018codes <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(data2, occ_2018, </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span> <span class="ot">=</span> <span class="st">"soc2018_6figs"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">occsoc5digits =</span> <span class="fu">substr</span>(OCCSOC,<span class="dv">1</span>,<span class="dv">5</span>))</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 59,626 observations</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>antijoin <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(data2, occ_2018, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span> <span class="ot">=</span> <span class="st">"soc2018_6figs"</span>))</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(antijoin<span class="sc">$</span>OCCSOC)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(joined2018codes<span class="sc">$</span>occsoc5digits)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>occ_2018 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"teleworkable2018onwards.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">onetsoc_6digits =</span> <span class="fu">as.character</span>(onetsoc_6digits))</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>joined2018codes <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(data2, occ_2018, </span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span> <span class="ot">=</span> <span class="st">"onetsoc_6digits"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">occsoc5digits =</span> <span class="fu">substr</span>(OCCSOC,<span class="dv">1</span>,<span class="dv">5</span>))</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 65113 observations? </span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="co"># I think they all matched? Now I just need to finish creating the average teleworkable variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>joining the remaining observations from 2021 1-year ACS data to the 2018 OCC codes results in 65113 matches</p>
<p><strong>OCC2010 variable labels:</strong></p>
<p>From DDI on IPUMS download: https://live.usa.datadownload.ipums.org/web/extracts/usa/1985137/usa_00006.xml#OCC</p>
<p>Management, Business, Science, and Arts = 10-430<br>
Business Operations Specialists = 500-730<br>
Financial Specialists = 800-950<br>
Computer and Mathematical = 1000-1240<br>
Architecture and Engineering = 1300-1540<br>
Technicians = 1550-1560<br>
Life, Physical, and Social Science = 1600-1980<br>
Community and Social Services = 2000-2060<br>
Legal = 2100-2150<br>
Education, Training, and Library = 2200-2550<br>
Arts, Design, Entertainment, Sports, and Media = 2600-2920<br>
Healthcare Practitioners and Technicians = 3000-3540<br>
Healthcare Support = 3600-3650<br>
Protective Service = 3700-3950<br>
Food Preparation and Serving = 4000-4150<br>
Building and Grounds Cleaning and Maintenance = 4200-4250<br>
Personal Care and Service = 4300-4650<br>
Sales and Related = 4700-4965<br>
Office and Administrative Support = 5000-5940<br>
Farming, Fishing, and Forestry = 6005-6130<br>
Construction = 6200-6765<br>
Extraction = 6800-6940<br>
Installation, Maintenance, and Repair = 7000-7630<br>
Production = 7700-8965<br>
Transportation and Material Moving = 9000-9750<br>
Military Specific = 9800-9830<br>
Unemployed (no occupation for 5+ years) or Never Worked = 9920<br>
</p>
</section>
</section>
</section>
<section id="pumas-and-shapefiles" class="level2">
<h2 class="anchored" data-anchor-id="pumas-and-shapefiles">PUMAs and Shapefiles</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PUMA shapefiles</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>pumasIL <span class="ot">&lt;-</span> <span class="fu">pumas</span>(<span class="st">"IL"</span>, <span class="at">cb=</span>T, <span class="at">year=</span><span class="dv">2019</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#county shapefiles</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>countyIL <span class="ot">&lt;-</span> <span class="fu">counties</span>(<span class="st">"IL"</span>, <span class="at">cb=</span>T, <span class="at">year=</span><span class="dv">2019</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co">#pumasdf &lt;- fortify(pumasIL, region = 'PUMACE10')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pums_weighted <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PUMA, COUNTYFIP) <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weighted =</span> <span class="fu">sum</span>(PERWT)) <span class="sc">%&gt;%</span>  <span class="co">#number of people the sample represents</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PUMA =</span> <span class="fu">str_pad</span>(PUMA, <span class="dv">5</span>, <span class="at">pad=</span><span class="st">"0"</span>),</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">countyFIP =</span> <span class="fu">str_pad</span>(COUNTYFIP, <span class="dv">3</span>, <span class="at">pad =</span> <span class="st">"0"</span>))</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>pums_unweight <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PUMA, COUNTYFIP) <span class="sc">%&gt;%</span> </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">unweight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="co">#unweighted number of observations</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PUMA =</span> <span class="fu">str_pad</span>(PUMA, <span class="dv">5</span>, <span class="at">pad=</span><span class="st">"0"</span>),</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">countyFIP =</span> <span class="fu">str_pad</span>(COUNTYFIP, <span class="dv">3</span>, <span class="at">pad =</span> <span class="st">"0"</span>))</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>plotweighted <span class="ot">&lt;-</span> pumasIL <span class="sc">%&gt;%</span> </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pums_weighted, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"PUMACE10"</span> <span class="ot">=</span> <span class="st">"PUMA"</span>))</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>plotunweight <span class="ot">&lt;-</span> pumasIL <span class="sc">%&gt;%</span> </span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pums_unweight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"PUMACE10"</span> <span class="ot">=</span> <span class="st">"PUMA"</span>))</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(plotweighted[<span class="st">"weighted"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(plotunweight[<span class="st">"unweight"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>FIPweighted <span class="ot">&lt;-</span> countyIL <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(pums_weighted, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"COUNTYFP"</span> <span class="ot">=</span> <span class="st">"countyFIP"</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>FIPunweight <span class="ot">&lt;-</span> countyIL <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(pums_unweight, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"COUNTYFP"</span> <span class="ot">=</span> <span class="st">"countyFIP"</span>))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(FIPweighted[<span class="st">"weighted"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(FIPunweight[<span class="st">"unweight"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(countyIL[<span class="st">"COUNTYFP"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="WorkFromHome_2021ACS1year_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="pumas-vs-commzone-vs-counties" class="level4">
<h4 class="anchored" data-anchor-id="pumas-vs-commzone-vs-counties">PUMAS vs COMMZONE vs COUNTIES</h4>
<p><a href="https://eig.org/the-uneven-geography-of-remote-work/">Link from Francis on COMZONE variable</a> (Commuter Zones)</p>
<p><a href="https://univofillinois.maps.arcgis.com/apps/mapviewer/index.html?layers=71eb4ef236ca42c4b577a0a105e790e2">Interactive ESRI Map of all PUMA outlines</a></p>
<p><a href="https://atcoordinates.info/2019/05/13/calculating-mean-income-for-groups-of-geographies-with-census-acs-data/">Article on calculating mean income for groups of geographies with ACS data</a></p>
</section>
</section>
</section>
<section id="stuff-im-not-ready-to-delete-yet" class="level1">
<h1>Stuff I’m not ready to delete yet</h1>
<section id="chatgpt-attempt" class="level2">
<h2 class="anchored" data-anchor-id="chatgpt-attempt">ChatGPT attempt</h2>
<p>I attempted to ask Chat GPT how to pull and merge ACS and Onet data. Ignore this section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ipumsr)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>il_acs <span class="ot">&lt;-</span> <span class="fu">load_ipums_acs</span>(<span class="at">year =</span> <span class="dv">2021</span>, <span class="at">survey =</span> <span class="st">"5-year"</span>, <span class="at">statefip =</span> <span class="dv">17</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"RACE"</span>, <span class="st">"INCWAGE"</span>))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(il_acs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="summary-tables-of-households-in-il-state-2016-2020-acs" class="level3">
<h3 class="anchored" data-anchor-id="summary-tables-of-households-in-il-state-2016-2020-acs">Summary tables of Households in IL State, 2016-2020 ACS</h3>
<p>These examples all use summary tables (Similar to what Prof.&nbsp;Wu does in Stata code) except these use API commands instead of downloading CSVs from the IPUMS website.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidycensus)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(acs)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Download data for table B19001</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>b19001 <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"state"</span>, <span class="at">table =</span> <span class="st">"B19001"</span>, <span class="at">year =</span> <span class="dv">2019</span>, <span class="at">state =</span> <span class="st">"IL"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>moe) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">hh_pct =</span> estimate <span class="sc">/</span> <span class="dv">4846134</span> <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"B19001_001"</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co"># View the data</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>b19001</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels to the income levels</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>income_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Less than $10,000"</span>, <span class="st">"$10,000 to $14,999"</span>, <span class="st">"$15,000 $19,999"</span>, <span class="st">"$20,000 to $24,999"</span>, <span class="st">"$25,000 to $29,999"</span>, <span class="st">"$30,000 to $34,999"</span>, <span class="st">"$35,000 to $39,999"</span>, <span class="st">"$40,000 to $44,999"</span>, <span class="st">"$45,000 to $49,999"</span>, <span class="st">"$50,000 to $59,999"</span>, <span class="st">"$60,000 to $74,999"</span>, <span class="st">"$75,000 to $99,999"</span>, <span class="st">"$100,000 to $124,999"</span>, <span class="st">"$125,000 to $149,999"</span>, <span class="st">"$150,000 to $199,999"</span>, <span class="st">"$200,000 or More"</span>)</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data with labels</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>b19001 <span class="sc">%&gt;%</span> </span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span> </span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">sum_hh_pct =</span> <span class="fu">sum</span>(hh_pct)) <span class="sc">%&gt;%</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sum_hh_pct, <span class="at">y =</span> variable), <span class="at">labels =</span> income_labels) <span class="sc">+</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_x_continuous(labels = scales::comma) +</span></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> income_labels)<span class="sc">+</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#labs(x = "Number of Households", y = "Income Level") +</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="co">#+</span></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_label(aes(label = income_labels), y = 0.5, fill = "white", color = "black")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>il_acs_state <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">table =</span> <span class="fu">c</span>(<span class="st">"B19001"</span>),</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># variables = c("B19001_001", "B25003_001", "B25003_002"),</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IL"</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>il_household_income <span class="ot">&lt;-</span> il_acs_state <span class="sc">%&gt;%</span> </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>moe) <span class="sc">%&gt;%</span> </span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="dv">4884061</span>,</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">hh_income_pct =</span> estimate<span class="sc">/</span>total<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"B19001_001"</span>)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>il_data_decile <span class="ot">&lt;-</span> il_household_income <span class="sc">%&gt;%</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(HH_income <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="fu">ntile</span>(HH_income, <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">work_from_home_pct =</span> <span class="fu">mean</span>(work_from_home_pct))</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>il_acs_county_AWM <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">table =</span> <span class="fu">c</span>(<span class="st">"B19001"</span>),</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a> <span class="co"># variables = c("B19001_001", "B25003_001", "B25003_002"),</span></span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IL"</span></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a><span class="co"># changed from variables = to table = and chose one table. </span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a><span class="co"># need to pivot this table wider</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>il_acs_county_AWM <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>moe) <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"variable"</span>, <span class="at">values_from =</span> <span class="st">"estimate"</span>)</span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>il_acs_county <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B19001_001"</span>, <span class="st">"B25003_001"</span>, <span class="st">"B25003_002"</span>),</span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"IL"</span>,</span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>il_data <span class="ot">&lt;-</span> il_acs_county <span class="sc">%&gt;%</span></span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, NAME, B19001_001E, B25003_001E, B25003_002E) <span class="sc">%&gt;%</span></span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">HH_income =</span> B19001_001E,</span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">housing_units =</span> B25003_001E,</span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">work_from_home =</span> B25003_002E) <span class="sc">%&gt;%</span></span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">work_from_home_pct =</span> work_from_home <span class="sc">/</span> housing_units <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a>il_data_decile <span class="ot">&lt;-</span> il_data <span class="sc">%&gt;%</span></span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(HH_income <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="fu">ntile</span>(HH_income, <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">work_from_home_pct =</span> <span class="fu">mean</span>(work_from_home_pct))</span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a>il_data_decile <span class="co"># breaks table</span></span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a>il_data_decile <span class="ot">&lt;-</span> il_data <span class="sc">%&gt;%</span></span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(HH_income <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="fu">ntile</span>(HH_income, <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">work_from_home_pct =</span> <span class="fu">mean</span>(work_from_home_pct)) <span class="sc">%&gt;%</span> </span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a>il_data_decile</span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a><span class="co"># chat gpt gave me too many steps and caused problems. Not quite trust worthy. Also dropped variable and didn't ungroup. still impressive. </span></span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a>il_data <span class="ot">&lt;-</span> il_acs_county <span class="sc">%&gt;%</span></span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, NAME, B19001_001E, B25003_001E, B25003_002E) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">HH_income =</span> B19001_001E,</span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a>         <span class="at">housing_units =</span> B25003_001E,</span>
<span id="cb98-69"><a href="#cb98-69" aria-hidden="true" tabindex="-1"></a>         <span class="at">work_from_home =</span> B25003_002E) <span class="sc">%&gt;%</span></span>
<span id="cb98-70"><a href="#cb98-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">work_from_home_pct =</span> work_from_home <span class="sc">/</span> housing_units <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a><span class="do">## bar graph of perccentage of people who worked from home for each income decile</span></span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ntile</span>(HH_income, <span class="dv">10</span>), <span class="at">y =</span> work_from_home_pct)) <span class="sc">+</span></span>
<span id="cb98-74"><a href="#cb98-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">ntile</span>(HH_income, <span class="dv">10</span>)))) <span class="sc">+</span></span>
<span id="cb98-75"><a href="#cb98-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb98-76"><a href="#cb98-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Income decile"</span>, <span class="at">y =</span> <span class="st">"Percentage who worked from home"</span>) <span class="sc">+</span></span>
<span id="cb98-77"><a href="#cb98-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>onetr package <a href="https://cran.r-project.org/web/packages/acs/acs.pdf">cran.r</a></p>
<p>waiting for credentials and password</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ONETr")</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ONETr)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setCreds</span>(<span class="st">"work_from_home_reser"</span>, <span class="st">"6865xvg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="acs-2019-5-year-data---original-download" class="level2">
<h2 class="anchored" data-anchor-id="acs-2019-5-year-data---original-download">ACS 2019 5-year Data - Original Download</h2>
<p>First download that had 2019 and 2021 data together. Then filtered for just 2019. Will probably delete. If anything, the 2019 data needs to be redownloaded if we do use it to add a few variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>ddi <span class="ot">&lt;-</span> <span class="fu">read_ipums_ddi</span>(<span class="st">"usa_00006.xml"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_ipums_micro</span>(ddi)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>data2019 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(STATEFIP, REGION)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(YEAR <span class="sc">==</span> <span class="st">"2019"</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(data)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 621,164 observations for ACS2021 5-Year sample</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data2019</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(data2019)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>EMPSTAT) <span class="co"># unweighted</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>LABFORCE) <span class="co"># unweighted</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>CLASSWKR)<span class="co"># unweighted</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="fu">topline</span>(<span class="at">df =</span> data, <span class="at">variable =</span> LABFORCE, <span class="at">weight =</span> PERWT )</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="fu">crosstab</span>(data, <span class="at">x=</span>MULTYEAR, <span class="at">y =</span> LABFORCE, <span class="at">weight =</span> PERWT)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="fu">topline</span>(data, EMPSTAT, PERWT)</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="fu">crosstab</span>(data, <span class="at">x=</span>MULTYEAR, <span class="at">y =</span> EMPSTAT, <span class="at">weight =</span> PERWT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(srvyr)</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(survey)</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PWSTATE2_clean =</span> <span class="fu">as_factor</span>(<span class="fu">lbl_na_if</span>(PWSTATE2, <span class="sc">~</span>.val <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inctot_decile =</span> <span class="fu">ntile</span>(INCTOT, <span class="dv">10</span>),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">incwage_decile =</span> <span class="fu">ntile</span>(INCWAGE, <span class="dv">10</span>),</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">incearn_decile =</span><span class="fu">ntile</span>(INCEARN, <span class="dv">10</span>))  <span class="co">#adds a variable to indicate which decile an observation falls within</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co">#attempt &lt;- svydesign(id=~row(data) , weights=data$PERWT, data=data)</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co">#a &lt;- svyquantile(design=attempt, quantiles = seq(0,1, by=0.1))</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="co">#quantile(x, probs = seq(0, 1, 1/10))    # Deciles</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCEARN))</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="co"># weighted_breaksummary &lt;- data %&gt;% </span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   #srvyr::as_survey(weights = PERWT) %&gt;%</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(incearn_decile) %&gt;%</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarize(decile_min = min(INCEARN),</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a><span class="co">#             decile_max = max(INCEARN)</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a><span class="co">#             ) </span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a><span class="co"># weighted_breaksummary # not actually weighted yet because I used incearn_decile which was created without weighing the data...</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>unweighted_breaksummary <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#srvyr::as_survey(weights = c(PERWT)) %&gt;%</span></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(incearn_decile) <span class="sc">%&gt;%</span></span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">decile_min =</span> <span class="fu">min</span>(INCEARN),</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">decile_max =</span> <span class="fu">max</span>(INCEARN)</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>            ) </span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a>unweighted_breaksummary <span class="co"># NOT WEIGHTED!!!!</span></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of total income</span></span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>INCEARN, <span class="at">breaks =</span> <span class="dv">60</span>) <span class="co"># unweighted</span></span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a> <span class="co"># filter (INCTOT &lt; 400000) %&gt;% </span></span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>INCEARN)) <span class="sc">+</span> </span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span>  <span class="dv">60</span>) <span class="sc">+</span> </span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>())</span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a><span class="fu">topline</span>(data, incearn_decile, <span class="at">weight =</span> PERWT)</span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>decile <span class="ot">&lt;-</span> <span class="fu">ntile</span>(data<span class="sc">$</span>INCEARN, <span class="dv">10</span>)</span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a><span class="co"># from weights() package</span></span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a><span class="fu">wtd.hist</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCEARN), <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">weight =</span> data<span class="sc">$</span>PERWT)</span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a><span class="fu">wtd.hist</span>(<span class="fu">as.numeric</span>(data<span class="sc">$</span>INCEARN), <span class="at">weight =</span> data<span class="sc">$</span>PERWT)</span>
<span id="cb102-53"><a href="#cb102-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-54"><a href="#cb102-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-55"><a href="#cb102-55" aria-hidden="true" tabindex="-1"></a><span class="co"># data_svy = svydesign(~1, #no clusters</span></span>
<span id="cb102-56"><a href="#cb102-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                      data = data, </span></span>
<span id="cb102-57"><a href="#cb102-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                      weight=~PERWT)</span></span>
<span id="cb102-58"><a href="#cb102-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-59"><a href="#cb102-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#svyquantile(~INCTOT,data_svy, </span></span>
<span id="cb102-60"><a href="#cb102-60" aria-hidden="true" tabindex="-1"></a>   <span class="co">#                          quantiles=seq(0.1, 0.9, 0.1))</span></span>
<span id="cb102-61"><a href="#cb102-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-62"><a href="#cb102-62" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>INCEARN)) <span class="sc">+</span> </span>
<span id="cb102-63"><a href="#cb102-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span>  <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb102-64"><a href="#cb102-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#telework csv uses data from Dingle and Nieman</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/jdingel/DingelNeiman-workathome/blob/master/occ_manual_scores/input/Teleworkable_BNJDopinion.csv</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>telework<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"teleworkable2010_v2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1810 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): onetsoc_6digits, major_code_label, major_code_2digits
dbl (2): Count of teleworkable, teleworkable

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#telework&lt;- read_csv("teleworkable2010.csv")</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># causes problems for any occupation code that has XX in it!! </span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co">#data2$OCCSOC_num &lt;- as.numeric(data2$OCCSOC)</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>innerjoined<span class="ot">&lt;-</span><span class="fu">inner_join</span>(data2, telework, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span><span class="ot">=</span> <span class="st">"onetsoc_6digits"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in inner_join(data2, telework, by = c(OCCSOC = "onetsoc_6digits")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 7457 of `x` matches multiple rows in `y`.
ℹ Row 1220 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ___ obs in innerjoin</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># __ obs after updating teleworkable2010 file with broader 5digit codes that 6digit 0</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 312350 obs after adding 5digitsX and 4digitsXX codes to teleworkable.</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># teleworkable values are an average of occupations with same first 5 digits and first 4 digits. </span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>leftjoined<span class="ot">&lt;-</span><span class="fu">left_join</span>(data2, telework, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span><span class="ot">=</span> <span class="st">"onetsoc_6digits"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(data2, telework, by = c(OCCSOC = "onetsoc_6digits")): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 7457 of `x` matches multiple rows in `y`.
ℹ Row 1220 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#innerjoined&lt;-inner_join(data2, telework, by = c("OCCSOC_num"= "BroadGroupCode"))</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co">#leftjoined&lt;-left_join(data2, telework, by = c("OCCSOC_num"= "BroadGroupCode"))</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># keeps all observations in data 2 even if they don't match</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co">#antijoin &lt;-anti_join(data2, telework, by = c("OCCSOC_num"= "onetsoc_6digits"))</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 158525. Many were aggregated to 5digits with 6digit as 0.</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 91403 obs after updating teleworkable file to 5digits with 6digit as 0</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="co">#couldnt use _num version due to XX in values.</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>antijoin <span class="ot">&lt;-</span><span class="fu">anti_join</span>(data2, telework, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"OCCSOC"</span><span class="ot">=</span> <span class="st">"onetsoc_6digits"</span>))</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 50,584 obs after adding 5digitsX and 4digitsXX and 5digits with sixth as 0 to csv file</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(antijoin<span class="sc">$</span>OCCSOC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "113013" "434XXX" "399099" "559830" "212099" "311121" "251000" "537065"
 [9] "514XXX" "311131" "311122" "1721YY" "151230" "211029" "533099" "419099"
[17] "254022" "151252" "151251" "151299" "253041" "151241" "131082" "291210"
[25] "15124X" "533054" "299000" "439XXX" "413091" "272091" "151211" "533052"
[33] "292043" "291292" "193033" "4750YY" "434YYY" "1940YY" "273023" "531000"
[41] "193034" "151255" "391000" "151254" "353023" "292042" "513099" "151244"
[49] "211019" "292072" "151212" "113012" "533051" "472XXX" "273092" "273099"
[57] "519160" "291299" "339094" "533053" "291240" "272099" "31113X" "151253"
[65] "195010" "151221" "232099" "453031" "359099" "475032" "291291" "432099"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># down to 73 after adding 5digitsX and 4digitsXX and 5digits with sixth as 0 to csv file</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">#table(joined$Teleworkable)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="xiaoyans-merging-notes" class="level2">
<h2 class="anchored" data-anchor-id="xiaoyans-merging-notes">Xiaoyan’s Merging Notes</h2>
<p>Code chunk below is my attempt to manually recode items that didn’t match. I think I have an excel file of OCCSOC codes that should match almost completely.</p>
<p><em>Double check</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>data2021 <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(OCCSOC <span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">telworkable =</span> <span class="fu">case_when</span>(</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"113013"</span> <span class="sc">~</span> ,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"131081"</span> <span class="sc">~</span> ,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"151255"</span> <span class="sc">~</span> ,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"195010"</span> <span class="sc">~</span> ,</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"211019"</span> <span class="sc">~</span> ,</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"211029"</span> <span class="sc">~</span> ,    </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"211092"</span> <span class="sc">~</span> ,</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"211093"</span> <span class="sc">~</span> ,</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"212099"</span> <span class="sc">~</span> ,</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"232099"</span> <span class="sc">~</span> ,</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"2504022"</span> <span class="sc">~</span> <span class="st">"0"</span>, <span class="co"># libararians and media collections specialists. </span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"272091"</span> <span class="sc">~</span> , <span class="co"># disc jockets. Was 272099</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"272099"</span> <span class="sc">~</span> <span class="st">"RECODED"</span>,</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"273092"</span> <span class="sc">~</span>  <span class="st">"1"</span>, <span class="co">#court reporters and captioners </span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"273099"</span> <span class="sc">~</span> <span class="st">"1"</span>, <span class="co"># media and comunication workers, all other</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"311122"</span> <span class="sc">~</span> <span class="st">"0"</span>,   <span class="co"># personal care aids</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"331090"</span> <span class="sc">~</span> <span class="st">"0"</span>,    <span class="co"># healthcare and support specialists </span></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"339094"</span> <span class="sc">~</span> ,    </span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"359099"</span> <span class="sc">~</span> ,    </span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"413091"</span> <span class="sc">~</span> <span class="st">"0"</span>,</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"419099"</span> <span class="sc">~</span>  <span class="st">"0"</span>, <span class="co"># sales and related workers all other</span></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"432099"</span> <span class="sc">~</span> <span class="st">"0.5"</span>, <span class="co"># communications equipment operators, all other</span></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"4330XX"</span> <span class="sc">~</span> <span class="st">"0.5"</span>, <span class="co"># 43 is office and admin support</span></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"513099"</span> <span class="sc">~</span> <span class="st">"0"</span>, <span class="co">#food processing workers</span></span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"533099"</span> <span class="sc">~</span>  <span class="st">"0"</span>, <span class="co"># motor vehicle operators</span></span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"537065"</span> <span class="sc">~</span> <span class="st">"0"</span>, <span class="co"># stockers and order fillers</span></span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"551010"</span> <span class="sc">~</span> <span class="st">"0"</span>, <span class="co"># miltary </span></span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"552020"</span> <span class="sc">~</span> <span class="st">"0"</span>, <span class="co"># military</span></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"553010"</span> <span class="sc">~</span> <span class="st">"0"</span>, <span class="co"># military</span></span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>    OCCSOC <span class="sc">==</span> <span class="st">"559830"</span> <span class="sc">~</span> <span class="st">"0"</span>, <span class="co"># military</span></span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(OCCSOC))</span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>****merge****</p>
<p>merge m:1 occsoc using “/Users/xiaoyanhu/Desktop/crosswalk.dta”</p>
<p>*IL has but DN no: 29, merge==2</p>
<p>*113013 Facilities Managers</p>
<p>*131082 Project Management Specialists</p>
<p>*151255 Web And Digital Interface Designers</p>
<p>*195010 Occupational Health And Safety Specialists And Technicians</p>
<p>*211019 Counselors, All Other</p>
<p>*211029 Social Workers All Other</p>
<p>*211092 Probation Officers and Correctional Treatment Specialists</p>
<p>*211093 Social and Human Service Assistants</p>
<p>*212099 Religious Workers, All Other</p>
<p>*232099 Legal Support Workers, All Other</p>
<p>*272091 Disc Jockeys, Except Radio</p>
<p>*272099 Entertainers and Performers, Sports and Related Workers, All Other</p>
<p>*273092 Court Reporters And Simultaneous Captioners</p>
<p>*273099 Media And Communications Workers, All Other</p>
<p>*311122 Personal Care Aides</p>
<p>*331090 Miscellaneous First-Line Supervisors, Protective Service Workers</p>
<p>*339094 School Bus Monitors</p>
<p>*359099 Food Preparation and Serving Related Workers, All Other</p>
<p>*413091 Sales Representatives Of Services, Except Advertising, Insurance, Financial Services, And Travel</p>
<p>*419099 Sales and Related Workers, All Other</p>
<p>*432099 Communications Equipment Operators, All Other</p>
<p>*4330XX Other Financial Clerks</p>
<p>*513099 Food Processing Workers, All&nbsp;Other</p>
<p>*533099 Motor Vehicle Operators, All Other</p>
<p>*537065 Stockers And Order Fillers</p>
<p>*551010 Military Officer Special and Tactical Operations Leaders</p>
<p>*552010 First-Line Enlisted Military Supervisors</p>
<p>*553010 Military Enlisted Tactical Operations and Air/Weapons Specialists and Crew Members</p>
<p>*559830 Military, Rank Not Specified</p>
<p>*DN has but IL no: 7, merge==1</p>
<p>** AWM - These were 2010 codes that have been changed to 2018 SOC codes</p>
<p>*119061 Funeral Service Managers #Code and Title change to 119171</p>
<p>*119131 Postmasters and Mail Superintendents #Didn’t change, should have been in their file?</p>
<p>*173021 Aerospace Engineering and Operations Technicians</p>
<p>*173022 Civil Engineering Technicians</p>
<p>*232091 Court Reporters</p>
<p>*413099 Energy Brokers</p>
<p>*433041 Gaming Cage Workers</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>