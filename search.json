[
  {
    "objectID": "WFH_Models.html",
    "href": "WFH_Models.html",
    "title": "Models for Paper",
    "section": "",
    "text": "I combine the 2019 and 2021 datasets when creating new variables and then separate them by year again before creating the survey design object for each sample year.\n\n# old version with less variables:\n#ddi &lt;- read_ipums_ddi(\"usa_00009.xml\") # 45 variables\n#data &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\n\n# larger version with 147 variables. uses same file as Box file named \"IL_2021_1yr_ACS.dat.gz and IL_2021_1yr_ACS_datDDI.xml\nddi &lt;- read_ipums_ddi(\"usa_00011.xml\") # downloaded April 10 2023\ndata2021 &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\ndata2021 &lt;- data2021 %&gt;% select(YEAR, INCEARN, INCWAGE, INCTOT, TRANWORK, OCCSOC, CLASSWKR, EMPSTAT, LABFORCE, PERWT, COUNTYFIP, PUMA, PWSTATE2, AGE, STRATA, CLUSTER, RACE, HISPAN, SEX, CIHISPEED, CINETHH, MULTGEN, NCHILD, NCHLT5, MARST, FERTYR, EDUC, DEGFIELD, OCC, IND, OCC2010, METRO, CITY, HHINCOME, SERIAL,HHWT, NUMPREC, SUBSAMP,HHTYPE )\n\n# same sample but with 150+ variables. \n# NEED TO CHANGE XML file that referneces the data file. currently says usa_00011.dat.gz so these two lines of code do not work. \n\nddi &lt;- read_ipums_ddi(\"C:/Users/aleaw/Box/Fiscal Futures/FY22_Working/WFH/Data/IL_2019_1yearACS_datDDI.xml\") # downloaded April 10 2023\ndata2019 &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\ndata2019 &lt;- data2019 %&gt;% select(YEAR, INCEARN, INCWAGE, INCTOT, TRANWORK, OCCSOC, CLASSWKR, EMPSTAT, LABFORCE, PERWT, COUNTYFIP, PUMA, PWSTATE2, AGE, STRATA, CLUSTER, RACE, HISPAN, SEX, CIHISPEED, CINETHH, MULTGEN, NCHILD, NCHLT5, MARST, FERTYR, EDUC, DEGFIELD, OCC, IND, OCC2010, METRO, CITY, HHINCOME, SERIAL,HHWT, NUMPREC, SUBSAMP,HHTYPE   )\n\ndata &lt;- rbind(data2019, data2021) #125,007 observations before any filtering. \n\n\n# replaces 0 with NA for variables listed. Allows topline to calculate \"Valid Percent\" when it recognizes missing values\n\ndata &lt;- data %&gt;% replace_with_na(replace = list(\n  EMPSTAT= c(0), \n  LABFORCE=c(0), \n  CLASSWKR = c(0),\n  OCCSOC = c(0),\n  CIHISPEED = c(0),\n  CINETHH = c(0),\n  TRANWORK = c(\"N/A\",\"0\"))) %&gt;% \n  filter(LABFORCE == 2 & INCEARN &gt; 0) # in labor force and 18 years old and up abd positive earned incomes. \n\n\ndata &lt;- data %&gt;% mutate(age_cat = \n                              case_when(AGE &lt; 24 ~ \"16to24\",\n                                        AGE &gt; 24 & AGE &lt; 35 ~ \"25to34\",\n                                        AGE &gt; 34 & AGE &lt; 45 ~ \"35to44\",\n                                        AGE &gt; 44 & AGE &lt; 55 ~ \"45to54\",\n                                        AGE &gt; 54 & AGE &lt; 65 ~ \"55to64\",\n                                        AGE &gt; 64 ~ \"65+\"),\n                        sex_cat = case_when(SEX == 1 ~ \"Male\",\n                                            SEX == 2 ~ \"Female\"))\n\ndata &lt;-  data %&gt;% mutate(white = if_else(RACE ==1, 1, 0),\n         black = if_else(RACE ==2, 1, 0), \n         asian = if_else(RACE %in% c(4,5,6), 1, 0),\n         otherrace = if_else(RACE %in% c(3,7,8,9),1,0)) %&gt;%\n  group_by(COUNTYFIP,PUMA) %&gt;%\n  mutate(pct_white = sum(white)/n(),\n         pct_black = sum(black)/n()) %&gt;% \n  ungroup() %&gt;%\n  mutate(race_cat = case_when(\n    RACE ==1~\"White\",\n    RACE ==2 ~ \"Black\", \n    RACE %in% c(4,5,6)~\"Asian\",\n    RACE %in% c(3,7,8,9)~\"Other\"))\n\n\n## numbers used for income breaks are calculated in Income Deciles section. \n# created now so that the variable exists in the joined dataset before creating the survey design object\n\ndata &lt;- data %&gt;% \n  mutate(incdecile_w = case_when(\n    INCEARN &lt; 8000 ~ 1, \n    INCEARN &gt;= 8000 & INCEARN &lt; 18000 ~ 2,\n    INCEARN &gt;= 18000 & INCEARN &lt; 26000 ~ 3,\n    INCEARN &gt;= 26000 & INCEARN &lt; 35000 ~ 4,\n    INCEARN &gt;= 35000 & INCEARN &lt; 43000 ~ 5,\n    INCEARN &gt;= 43000 & INCEARN &lt; 54000 ~ 6,\n    INCEARN &gt;= 54000 & INCEARN &lt; 68000 ~ 7,\n    INCEARN &gt;= 68000 & INCEARN &lt; 85000 ~ 8,\n    INCEARN &gt;= 85000 & INCEARN &lt; 120000 ~ 9,\n    INCEARN &gt;= 120000 ~ 10)\n  ) %&gt;%\n  ## Padding FIPS code for merging with spatial geometry later\n  mutate(county_pop_type = if_else(COUNTYFIP==0, \n                                   \"Rural Counties\", \"Urban Counties\")) %&gt;%\n  mutate(PUMA = str_pad(PUMA, 5, pad=\"0\"),\n         countyFIP = str_pad(COUNTYFIP, 3, pad = \"0\"))\n\n\ndata &lt;- data %&gt;%\n  mutate(occ_2digits = substr(OCCSOC,1,2)) %&gt;% \n  mutate(occ_2dig_labels = case_when(\n    occ_2digits %in% c(11,13,19,15,17,19,21,23,25,27,29) ~ \"Management, Business, Science, Arts\",\n    occ_2digits %in% c(31,32,33,34,35,36,37,38,39) ~ \"Service Occupations\",\n    occ_2digits %in% c(41,42,43) ~ \"Sales & Office Jobs\",\n    occ_2digits %in% c(45,46,47,48,49 ) ~\"Natural Resources, Construction\",\n    occ_2digits %in% c(51, 52, 53) ~ \"Production, Transportation\",\n    occ_2digits == 55 ~ \"Military\")) \n\ndata &lt;- data %&gt;%\n  mutate(occ_2digits = substr(OCCSOC,1,2)) %&gt;% \n  mutate(occ_2dig_labels_d = case_when(\n    occ_2digits %in% c(11) ~ \"Management\",\n    occ_2digits %in% c(13) ~ \"Business & Finance\",\n    occ_2digits %in% c(15) ~ \"Computer, Engineering & Science\",\n    occ_2digits %in% c(17) ~ \"Architecture & Engineering\",\n    occ_2digits %in% c(19) ~ \"Life/Social Sciences\",\n    occ_2digits == 21 ~ \"Community & Social Services\",\n    occ_2digits == 23 ~ \"Legal\",\n    occ_2digits == 25 ~ \"Educational Instruction\",\n    occ_2digits == 27 ~ \"Arts, Design, Entertainainment\",\n    occ_2digits == 29 ~ \"Health Practictioners\",\n    occ_2digits == 31 ~ \"Healthcare Support\",\n    occ_2digits == 33 ~ \"Protective services\",\n    occ_2digits == 35 ~ \"Food Services\",\n    occ_2digits == 37 ~ \"Building Cleaning & Maintenance\",\n    occ_2digits == 41 ~ \"Sales\",\n    occ_2digits == 43 ~\"Office & Administration\",\n    occ_2digits == 45 ~ \"Farm, Fish, Forest\",\n    occ_2digits == 47 ~ \"Construction & Extractraction\",\n    occ_2digits == 49 ~\"Installation, Maintenance\",\n    occ_2digits == 51 ~\"Production\",\n    occ_2digits == 53 ~ \"Transportation & Material Moving\",\n    occ_2digits == 55 ~ \"Military\",\n    TRUE~\"Other\") )\n\ndata &lt;- data %&gt;% \n  mutate(did_wfh = if_else(TRANWORK==80, 1, 0)) # 1 = wfh, 0 = did not wfh\n\ndata &lt;- data %&gt;% \n  mutate(\n    PWSTATE2 = ifelse(PWSTATE2 == 0, NA, PWSTATE2),\n    work_in_IL = ifelse(PWSTATE2 == \"17\", \"In Illinois\", \"Out of IL\"),\n    did_wfh_labels = ifelse(did_wfh == 1, \"Did WFH\", \"Did not WFH\"),\n    has_incearn = ifelse(INCEARN &gt; 0, 1, 0), ## has earned income = 1\n    has_occsoc = ifelse(OCCSOC &gt; 0, 1, 0),# has occupation = 1\n    has_incearn_labels = ifelse(INCEARN &gt; 0, \"Has EarnInc\", \"No IncData\"), ## has earned income = 1\n    has_occsoc_labels = ifelse(OCCSOC &gt; 0, \"Has Occ\", \"No Occ\") ## OCCSOC code greater than zero coded as 1\n    )\n\nrm(ddi)\nrm(data2019)\nrm(data2021)\n\n\n# bring in the teleworkable scores based on D&N's work.\ntelework &lt;- read_csv(\"teleworkable_AWM.csv\")\njoined &lt;- left_join(data, telework, by = c(\"OCCSOC\" = \"occ_codes\"))\n\n#May 22 2023, Changed 399011 occupation to 0. Was coding Nannies and Child care as teleworkable.\njoined &lt;- joined %&gt;% mutate(teleworkable = ifelse(OCCSOC == \"399011\" | OCCSOC == \"399010\", 0, teleworkable))\n\n#table(joined$teleworkable)\n# mostly 0's and 1's.\n#hist(joined$teleworkable)\n\njoined &lt;- joined %&gt;% \n  mutate(CanWorkFromHome = case_when(\n  teleworkable == 0 ~ \"No WFH\",\n  teleworkable &lt; 1 ~ \"Some WFH\",\n  teleworkable == 1 ~ \"Can WFH\",\n  TRUE ~ \"Check Me\")) %&gt;% \n  # keeps observations that have earned income values and are in the labor force.\n  filter(has_incearn == 1 & LABFORCE == 2) \n\n\ntable(joined$CanWorkFromHome)\n\n\n Can WFH   No WFH Some WFH \n   41643    66111    15999 \n\ntable(joined$did_wfh, joined$YEAR)\n\n   \n     2019  2021\n  0 56782 47136\n  1  3197 10949\n\n\n\n#as_survey() from srvyr package\n\n## both years together: calculations using this will have incorrect standard errors\n# might be easier sometimes to graph together. Maybe. \njoined &lt;- joined %&gt;% filter(HHINCOME &gt; 0 & HHINCOME!= 9999999 & HHINCOME != 9999998)  # 105 observations \njoined &lt;- joined %&gt;%\n  mutate(HHincdecile_w = case_when(\n    INCEARN &lt; 34000 ~ 1,\n    INCEARN &gt;= 34000 & INCEARN &lt; 51900 ~ 2,\n    INCEARN &gt;= 51900 & INCEARN &lt; 68000 ~ 3,\n    INCEARN &gt;= 68000 & INCEARN &lt; 83600 ~ 4,\n    INCEARN &gt;= 83699 & INCEARN &lt; 100000 ~ 5,\n    INCEARN &gt;= 100000 & INCEARN &lt; 120000 ~ 6,\n    INCEARN &gt;= 120000 & INCEARN &lt; 142400 ~ 7,\n    INCEARN &gt;= 142400 & INCEARN &lt; 175000 ~ 8,\n    INCEARN &gt;= 175000 & INCEARN &lt; 235000 ~ 9,\n    INCEARN &gt;= 235000 ~ 10)\n  )\n\ndstrata &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~PERWT, data = joined) %&gt;% \n  as_survey() %&gt;%\n  mutate(decile = ntile(INCEARN, 10))\n\n\n\n# 2019 data turned into survey item\ndstrata2019 &lt;- joined %&gt;% filter(YEAR==2019) \ndstrata2019 &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, \n                                 weights = ~PERWT, data = dstrata2019) %&gt;% \n  as_survey() %&gt;% \n  mutate(decile = ntile(INCEARN, 10))\n\n\ndstrata2021 &lt;- joined %&gt;% filter(YEAR==2021) \n\ndstrata2021 &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~PERWT, data = dstrata2021) %&gt;% as_survey() %&gt;%\n  mutate(decile = ntile(INCEARN, 10))\n\n\n\nCode\njoined &lt;- joined %&gt;% filter(HHINCOME &gt; 0 & HHINCOME!= 9999999 & HHINCOME != 9999998)  # 105 observations \n\njoined %&gt;%\n  ggplot() + geom_histogram(aes(x=HHINCOME, weight = HHWT))\n\n\n\n\n\nCode\njoined %&gt;% # 122000 observations \nggplot() + geom_histogram(aes(x=HHINCOME))\n\n\n\n\n\nCode\nHHdesign &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~HHWT, data = joined)\n\ninc_quantiles &lt;-survey::svyquantile(~HHINCOME, design=HHdesign, \n                    quantiles = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1) ,\n                    na.rm=TRUE, ci = FALSE  )\ninc_quantiles\n\n\n$HHINCOME\n     0   0.1   0.2   0.3   0.4   0.5    0.6    0.7    0.8    0.9       1\n[1,] 4 32900 50000 66600 82000 99000 117000 140000 171000 230000 1797000\n\nattr(,\"hasci\")\n[1] FALSE\nattr(,\"class\")\n[1] \"newsvyquantile\"\n\n\nCode\n# With  HH Weights:  4 32900 50000 66600 82000 99000 117000 140000 171000 230000 1797000\n# With WRONG weights:  (34000, 51900, 68000, 83600, 1e+05 120,000 142,400 175,000 235,000\n#Code done above when creating variables in beginning chunks.\njoined &lt;- joined %&gt;%\n  mutate(HHincdecile_w = case_when(\n    INCEARN &lt; 32900 ~ 1,\n    INCEARN &gt;= 32900 & INCEARN &lt; 50000 ~ 2,\n    INCEARN &gt;= 50000 & INCEARN &lt; 66600 ~ 3,\n    INCEARN &gt;= 66600 & INCEARN &lt; 82000 ~ 4,\n    INCEARN &gt;= 82000 & INCEARN &lt; 99000 ~ 5,\n    INCEARN &gt;= 99000 & INCEARN &lt; 117000 ~ 6,\n    INCEARN &gt;= 117000 & INCEARN &lt; 140000 ~ 7,\n    INCEARN &gt;= 140000 & INCEARN &lt; 171000 ~ 8,\n    INCEARN &gt;= 171000 & INCEARN &lt; 230000 ~ 9,\n    INCEARN &gt;= 230000 ~ 10)\n  )\n\nHHdesign &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~HHWT, data = joined)\ntable &lt;- svytable(~YEAR+HHincdecile_w+did_wfh_labels,  design = HHdesign) \n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR,HHincdecile_w)%&gt;%\n  mutate(Prop=round(n/sum(n), digits=3)) %&gt;%\n  filter(did_wfh_labels == \"Did WFH\")\n\ntable # has proportions calculated out of TOTAl for both years\n\n\n\n\n  \n\n\n\nCode\ntable %&gt;%\n  ggplot(aes(factor(HHincdecile_w, levels = c(1,2,3,4,5,6,7,8,9,10), labels = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\")), \n                     y=Prop, fill = YEAR, group = factor(YEAR, levels = \"2021\",\"2019\"))) + \n  geom_col(stat=\"identity\", position = \"dodge\")+\n  #geom_col(stat = \"identity\", position = \"stack\") +   # scale_x_discrete(limits = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\"))+\n\n # facet_wrap(~YEAR)+\n   coord_flip()+\n    geom_text(aes(label = scales::percent(Prop, accuracy = 0.1L)), position = position_dodge(width = 0.8), hjust = 1.1,\n              size = 4) + \n  labs(title =\"Percent of each HOUSEHOLD income decile that did WFH\",\n  subtitle = \"2019 vs 2021\",\n       caption = \"ACS 1 year samples for 2019 and 2021. Working from home based on TRANWORK question on commuting and HHINCOME variable.\n       All workers in the labor force, all ages included.\n       Income based on HHINCOME for household income of survey respondents.\", \n       x= \"Income Deciles\", \n       y = \"Percent of workers working from home\") + \n theme(legend.position = \"bottom\", legend.title = element_blank())+\n  theme_classic()+\n    scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\")) +\n  scale_y_continuous(labels = scales::percent)"
  },
  {
    "objectID": "WFH_Models.html#gender-and-kids-model-subsetting-survey-data",
    "href": "WFH_Models.html#gender-and-kids-model-subsetting-survey-data",
    "title": "Models for Paper",
    "section": "Gender and Kids Model: Subsetting survey data",
    "text": "Gender and Kids Model: Subsetting survey data\n\nLogit Model\nModel created with a subset of survey data. Only uses workers who had Management type occupations, Could feasibly WFH, and were under the ages of 45.\n\nboth &lt;- svyglm(did_wfh~ INCEARN + race_cat + sex_cat + age_cat + factor(CIHISPEED) + county_pop_type + NCHILD + NCHLT5  + factor(YEAR), \n               subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n        family = quasibinomial(), design = dstrata)\n\n# summary(both)\n\n\nOR.CI_Both &lt;- cbind(\"AOR\" = exp(   coef(both)),\n                       exp(confint(both,\n                           df.resid=degf(both$survey.design))))[-1,]\n\nt1 &lt;- both %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 # estimate_fun = function(x) style_sigfig(x, digits = 2),\n                  label  = list('(Intercept)'  ~ \"Intercept\")\n ) %&gt;%\n  modify_column_hide(p.value) %&gt;%\n  modify_caption(\"Both Survey Years Together - Logit Model\")\n\nt2 &lt;- both %&gt;%\n  tbl_regression(intercept = F,     # No intercept in OR table\n                 exponentiate = T,  # OR = exp(B)\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3),\n                 # label  = list(\n                 #               AGE ~ \"Age (years)\",\n                 #              )\n                 ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\ntbl_merge(\n  tbls = list(t1, t2),\n  tab_spanner = c(\"**Regression Coefficients**\", \"**Adjusted Odds Ratio**\")\n)\n\n\n\n\n\n  Both Survey Years Together - Logit Model\n  \n    \n    \n      Characteristic\n      \n        Regression Coefficients\n      \n      \n        Adjusted Odds Ratio\n      \n    \n    \n      log(OR)1\n      95% CI1\n      OR1\n      95% CI1\n      p-value\n    \n  \n  \n    Intercept\n-3.88\n-4.26, -3.49\n\n\n\n    Total personal earned income\n0.00\n0.00, 0.00\n1.00\n1.00, 1.00\n&lt;0.001\n    race_cat\n\n\n\n\n&lt;0.001\n        Asian\n—\n—\n—\n—\n\n        Black\n-0.48\n-0.77, -0.20\n0.62\n0.46, 0.82\n&lt;0.001\n        Other\n-0.64\n-0.88, -0.40\n0.53\n0.42, 0.67\n&lt;0.001\n        White\n-0.21\n-0.38, -0.05\n0.81\n0.68, 0.96\n0.013\n    sex_cat\n\n\n\n\n0.498\n        Female\n—\n—\n—\n—\n\n        Male\n0.04\n-0.07, 0.15\n1.04\n0.93, 1.16\n0.498\n    age_cat\n\n\n\n\n&lt;0.001\n        16to24\n—\n—\n—\n—\n\n        25to34\n0.54\n0.30, 0.78\n1.72\n1.35, 2.19\n&lt;0.001\n        35to44\n0.74\n0.48, 0.99\n2.09\n1.61, 2.70\n&lt;0.001\n    factor(CIHISPEED)\n\n\n\n\n&lt;0.001\n        10\n—\n—\n—\n—\n\n        20\n-0.51\n-0.79, -0.23\n0.60\n0.46, 0.79\n&lt;0.001\n    county_pop_type\n\n\n\n\n&lt;0.001\n        Rural Counties\n—\n—\n—\n—\n\n        Urban Counties\n0.97\n0.72, 1.23\n2.65\n2.05, 3.42\n&lt;0.001\n    Number of own children in the household\n-0.22\n-0.29, -0.15\n0.80\n0.75, 0.86\n&lt;0.001\n    Number of own children under age 5 in household\n0.22\n0.10, 0.33\n1.24\n1.11, 1.39\n&lt;0.001\n    factor(YEAR)\n\n\n\n\n&lt;0.001\n        2019\n—\n—\n—\n—\n\n        2021\n2.09\n1.94, 2.23\n8.06\n6.98, 9.31\n&lt;0.001\n  \n  \n  \n    \n      1 OR = Odds Ratio, CI = Confidence Interval\n    \n  \n\n\n\n\nA note on the p-value: the p-value is a test of significance for the null hypothesis H0 that\n\nthere is no difference in the log-odds of the outcome between the reference group (captured by the intercept) and the explanatory variable (or one of its categories), or that the difference between the two groups equals zero: H0:b1=0 and Ha:b1≠0\n\nIf p&lt;0.5, we reject H0 as we have evidence to suggest that the difference between the two groups does not equal zero.\nLog-odds are not the most intuitive to interpret. Instead of discussing the change in the log-odds, we can calculate the odds ratio for a given variable by exponentiating the coefficient.\nOdds ratio is read “have x times the odds of the outcome of interest compared to those in the reference group”.\nReference group of the outcome variable: by default, R creates uses the lowest coded group as the reference. The reference category can be changed by using the ‘relevel()’.\nRelationship between Odds and Probabilities:\nOdds=P/(1-P) P=odds/(1+odds) Odds=exp(log-odds) P=exp(log-odds)/(1+exp(log-odds))\n\nboth &lt;- svyglm(did_wfh~ sex_cat*factor(YEAR)+ age_cat*factor(YEAR) + NCHILD*factor(YEAR) + NCHLT5*factor(YEAR)+factor(CIHISPEED)*factor(YEAR) + county_pop_type*factor(YEAR) +race_cat*factor(YEAR), \n               subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n        family = quasibinomial(), design = dstrata)\n\nOR.CI_Both &lt;- cbind(\"AOR\" = exp(   coef(both)),\n                       exp(confint(both,\n                           df.resid=degf(both$survey.design))))[-1,]\n\n\nt1 &lt;- both %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 # estimate_fun = function(x) style_sigfig(x, digits = 2)\n                 ) %&gt;%\n  modify_column_hide(p.value) %&gt;%\n  modify_caption(\"Both years together with Interactions - Logit Model\")\n\nt2 &lt;- both %&gt;%\n  tbl_regression(intercept = F,     # No intercept in OR table\n                 exponentiate = T,  # OR = exp(B)\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3)\n                 ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\ntbl_merge(\n  tbls = list(t1, t2),\n  tab_spanner = c(\"**Regression Coefficients**\", \"**Adjusted Odds Ratio**\")\n)\n\n\n\n\n\n  Both years together with Interactions - Logit Model\n  \n    \n    \n      Characteristic\n      \n        Regression Coefficients\n      \n      \n        Adjusted Odds Ratio\n      \n    \n    \n      log(OR)1\n      95% CI1\n      OR1\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n-4.30\n-5.13, -3.47\n\n\n\n    sex_cat\n\n\n\n\n0.005\n        Female\n—\n—\n—\n—\n\n        Male\n0.32\n0.09, 0.54\n1.37\n1.10, 1.71\n0.005\n    factor(YEAR)\n\n\n\n\n&lt;0.001\n        2019\n—\n—\n—\n—\n\n        2021\n2.46\n1.55, 3.38\n11.74\n4.69, 29.41\n&lt;0.001\n    age_cat\n\n\n\n\n&lt;0.001\n        16to24\n—\n—\n—\n—\n\n        25to34\n1.39\n0.73, 2.05\n4.01\n2.07, 7.78\n&lt;0.001\n        35to44\n1.85\n1.18, 2.51\n6.34\n3.26, 12.33\n&lt;0.001\n    Number of own children in the household\n-0.17\n-0.31, -0.02\n0.85\n0.73, 0.98\n0.024\n    Number of own children under age 5 in household\n0.17\n-0.04, 0.38\n1.18\n0.96, 1.46\n0.121\n    factor(CIHISPEED)\n\n\n\n\n0.308\n        10\n—\n—\n—\n—\n\n        20\n-0.33\n-0.98, 0.31\n0.72\n0.38, 1.36\n0.308\n    county_pop_type\n\n\n\n\n0.940\n        Rural Counties\n—\n—\n—\n—\n\n        Urban Counties\n0.02\n-0.46, 0.50\n1.02\n0.63, 1.64\n0.940\n    race_cat\n\n\n\n\n0.403\n        Asian\n—\n—\n—\n—\n\n        Black\n-0.02\n-0.68, 0.65\n0.98\n0.51, 1.91\n0.958\n        Other\n-0.14\n-0.82, 0.53\n0.87\n0.44, 1.70\n0.675\n        White\n0.22\n-0.17, 0.61\n1.25\n0.84, 1.84\n0.270\n    sex_cat * factor(YEAR)\n\n\n\n\n0.035\n        Male * 2021\n-0.27\n-0.52, -0.02\n0.76\n0.59, 0.98\n0.035\n    factor(YEAR) * age_cat\n\n\n\n\n0.008\n        2021 * 25to34\n-0.85\n-1.56, -0.13\n0.43\n0.21, 0.88\n0.020\n        2021 * 35to44\n-1.10\n-1.82, -0.37\n0.33\n0.16, 0.69\n0.003\n    factor(YEAR) * Number of own children in the household\n\n\n\n\n0.480\n        2021 * Number of own children in the household\n-0.06\n-0.22, 0.11\n0.94\n0.80, 1.11\n0.480\n    factor(YEAR) * Number of own children under age 5 in household\n\n\n\n\n0.504\n        2021 * Number of own children under age 5 in household\n0.08\n-0.16, 0.33\n1.09\n0.85, 1.39\n0.504\n    factor(YEAR) * factor(CIHISPEED)\n\n\n\n\n0.449\n        2021 * 20\n-0.27\n-0.99, 0.44\n0.76\n0.37, 1.55\n0.449\n    factor(YEAR) * county_pop_type\n\n\n\n\n&lt;0.001\n        2021 * Urban Counties\n1.37\n0.83, 1.91\n3.92\n2.28, 6.72\n&lt;0.001\n    factor(YEAR) * race_cat\n\n\n\n\n0.062\n        2021 * Black\n-0.67\n-1.41, 0.06\n0.51\n0.24, 1.06\n0.073\n        2021 * Other\n-0.70\n-1.42, 0.03\n0.50\n0.24, 1.03\n0.060\n        2021 * White\n-0.58\n-1.02, -0.14\n0.56\n0.36, 0.87\n0.009\n  \n  \n  \n    \n      1 OR = Odds Ratio, CI = Confidence Interval\n    \n  \n\n\n\nmodelsummary(both, exponentiate = TRUE, # does standard and exponentiated models together \n             statistic = c(\"conf.int\",\n                           \"s.e. = {std.error}\", \n                           \"p = {p.value}\"),\n             stars = TRUE, shape = term ~  statistic,\n             notes = list('Subset of ACS Survey Data for 2019 and 2021',\n                          'Odds Ratios Shown in Table'),\n             title = 'Predictions for WFH in 2019 vs 2021')\n\n\nPredictions for WFH in 2019 vs 2021\n\n\n\n\n\n\n\n\n\n\n\n\n(1)\n\n\n\n\nEst.\n 2.5 %\n 97.5 %\ns.e. = S.E.\np = p\n\n\n\n\n(Intercept)\n0.014***\n0.006\n0.031\ns.e. = 0.006\np = &lt;0.001\n\n\nsex_catMale\n1.372**\n1.099\n1.713\ns.e. = 0.155\np = 0.005\n\n\nfactor(YEAR)2021\n11.742***\n4.688\n29.410\ns.e. = 5.500\np = &lt;0.001\n\n\nage_cat25to34\n4.011***\n2.068\n7.779\ns.e. = 1.355\np = &lt;0.001\n\n\nage_cat35to44\n6.336***\n3.257\n12.328\ns.e. = 2.151\np = &lt;0.001\n\n\nNCHILD\n0.847*\n0.733\n0.978\ns.e. = 0.062\np = 0.024\n\n\nNCHLT5\n1.181\n0.957\n1.458\ns.e. = 0.127\np = 0.121\n\n\nfactor(CIHISPEED)20\n0.715\n0.376\n1.363\ns.e. = 0.235\np = 0.308\n\n\ncounty_pop_typeUrban Counties\n1.019\n0.631\n1.645\ns.e. = 0.249\np = 0.940\n\n\nrace_catBlack\n0.982\n0.506\n1.907\ns.e. = 0.332\np = 0.958\n\n\nrace_catOther\n0.865\n0.440\n1.703\ns.e. = 0.299\np = 0.675\n\n\nrace_catWhite\n1.246\n0.843\n1.842\ns.e. = 0.248\np = 0.270\n\n\nsex_catMale × factor(YEAR)2021\n0.762*\n0.592\n0.981\ns.e. = 0.098\np = 0.035\n\n\nfactor(YEAR)2021 × age_cat25to34\n0.428*\n0.209\n0.877\ns.e. = 0.157\np = 0.020\n\n\nfactor(YEAR)2021 × age_cat35to44\n0.334**\n0.162\n0.689\ns.e. = 0.123\np = 0.003\n\n\nfactor(YEAR)2021 × NCHILD\n0.942\n0.799\n1.111\ns.e. = 0.079\np = 0.480\n\n\nfactor(YEAR)2021 × NCHLT5\n1.088\n0.850\n1.393\ns.e. = 0.137\np = 0.504\n\n\nfactor(YEAR)2021 × factor(CIHISPEED)20\n0.760\n0.373\n1.546\ns.e. = 0.275\np = 0.449\n\n\nfactor(YEAR)2021 × county_pop_typeUrban Counties\n3.917***\n2.282\n6.722\ns.e. = 1.079\np = &lt;0.001\n\n\nfactor(YEAR)2021 × race_catBlack\n0.510+\n0.244\n1.065\ns.e. = 0.192\np = 0.073\n\n\nfactor(YEAR)2021 × race_catOther\n0.499+\n0.241\n1.031\ns.e. = 0.185\np = 0.060\n\n\nfactor(YEAR)2021 × race_catWhite\n0.559**\n0.360\n0.867\ns.e. = 0.125\np = 0.009\n\n\n\n + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001\n\n\n\n\n\n\n\n Subset of ACS Survey Data for 2019 and 2021\n\n\n\n\n\n\n\n Odds Ratios Shown in Table\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nlibrary(flextable)\n\nm &lt;- list(\n  \"2019 OR\" = svyglm(did_wfh~ sex_cat + age_cat  + NCHILD + NCHLT5 + factor(CIHISPEED) + county_pop_type +race_cat,\n                    subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n                    family = quasibinomial(),\n                    design = dstrata2019),\n  \n  \"2021 OR\" =  svyglm(did_wfh~ sex_cat+ age_cat  + NCHILD + NCHLT5 + factor(CIHISPEED) + county_pop_type +race_cat,\n                    subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n                    family = quasibinomial(),\n                    design = dstrata2021)\n) \n\n# \n# modelsummary(m, exponentiate = TRUE, # does standard and exponentiated models together\n#              statistic = c(\"conf.int\",\n#                            \"s.e. = {std.error}\",\n#                            \"p = {p.value}\"),\n#              stars = TRUE, shape = term ~ model + statistic,\n#              notes = list('Subset of ACS Survey Data for 2019 and 2021',\n#                           'Odds Ratios Shown in Table'),\n#              title = 'Predictions for WFH in 2019 vs 2021',\n#              output = \"table.docx\")\n\nmodelsummary(m, exponentiate = TRUE, # does standard and exponentiated models together \n             statistic = c(\"conf.int\",\n                           \"s.e. = {std.error}\", \n                           \"p = {p.value}\"),\n             stars = TRUE, shape = term ~ model + statistic,\n             notes = list('Subset of ACS Survey Data for 2019 and 2021',\n                          'Odds Ratios Shown in Table'),\n             title = 'Predictions for WFH in 2019 vs 2021')\n\n\nPredictions for WFH in 2019 vs 2021\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2019 OR\n\n\n2021 OR\n\n\n\n\nEst.\n 2.5 %\n 97.5 %\ns.e. = S.E.\np = p\nEst.\n 2.5 %\n 97.5 %\ns.e. = S.E.\np = p\n\n\n\n\n(Intercept)\n0.014***\n0.006\n0.031\ns.e. = 0.006\np = &lt;0.001\n0.159***\n0.108\n0.234\ns.e. = 0.031\np = &lt;0.001\n\n\nsex_catMale\n1.372**\n1.099\n1.713\ns.e. = 0.155\np = 0.005\n1.045\n0.926\n1.180\ns.e. = 0.065\np = 0.476\n\n\nage_cat25to34\n4.011***\n2.068\n7.779\ns.e. = 1.355\np = &lt;0.001\n1.719***\n1.307\n2.260\ns.e. = 0.240\np = &lt;0.001\n\n\nage_cat35to44\n6.336***\n3.256\n12.329\ns.e. = 2.151\np = &lt;0.001\n2.115***\n1.586\n2.820\ns.e. = 0.310\np = &lt;0.001\n\n\nNCHILD\n0.847*\n0.733\n0.978\ns.e. = 0.062\np = 0.024\n0.798***\n0.738\n0.863\ns.e. = 0.032\np = &lt;0.001\n\n\nNCHLT5\n1.181\n0.957\n1.458\ns.e. = 0.127\np = 0.121\n1.285***\n1.130\n1.462\ns.e. = 0.085\np = &lt;0.001\n\n\nfactor(CIHISPEED)20\n0.715\n0.376\n1.363\ns.e. = 0.235\np = 0.308\n0.544***\n0.403\n0.733\ns.e. = 0.083\np = &lt;0.001\n\n\ncounty_pop_typeUrban Counties\n1.019\n0.631\n1.645\ns.e. = 0.249\np = 0.940\n3.989***\n3.110\n5.118\ns.e. = 0.507\np = &lt;0.001\n\n\nrace_catBlack\n0.982\n0.506\n1.907\ns.e. = 0.332\np = 0.958\n0.501***\n0.363\n0.690\ns.e. = 0.082\np = &lt;0.001\n\n\nrace_catOther\n0.865\n0.440\n1.703\ns.e. = 0.299\np = 0.675\n0.432***\n0.333\n0.560\ns.e. = 0.057\np = &lt;0.001\n\n\nrace_catWhite\n1.246\n0.843\n1.842\ns.e. = 0.248\np = 0.270\n0.696***\n0.570\n0.851\ns.e. = 0.071\np = &lt;0.001\n\n\nNum.Obs.\n7344\n\n\n\n\n7389\n\n\n\n\n\n\nR2\n0.024\n\n\n\n\n0.049\n\n\n\n\n\n\nR2 Adj.\n−0.155\n\n\n\n\n−0.114\n\n\n\n\n\n\nAIC\n3783.8\n\n\n\n\n9246.9\n\n\n\n\n\n\nBIC\n3851.7\n\n\n\n\n9319.8\n\n\n\n\n\n\nLog.Lik.\n−1872.464\n\n\n\n\n−4606.447\n\n\n\n\n\n\nRMSE\n0.25\n\n\n\n\n0.47\n\n\n\n\n\n\n\n + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001\n\n\n\n\n\n\n\n\n\n\n\n\n Subset of ACS Survey Data for 2019 and 2021\n\n\n\n\n\n\n\n\n\n\n\n\n Odds Ratios Shown in Table\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmodelplot(m, facet=TRUE)\n\n\n\n\n\nm4_2019 &lt;- svyglm(did_wfh~ sex_cat+ age_cat  + NCHILD + NCHLT5 + factor(CIHISPEED) + county_pop_type+INCEARN +race_cat,\n                    subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n                    family = quasibinomial(),\n                    design = dstrata2019)\n  \nm4_2021 &lt;- svyglm(did_wfh~ sex_cat+ age_cat  + NCHILD + NCHLT5 + factor(CIHISPEED) + county_pop_type+INCEARN +race_cat,\n                    subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n                    family = quasibinomial(),\n                    design = dstrata2021)\n\n\nexport_summs(m4_2019, m4_2021, model.names = c(\"Subset 2019 Logit\", \" Subset 2021 Logit\"))\n\n\n\n\n\nSubset 2019 Logit\nSubset 2021 Logit\n\n\n(Intercept)\n-4.30 ***\n-1.81 ***\n\n\n\n(0.42)   \n(0.20)   \n\n\nsex_catMale\n0.32 ** \n-0.05    \n\n\n\n(0.12)   \n(0.06)   \n\n\nage_cat25to34\n1.40 ***\n0.39 ** \n\n\n\n(0.34)   \n(0.14)   \n\n\nage_cat35to44\n1.86 ***\n0.51 ***\n\n\n\n(0.34)   \n(0.15)   \n\n\nNCHILD\n-0.17 *  \n-0.23 ***\n\n\n\n(0.07)   \n(0.04)   \n\n\nNCHLT5\n0.17    \n0.22 ** \n\n\n\n(0.11)   \n(0.07)   \n\n\nfactor(CIHISPEED)20\n-0.34    \n-0.56 ***\n\n\n\n(0.33)   \n(0.15)   \n\n\ncounty_pop_typeUrban Counties\n0.03    \n1.28 ***\n\n\n\n(0.25)   \n(0.13)   \n\n\nINCEARN\n-0.00    \n0.00 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nrace_catBlack\n-0.03    \n-0.63 ***\n\n\n\n(0.34)   \n(0.16)   \n\n\nrace_catOther\n-0.15    \n-0.78 ***\n\n\n\n(0.34)   \n(0.13)   \n\n\nrace_catWhite\n0.22    \n-0.36 ***\n\n\n\n(0.20)   \n(0.10)   \n\n\nN\n7344       \n7389       \n\n\nR2\n       \n       \n\n\n*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05.\n\n\n\n\n\n\n\n\n\nOLS Model\n\nm &lt;- list(\n  \"2019 OLS\" = svyglm(did_wfh~ sex_cat + AGE + NCHLT5 + factor(CIHISPEED) + county_pop_type +race_cat,\n                    subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n                    design = dstrata2019),\n  \n  \"2021 OLS\" =  svyglm(did_wfh ~ sex_cat+ AGE + NCHLT5 + factor(CIHISPEED) + county_pop_type +race_cat,\n                    subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n                    design = dstrata2021)\n) \n\n# \n# modelsummary(m, exponentiate = TRUE, # does standard and exponentiated models together\n#              statistic = c(\"conf.int\",\n#                            \"s.e. = {std.error}\",\n#                            \"p = {p.value}\"),\n#              stars = TRUE, shape = term ~ model + statistic,\n#              notes = list('Subset of ACS Survey Data for 2019 and 2021',\n#                           'Odds Ratios Shown in Table'),\n#              title = 'Predictions for WFH in 2019 vs 2021',\n#              output = \"table.docx\")\n\nmodelsummary(m,# exponentiate = TRUE, # does standard and exponentiated models together \n             statistic = c(\"conf.int\",\n                           \"s.e. = {std.error}\", \n                           \"p = {p.value}\"),\n             stars = TRUE, shape = term ~ model + statistic,\n             notes = list('Subset of ACS Survey Data for 2019 and 2021'),\n             title = 'OLS - Separate Models for WFH in 2019 vs 2021')\n\n\nOLS - Separate Models for WFH in 2019 vs 2021\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2019 OLS\n\n\n2021 OLS\n\n\n\n\nEst.\n 2.5 %\n 97.5 %\ns.e. = S.E.\np = p\nEst.\n 2.5 %\n 97.5 %\ns.e. = S.E.\np = p\n\n\n\n\n(Intercept)\n−0.065**\n−0.113\n−0.017\ns.e. = 0.024\np = 0.008\n0.155***\n0.066\n0.244\ns.e. = 0.046\np = &lt;0.001\n\n\nsex_catMale\n0.022**\n0.007\n0.036\ns.e. = 0.008\np = 0.004\n0.020\n−0.006\n0.047\ns.e. = 0.014\np = 0.138\n\n\nAGE\n0.003***\n0.002\n0.004\ns.e. = 0.001\np = &lt;0.001\n0.002*\n0.000\n0.004\ns.e. = 0.001\np = 0.028\n\n\nNCHLT5\n0.002\n−0.011\n0.015\ns.e. = 0.007\np = 0.796\n0.011\n−0.013\n0.035\ns.e. = 0.012\np = 0.364\n\n\nfactor(CIHISPEED)20\n−0.018\n−0.048\n0.013\ns.e. = 0.016\np = 0.250\n−0.112***\n−0.163\n−0.062\ns.e. = 0.026\np = &lt;0.001\n\n\ncounty_pop_typeUrban Counties\n0.008\n−0.021\n0.036\ns.e. = 0.015\np = 0.609\n0.268***\n0.236\n0.300\ns.e. = 0.016\np = &lt;0.001\n\n\nrace_catBlack\n−0.001\n−0.039\n0.036\ns.e. = 0.019\np = 0.942\n−0.168***\n−0.239\n−0.097\ns.e. = 0.036\np = &lt;0.001\n\n\nrace_catOther\n−0.006\n−0.042\n0.030\ns.e. = 0.018\np = 0.748\n−0.198***\n−0.256\n−0.140\ns.e. = 0.029\np = &lt;0.001\n\n\nrace_catWhite\n0.014\n−0.011\n0.039\ns.e. = 0.013\np = 0.285\n−0.091***\n−0.139\n−0.042\ns.e. = 0.025\np = &lt;0.001\n\n\nNum.Obs.\n7566\n\n\n\n\n7645\n\n\n\n\n\n\nR2\n0.011\n\n\n\n\n0.050\n\n\n\n\n\n\nR2 Adj.\n−0.175\n\n\n\n\n−0.116\n\n\n\n\n\n\nAIC\n14094.4\n\n\n\n\n45627.8\n\n\n\n\n\n\nBIC\n207869.1\n\n\n\n\n57795.7\n\n\n\n\n\n\nLog.Lik.\n−103889.882\n\n\n\n\n−28853.127\n\n\n\n\n\n\nRMSE\n0.25\n\n\n\n\n0.47\n\n\n\n\n\n\n\n + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001\n\n\n\n\n\n\n\n\n\n\n\n\n Subset of ACS Survey Data for 2019 and 2021\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#|column: page\nm4_2019 &lt;- svyglm(did_wfh ~ sex_cat+ AGE + NCHLT5 + factor(CIHISPEED) + county_pop_type+INCEARN +race_cat,\n                    subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n                    design = dstrata2019)\n  \nm4_2021 &lt;- svyglm(did_wfh ~ sex_cat+ AGE + NCHLT5 + factor(CIHISPEED) + county_pop_type+INCEARN +race_cat,\n                    subset = AGE &lt; 45 & CanWorkFromHome == \"Can WFH\" & occ_2dig_labels == \"Management, Business, Science, Arts\",\n                    design = dstrata2021)\n\n\nexport_summs(m4_2019, m4_2021, model.names = c(\"Subset 2019 OLS\", \" Subset 2021 OLS\"))\n\n\n\n\n\nSubset 2019 OLS\nSubset 2021 OLS\n\n\n(Intercept)\n-0.07 ** \n0.21 ***\n\n\n\n(0.03)   \n(0.05)   \n\n\nsex_catMale\n0.02 ** \n-0.00    \n\n\n\n(0.01)   \n(0.01)   \n\n\nAGE\n0.00 ***\n-0.00    \n\n\n\n(0.00)   \n(0.00)   \n\n\nNCHLT5\n0.00    \n0.00    \n\n\n\n(0.01)   \n(0.01)   \n\n\nfactor(CIHISPEED)20\n-0.02    \n-0.10 ***\n\n\n\n(0.02)   \n(0.03)   \n\n\ncounty_pop_typeUrban Counties\n0.01    \n0.24 ***\n\n\n\n(0.01)   \n(0.02)   \n\n\nINCEARN\n-0.00    \n0.00 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nrace_catBlack\n-0.00    \n-0.15 ***\n\n\n\n(0.02)   \n(0.04)   \n\n\nrace_catOther\n-0.01    \n-0.18 ***\n\n\n\n(0.02)   \n(0.03)   \n\n\nrace_catWhite\n0.01    \n-0.09 ***\n\n\n\n(0.01)   \n(0.02)   \n\n\nN\n7566       \n7645       \n\n\nR2\n0.01    \n0.06    \n\n\n*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05.\n\n\n\n\n\n\nt1 &lt;- m4_2019 %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3)\n\n                 ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\nt2 &lt;- m4_2021 %&gt;%\n  tbl_regression(intercept = T,     # No intercept in OR table\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3)\n                 ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\n\ntbl_merge(\n  tbls = list(t1, t2),\n  tab_spanner = c(\"**OLS 2019 Subset**\", \"**OLS 2021 Subset**\")\n)\n\n\n\n\n\n  \n    \n    \n      Characteristic\n      \n        OLS 2019 Subset\n      \n      \n        OLS 2021 Subset\n      \n    \n    \n      Beta\n      95% CI1\n      p-value\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n-0.07\n-0.12, -0.02\n0.008\n0.21\n0.12, 0.30\n&lt;0.001\n    sex_cat\n\n\n0.004\n\n\n0.984\n        Female\n—\n—\n\n—\n—\n\n        Male\n0.02\n0.01, 0.04\n0.004\n0.00\n-0.03, 0.03\n0.984\n    Age\n0.00\n0.00, 0.00\n&lt;0.001\n0.00\n0.00, 0.00\n0.845\n    Number of own children under age 5 in household\n0.00\n-0.01, 0.02\n0.757\n0.00\n-0.02, 0.02\n0.941\n    factor(CIHISPEED)\n\n\n0.241\n\n\n&lt;0.001\n        10\n—\n—\n\n—\n—\n\n        20\n-0.02\n-0.05, 0.01\n0.241\n-0.10\n-0.15, -0.05\n&lt;0.001\n    county_pop_type\n\n\n0.570\n\n\n&lt;0.001\n        Rural Counties\n—\n—\n\n—\n—\n\n        Urban Counties\n0.01\n-0.02, 0.04\n0.570\n0.24\n0.21, 0.28\n&lt;0.001\n    Total personal earned income\n0.00\n0.00, 0.00\n0.430\n0.00\n0.00, 0.00\n&lt;0.001\n    race_cat\n\n\n0.363\n\n\n&lt;0.001\n        Asian\n—\n—\n\n—\n—\n\n        Black\n0.00\n-0.04, 0.03\n0.895\n-0.15\n-0.22, -0.08\n&lt;0.001\n        Other\n-0.01\n-0.04, 0.03\n0.709\n-0.18\n-0.24, -0.12\n&lt;0.001\n        White\n0.01\n-0.01, 0.04\n0.299\n-0.09\n-0.14, -0.04\n&lt;0.001\n  \n  \n  \n    \n      1 CI = Confidence Interval"
  },
  {
    "objectID": "WFH_Models.html#models-with-both-years-together",
    "href": "WFH_Models.html#models-with-both-years-together",
    "title": "Models for Paper",
    "section": "Models with both years together",
    "text": "Models with both years together\n\nOLS\n\nboth &lt;- svyglm(did_wfh~ CanWorkFromHome+county_pop_type+ NCHILD + NCHLT5 +\n                 INCEARN +race_cat+ sex_cat + age_cat + CIHISPEED + \n                 occ_2dig_labels + factor(YEAR), design = dstrata)\n\n\nols2021 &lt;- svyglm(did_wfh~ CanWorkFromHome+county_pop_type+ NCHILD + NCHLT5 +\n                    INCEARN +race_cat+ sex_cat + age_cat + CIHISPEED + \n                    occ_2dig_labels, design = dstrata2021)\n\nsummary(ols2021)\n\n\nCall:\nsvyglm(formula = did_wfh ~ CanWorkFromHome + county_pop_type + \n    NCHILD + NCHLT5 + INCEARN + race_cat + sex_cat + age_cat + \n    CIHISPEED + occ_2dig_labels, design = dstrata2021)\n\nSurvey design:\nCalled via srvyr\n\nCoefficients:\n                                                 Estimate Std. Error t value\n(Intercept)                                     2.686e-01  1.480e-02  18.154\nCanWorkFromHomeNo WFH                          -1.729e-01  6.169e-03 -28.027\nCanWorkFromHomeSome WFH                        -3.493e-03  8.254e-03  -0.423\ncounty_pop_typeUrban Counties                   8.313e-02  5.126e-03  16.217\nNCHILD                                         -1.308e-02  2.385e-03  -5.482\nNCHLT5                                          2.172e-02  6.614e-03   3.284\nINCEARN                                         4.987e-07  3.673e-08  13.577\nrace_catBlack                                  -4.165e-02  1.208e-02  -3.446\nrace_catOther                                  -5.583e-02  1.091e-02  -5.119\nrace_catWhite                                  -2.621e-02  1.011e-02  -2.593\nsex_catMale                                    -1.473e-02  4.442e-03  -3.317\nage_cat25to34                                   4.491e-02  7.654e-03   5.868\nage_cat35to44                                   5.243e-02  8.047e-03   6.515\nage_cat45to54                                   2.769e-02  7.826e-03   3.538\nage_cat55to64                                   1.292e-02  7.547e-03   1.712\nage_cat65+                                      2.953e-02  9.874e-03   2.990\nCIHISPEED                                      -3.788e-03  5.505e-04  -6.880\nocc_2dig_labelsMilitary                        -4.541e-02  3.749e-02  -1.211\nocc_2dig_labelsNatural Resources, Construction -5.842e-02  7.979e-03  -7.321\nocc_2dig_labelsProduction, Transportation      -6.040e-02  6.813e-03  -8.866\nocc_2dig_labelsSales & Office Jobs             -2.410e-02  6.747e-03  -3.572\nocc_2dig_labelsService Occupations             -5.528e-02  6.880e-03  -8.034\n                                               Pr(&gt;|t|)    \n(Intercept)                                     &lt; 2e-16 ***\nCanWorkFromHomeNo WFH                           &lt; 2e-16 ***\nCanWorkFromHomeSome WFH                        0.672172    \ncounty_pop_typeUrban Counties                   &lt; 2e-16 ***\nNCHILD                                         4.25e-08 ***\nNCHLT5                                         0.001024 ** \nINCEARN                                         &lt; 2e-16 ***\nrace_catBlack                                  0.000569 ***\nrace_catOther                                  3.09e-07 ***\nrace_catWhite                                  0.009519 ** \nsex_catMale                                    0.000911 ***\nage_cat25to34                                  4.46e-09 ***\nage_cat35to44                                  7.36e-11 ***\nage_cat45to54                                  0.000404 ***\nage_cat55to64                                  0.086856 .  \nage_cat65+                                     0.002788 ** \nCIHISPEED                                      6.09e-12 ***\nocc_2dig_labelsMilitary                        0.225805    \nocc_2dig_labelsNatural Resources, Construction 2.51e-13 ***\nocc_2dig_labelsProduction, Transportation       &lt; 2e-16 ***\nocc_2dig_labelsSales & Office Jobs             0.000354 ***\nocc_2dig_labelsService Occupations             9.71e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.1367503)\n\nNumber of Fisher Scoring iterations: 2\n\nexport_summs(both, ols2021, model.names = c(\"Both Years OLS\", \" Only 2021 OLS\"))\n\n\n\n\n\nBoth Years OLS\nOnly 2021 OLS\n\n\n(Intercept)\n0.08 ***\n0.27 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nCanWorkFromHomeNo WFH\n-0.10 ***\n-0.17 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nCanWorkFromHomeSome WFH\n0.00    \n-0.00    \n\n\n\n(0.00)   \n(0.01)   \n\n\ncounty_pop_typeUrban Counties\n0.05 ***\n0.08 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nNCHILD\n-0.01 ***\n-0.01 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nNCHLT5\n0.02 ***\n0.02 ** \n\n\n\n(0.00)   \n(0.01)   \n\n\nINCEARN\n0.00 ***\n0.00 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nrace_catBlack\n-0.03 ***\n-0.04 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nrace_catOther\n-0.04 ***\n-0.06 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nrace_catWhite\n-0.01    \n-0.03 ** \n\n\n\n(0.01)   \n(0.01)   \n\n\nsex_catMale\n-0.01 *  \n-0.01 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nage_cat25to34\n0.03 ***\n0.04 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nage_cat35to44\n0.04 ***\n0.05 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nage_cat45to54\n0.03 ***\n0.03 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nage_cat55to64\n0.03 ***\n0.01    \n\n\n\n(0.00)   \n(0.01)   \n\n\nage_cat65+\n0.04 ***\n0.03 ** \n\n\n\n(0.01)   \n(0.01)   \n\n\nCIHISPEED\n-0.00 ***\n-0.00 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nocc_2dig_labelsMilitary\n-0.04 ** \n-0.05    \n\n\n\n(0.02)   \n(0.04)   \n\n\nocc_2dig_labelsNatural Resources, Construction\n-0.03 ***\n-0.06 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nocc_2dig_labelsProduction, Transportation\n-0.04 ***\n-0.06 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsSales & Office Jobs\n-0.01 ** \n-0.02 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsService Occupations\n-0.02 ***\n-0.06 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nfactor(YEAR)2021\n0.14 ***\n       \n\n\n\n(0.00)   \n       \n\n\nN\n109132       \n53982       \n\n\nR2\n0.11    \n0.12    \n\n\n*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05.\n\n\n\n\n\n\nt1 &lt;- both %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3)\n\n                 ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\nt2 &lt;- ols2021 %&gt;%\n  tbl_regression(intercept = T,     # No intercept in OR table\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3)\n                 ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\n\ntbl_merge(\n  tbls = list(t2),\n  tab_spanner = c(\"**OLS 2021 Full Model**\")\n)\n\n\n\n\n\n  \n    \n    \n      Characteristic\n      \n        OLS 2021 Full Model\n      \n    \n    \n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n0.27\n0.24, 0.30\n&lt;0.001\n    CanWorkFromHome\n\n\n&lt;0.001\n        Can WFH\n—\n—\n\n        No WFH\n-0.17\n-0.18, -0.16\n&lt;0.001\n        Some WFH\n0.00\n-0.02, 0.01\n0.672\n    county_pop_type\n\n\n&lt;0.001\n        Rural Counties\n—\n—\n\n        Urban Counties\n0.08\n0.07, 0.09\n&lt;0.001\n    Number of own children in the household\n-0.01\n-0.02, -0.01\n&lt;0.001\n    Number of own children under age 5 in household\n0.02\n0.01, 0.03\n0.001\n    Total personal earned income\n0.00\n0.00, 0.00\n&lt;0.001\n    race_cat\n\n\n&lt;0.001\n        Asian\n—\n—\n\n        Black\n-0.04\n-0.07, -0.02\n&lt;0.001\n        Other\n-0.06\n-0.08, -0.03\n&lt;0.001\n        White\n-0.03\n-0.05, -0.01\n0.010\n    sex_cat\n\n\n&lt;0.001\n        Female\n—\n—\n\n        Male\n-0.01\n-0.02, -0.01\n&lt;0.001\n    age_cat\n\n\n&lt;0.001\n        16to24\n—\n—\n\n        25to34\n0.04\n0.03, 0.06\n&lt;0.001\n        35to44\n0.05\n0.04, 0.07\n&lt;0.001\n        45to54\n0.03\n0.01, 0.04\n&lt;0.001\n        55to64\n0.01\n0.00, 0.03\n0.087\n        65+\n0.03\n0.01, 0.05\n0.003\n    Broadband (high speed) Internet service such as cable, fiber optic, or DSL service\n0.00\n0.00, 0.00\n&lt;0.001\n    occ_2dig_labels\n\n\n&lt;0.001\n        Management, Business, Science, Arts\n—\n—\n\n        Military\n-0.05\n-0.12, 0.03\n0.226\n        Natural Resources, Construction\n-0.06\n-0.07, -0.04\n&lt;0.001\n        Production, Transportation\n-0.06\n-0.07, -0.05\n&lt;0.001\n        Sales & Office Jobs\n-0.02\n-0.04, -0.01\n&lt;0.001\n        Service Occupations\n-0.06\n-0.07, -0.04\n&lt;0.001\n  \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\n\n\n\nLogit\n\nboth &lt;- svyglm(did_wfh ~ CanWorkFromHome + occ_2dig_labels + factor(YEAR) + \n                 county_pop_type+ NCHILD + NCHLT5 + INCEARN +race_cat+ sex_cat \n               + age_cat, \n        family = quasibinomial(), design = dstrata)\n\n\n\nOR.CI_Both &lt;- cbind(\"AOR\" = exp(   coef(both)),\n                       exp(confint(both,\n                           df.resid=degf(both$survey.design))))[-1,]\n#round(OR.CI_2019, 3)\n\nt1 &lt;- both %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2)) %&gt;%\n  modify_column_hide(p.value) %&gt;%\n  modify_caption(\"Logit - 2019 & 2021 ACS Data Together\")\n\nt2 &lt;- both %&gt;%\n  tbl_regression(intercept = F,     # No intercept in OR table\n                 exponentiate = T,  # OR = exp(B)\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3)) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\ntbl_merge(\n  tbls = list(t1, t2),\n  tab_spanner = c(\"**Regression Coefficients**\", \"**Adjusted Odds Ratio**\")\n)\n\n\n\n\n\n  Logit - 2019 & 2021 ACS Data Together\n  \n    \n    \n      Characteristic\n      \n        Regression Coefficients\n      \n      \n        Adjusted Odds Ratio\n      \n    \n    \n      log(OR)1\n      95% CI1\n      OR1\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n-3.40\n-3.58, -3.22\n\n\n\n    CanWorkFromHome\n\n\n\n\n&lt;0.001\n        Can WFH\n—\n—\n—\n—\n\n        No WFH\n-0.99\n-1.07, -0.92\n0.37\n0.34, 0.40\n&lt;0.001\n        Some WFH\n0.01\n-0.05, 0.07\n1.01\n0.95, 1.08\n0.758\n    occ_2dig_labels\n\n\n\n\n&lt;0.001\n        Management, Business, Science, Arts\n—\n—\n—\n—\n\n        Military\n-1.00\n-2.06, 0.06\n0.37\n0.13, 1.06\n0.065\n        Natural Resources, Construction\n-0.59\n-0.76, -0.41\n0.56\n0.47, 0.66\n&lt;0.001\n        Production, Transportation\n-0.85\n-0.99, -0.71\n0.43\n0.37, 0.49\n&lt;0.001\n        Sales & Office Jobs\n-0.09\n-0.16, -0.03\n0.91\n0.85, 0.97\n0.007\n        Service Occupations\n-0.41\n-0.53, -0.30\n0.66\n0.59, 0.74\n&lt;0.001\n    factor(YEAR)\n\n\n\n\n&lt;0.001\n        2019\n—\n—\n—\n—\n\n        2021\n1.53\n1.47, 1.60\n4.64\n4.36, 4.94\n&lt;0.001\n    county_pop_type\n\n\n\n\n&lt;0.001\n        Rural Counties\n—\n—\n—\n—\n\n        Urban Counties\n0.59\n0.51, 0.68\n1.81\n1.66, 1.97\n&lt;0.001\n    Number of own children in the household\n-0.06\n-0.09, -0.03\n0.94\n0.92, 0.97\n&lt;0.001\n    Number of own children under age 5 in household\n0.14\n0.07, 0.20\n1.15\n1.07, 1.23\n&lt;0.001\n    Total personal earned income\n0.00\n0.00, 0.00\n1.00\n1.00, 1.00\n&lt;0.001\n    race_cat\n\n\n\n\n&lt;0.001\n        Asian\n—\n—\n—\n—\n\n        Black\n-0.29\n-0.42, -0.16\n0.75\n0.66, 0.85\n&lt;0.001\n        Other\n-0.40\n-0.53, -0.28\n0.67\n0.59, 0.75\n&lt;0.001\n        White\n-0.06\n-0.16, 0.03\n0.94\n0.85, 1.03\n0.185\n    sex_cat\n\n\n\n\n0.013\n        Female\n—\n—\n—\n—\n\n        Male\n-0.06\n-0.11, -0.01\n0.94\n0.89, 0.99\n0.013\n    age_cat\n\n\n\n\n&lt;0.001\n        16to24\n—\n—\n—\n—\n\n        25to34\n0.59\n0.45, 0.73\n1.81\n1.58, 2.07\n&lt;0.001\n        35to44\n0.68\n0.54, 0.82\n1.98\n1.72, 2.27\n&lt;0.001\n        45to54\n0.61\n0.47, 0.75\n1.84\n1.60, 2.11\n&lt;0.001\n        55to64\n0.54\n0.40, 0.67\n1.71\n1.49, 1.96\n&lt;0.001\n        65+\n0.69\n0.54, 0.84\n2.00\n1.72, 2.32\n&lt;0.001\n  \n  \n  \n    \n      1 OR = Odds Ratio, CI = Confidence Interval\n    \n  \n\n\n\n\nlog-odds to odds-ratio: exp(log-odds)\nodds-ratio to %: (OR-1) * 100"
  },
  {
    "objectID": "WFH_Models.html#variation-of-models---mostly-ignore",
    "href": "WFH_Models.html#variation-of-models---mostly-ignore",
    "title": "Models for Paper",
    "section": "Variation of Models - mostly ignore",
    "text": "Variation of Models - mostly ignore\n\n\nCode\nlibrary(huxtable) # for summ() and regression output formatting\nlibrary(jtools)\nlibrary(modelsummary)\n\n#svyglm(did_wfh~ INCEARN + race_cat+ SEX+ CIHISPEED+CINETHH + occ_2dig_labels+CanWorkFromHome+county_pop_type, design = dstrata2021) %&gt;% summary()\n\n\n\n### All variations of family = \"\" had same results \n# m1_2019 &lt;- svyglm(did_wfh~ INCEARN +race_cat+ SEX+ AGE + CIHISPEED*CINETHH + CanWorkFromHome+county_pop_type+NCHILD+MARST + NCHLT5, \n#       family = \"binomial\", design = dstrata2019)\n# \n# m1_2021&lt;- svyglm(did_wfh~ INCEARN +race_cat+ SEX+ AGE + CIHISPEED*CINETHH + CanWorkFromHome+county_pop_type+NCHILD+MARST + NCHLT5, \n#       family = \"binomial\", design = dstrata2021)\n#   \n# export_summs(m1_2019, m1_2021, \n#              model.names = c(\"2019 Logit\", \"2021 Logit\"), \n#             robust = \"HC3\", statistics = c(N = \"nobs\", R2 = \"r.squared\", adjR2 = \"adj.r.squared\"))\n# \n# \n# m1_2019 &lt;- svyglm(did_wfh~ INCEARN +race_cat+ SEX+ AGE + CIHISPEED*CINETHH + CanWorkFromHome+county_pop_type+NCHILD+MARST + NCHLT5, \n#        family = quasibinomial(), design = dstrata2019)\n# \n# m1_2021&lt;- svyglm(did_wfh~ INCEARN +race_cat+ SEX+ AGE + CIHISPEED*CINETHH + CanWorkFromHome+county_pop_type+NCHILD+MARST + NCHLT5, \n#     family=quasibinomial(),   design = dstrata2021)\n#   \n# \n# export_summs(m1_2019, m1_2021, \n#              model.names = c(\"2019 QuasiBi\", \"2021 QuasiBi\"), \n#             robust = \"HC3\", statistics = c(N = \"nobs\", R2 = \"r.squared\", adjR2 = \"adj.r.squared\"))\n\n\nm1_2019 &lt;- svyglm(did_wfh~ CanWorkFromHome + county_pop_type + NCHILD + NCHLT5 + occ_2dig_labels+ INCEARN + race_cat+ sex_cat+ age_cat, \n        family = quasibinomial(),design = dstrata2019)\n\nm1_2021&lt;- svyglm(did_wfh~ CanWorkFromHome + county_pop_type + NCHILD + NCHLT5 + occ_2dig_labels+ INCEARN + race_cat+ sex_cat+ age_cat, \n      family = quasibinomial(), design = dstrata2021)\n  \nexport_summs(m1_2019, m1_2021, \n             model.names = c(\"2019 Logit\", \"2021 Logit\"), \n            robust = \"HC3\", statistics = c(N = \"nobs\", R2 = \"r.squared\", adjR2 = \"adj.r.squared\"))\n\n\n\n\n\n\n2019 Logit\n2021 Logit\n\n\n(Intercept)\n-3.86 ***\n-1.78 ***\n\n\n\n(0.19)   \n(0.11)   \n\n\nCanWorkFromHomeNo WFH\n-0.64 ***\n-1.12 ***\n\n\n\n(0.07)   \n(0.04)   \n\n\nCanWorkFromHomeSome WFH\n0.07    \n-0.02    \n\n\n\n(0.07)   \n(0.04)   \n\n\ncounty_pop_typeUrban Counties\n0.17 *  \n0.78 ***\n\n\n\n(0.07)   \n(0.05)   \n\n\nNCHILD\n0.01    \n-0.09 ***\n\n\n\n(0.03)   \n(0.02)   \n\n\nNCHLT5\n0.13 *  \n0.15 ***\n\n\n\n(0.06)   \n(0.04)   \n\n\nocc_2dig_labelsMilitary\n-11.64 ***\n-0.56    \n\n\n\n(0.25)   \n(0.56)   \n\n\nocc_2dig_labelsNatural Resources, Construction\n-0.30    \n-0.72 ***\n\n\n\n(0.16)   \n(0.10)   \n\n\nocc_2dig_labelsProduction, Transportation\n-0.84 ***\n-0.84 ***\n\n\n\n(0.14)   \n(0.08)   \n\n\nocc_2dig_labelsSales & Office Jobs\n0.03    \n-0.14 ***\n\n\n\n(0.07)   \n(0.04)   \n\n\nocc_2dig_labelsService Occupations\n0.06    \n-0.63 ***\n\n\n\n(0.10)   \n(0.07)   \n\n\nINCEARN\n0.00    \n0.00 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nrace_catBlack\n-0.36 *  \n-0.27 ***\n\n\n\n(0.15)   \n(0.08)   \n\n\nrace_catOther\n-0.48 ** \n-0.42 ***\n\n\n\n(0.17)   \n(0.07)   \n\n\nrace_catWhite\n0.17    \n-0.14 *  \n\n\n\n(0.10)   \n(0.06)   \n\n\nsex_catMale\n0.07    \n-0.11 ***\n\n\n\n(0.05)   \n(0.03)   \n\n\nage_cat25to34\n0.78 ***\n0.53 ***\n\n\n\n(0.17)   \n(0.08)   \n\n\nage_cat35to44\n1.04 ***\n0.58 ***\n\n\n\n(0.16)   \n(0.08)   \n\n\nage_cat45to54\n1.18 ***\n0.42 ***\n\n\n\n(0.16)   \n(0.08)   \n\n\nage_cat55to64\n1.22 ***\n0.30 ***\n\n\n\n(0.16)   \n(0.08)   \n\n\nage_cat65+\n1.51 ***\n0.39 ***\n\n\n\n(0.16)   \n(0.09)   \n\n\nN\n58226       \n56349       \n\n\nR2\n       \n       \n\n\nStandard errors are heteroskedasticity robust. *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05.\n\n\n\n\n\n\n\n\n\nCode\nOR.CI_2019 &lt;- cbind(\"AOR\" = exp(   coef(m1_2019)),\n                       exp(confint(m1_2019,\n                           df.resid=degf(m1_2019$survey.design))))[-1,]\n\nOR.CI_2021 &lt;- cbind(\"AOR\" = exp(   coef(m1_2021)),\n                       exp(confint(m1_2021,\n                           df.resid=degf(m1_2021$survey.design))))[-1,]\n\nlibrary(gtsummary)\nlibrary(car)\n\nt1 &lt;- m1_2019 %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n) %&gt;%\n  modify_column_hide(p.value) %&gt;%\n  modify_caption(\"2019  vs 2021 ACS Data - Logit Models\")\n\nt2 &lt;- m1_2019 %&gt;%\n  tbl_regression(intercept = F,     # No intercept in OR table\n                 exponentiate = T,  # OR = exp(B)\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3),\n) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\n# tbl_merge(\n#   tbls = list(t1, t2),\n#   tab_spanner = c(\"**2019 Regression Coefficients**\", \"** 2019 Adjusted Odds Ratio**\")\n# )\n\n\nt3 &lt;- m1_2021 %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n) %&gt;%\n  modify_column_hide(p.value) %&gt;%\n  modify_caption(\"2021 ACS\")\n\nt4 &lt;- m1_2021 %&gt;%\n  tbl_regression(intercept = F,     # No intercept in OR table\n                 exponentiate = T,  # OR = exp(B)\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3) ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\")\n\n# tbl_merge(\n#   tbls = list(t3, t4),\n#   tab_spanner = c(\"**Regression Coefficients**\", \"**Adjusted Odds Ratio**\")\n# )\n\n\ntbl_merge(\n  tbls = list(t1, t2, t3, t4),\n  tab_spanner = c(\"**2019 Regression Coefficients**\", \"**2019 Adjusted Odds Ratio**\", \"**2021 Regression Coefficients**\", \"**2021 Adjusted Odds Ratio**\")\n)\n\n\n\n\n\n\n  2019  vs 2021 ACS Data - Logit Models\n  \n    \n    \n      Characteristic\n      \n        2019 Regression Coefficients\n      \n      \n        2019 Adjusted Odds Ratio\n      \n      \n        2021 Regression Coefficients\n      \n      \n        2021 Adjusted Odds Ratio\n      \n    \n    \n      log(OR)1\n      95% CI1\n      OR1\n      95% CI1\n      p-value\n      log(OR)1\n      95% CI1\n      OR1\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n-3.86\n-4.24, -3.48\n\n\n\n-1.78\n-1.98, -1.57\n\n\n\n    CanWorkFromHome\n\n\n\n\n&lt;0.001\n\n\n\n\n&lt;0.001\n        Can WFH\n—\n—\n—\n—\n\n—\n—\n—\n—\n\n        No WFH\n-0.64\n-0.79, -0.50\n0.53\n0.46, 0.61\n&lt;0.001\n-1.12\n-1.21, -1.04\n0.33\n0.30, 0.35\n&lt;0.001\n        Some WFH\n0.07\n-0.06, 0.21\n1.08\n0.95, 1.23\n0.264\n-0.02\n-0.09, 0.06\n0.98\n0.91, 1.06\n0.690\n    county_pop_type\n\n\n\n\n0.022\n\n\n\n\n&lt;0.001\n        Rural Counties\n—\n—\n—\n—\n\n—\n—\n—\n—\n\n        Urban Counties\n0.17\n0.02, 0.31\n1.18\n1.02, 1.37\n0.022\n0.78\n0.68, 0.89\n2.19\n1.97, 2.43\n&lt;0.001\n    Number of own children in the household\n0.01\n-0.04, 0.07\n1.01\n0.96, 1.07\n0.632\n-0.09\n-0.12, -0.05\n0.92\n0.89, 0.95\n&lt;0.001\n    Number of own children under age 5 in household\n0.13\n0.00, 0.25\n1.13\n1.00, 1.29\n0.048\n0.15\n0.06, 0.23\n1.16\n1.06, 1.26\n&lt;0.001\n    occ_2dig_labels\n\n\n\n\n&lt;0.001\n\n\n\n\n&lt;0.001\n        Management, Business, Science, Arts\n—\n—\n—\n—\n\n—\n—\n—\n—\n\n        Military\n-11.64\n-12.13, -11.16\n0.00\n0.00, 0.00\n&lt;0.001\n-0.56\n-1.67, 0.54\n0.57\n0.19, 1.72\n0.319\n        Natural Resources, Construction\n-0.30\n-0.61, 0.01\n0.74\n0.54, 1.01\n0.061\n-0.72\n-0.93, -0.52\n0.48\n0.40, 0.59\n&lt;0.001\n        Production, Transportation\n-0.84\n-1.12, -0.55\n0.43\n0.33, 0.57\n&lt;0.001\n-0.84\n-1.00, -0.68\n0.43\n0.37, 0.51\n&lt;0.001\n        Sales & Office Jobs\n0.03\n-0.12, 0.17\n1.03\n0.89, 1.19\n0.701\n-0.14\n-0.21, -0.06\n0.87\n0.81, 0.94\n&lt;0.001\n        Service Occupations\n0.06\n-0.13, 0.25\n1.06\n0.87, 1.29\n0.549\n-0.63\n-0.77, -0.49\n0.53\n0.46, 0.61\n&lt;0.001\n    Total personal earned income\n0.00\n0.00, 0.00\n1.00\n1.00, 1.00\n0.495\n0.00\n0.00, 0.00\n1.00\n1.00, 1.00\n&lt;0.001\n    race_cat\n\n\n\n\n&lt;0.001\n\n\n\n\n&lt;0.001\n        Asian\n—\n—\n—\n—\n\n—\n—\n—\n—\n\n        Black\n-0.36\n-0.65, -0.07\n0.70\n0.52, 0.93\n0.014\n-0.27\n-0.42, -0.12\n0.77\n0.66, 0.89\n&lt;0.001\n        Other\n-0.48\n-0.82, -0.15\n0.62\n0.44, 0.86\n0.005\n-0.42\n-0.56, -0.28\n0.66\n0.57, 0.76\n&lt;0.001\n        White\n0.17\n-0.04, 0.37\n1.18\n0.96, 1.45\n0.108\n-0.14\n-0.25, -0.03\n0.87\n0.78, 0.97\n0.013\n    sex_cat\n\n\n\n\n0.170\n\n\n\n\n&lt;0.001\n        Female\n—\n—\n—\n—\n\n—\n—\n—\n—\n\n        Male\n0.07\n-0.03, 0.17\n1.07\n0.97, 1.19\n0.170\n-0.11\n-0.17, -0.05\n0.89\n0.84, 0.95\n&lt;0.001\n    age_cat\n\n\n\n\n&lt;0.001\n\n\n\n\n&lt;0.001\n        16to24\n—\n—\n—\n—\n\n—\n—\n—\n—\n\n        25to34\n0.78\n0.46, 1.11\n2.19\n1.58, 3.03\n&lt;0.001\n0.53\n0.38, 0.69\n1.71\n1.46, 1.99\n&lt;0.001\n        35to44\n1.04\n0.72, 1.36\n2.83\n2.06, 3.89\n&lt;0.001\n0.58\n0.42, 0.74\n1.79\n1.52, 2.09\n&lt;0.001\n        45to54\n1.18\n0.86, 1.49\n3.25\n2.37, 4.46\n&lt;0.001\n0.42\n0.26, 0.58\n1.52\n1.30, 1.78\n&lt;0.001\n        55to64\n1.22\n0.91, 1.54\n3.40\n2.49, 4.64\n&lt;0.001\n0.30\n0.15, 0.46\n1.36\n1.16, 1.58\n&lt;0.001\n        65+\n1.51\n1.19, 1.83\n4.54\n3.29, 6.25\n&lt;0.001\n0.39\n0.21, 0.56\n1.47\n1.24, 1.76\n&lt;0.001\n  \n  \n  \n    \n      1 OR = Odds Ratio, CI = Confidence Interval\n    \n  \n\n\n\n\n\nPrediction\nInterpreation examples\nWhat is the predicted probability (and 95% CI) that someone worked from home in 2019 and male, and between 25 and 34 years old?\n\n# Always include the intercept for prediction.\n# Specify a 1 for the intercept, a # for each continuous predictor\n# and a 1 for each non-reference level of a categorical variable.\n# If a predictor is at its reference level, specify a 0 or exclude it.\n#install.packages(\"faraway\")\nlibrary(faraway)\n\nilogit(svycontrast(m1_2019, c(\"(Intercept)\" = 1,\n                              \"age_cat25to34\" =1                             )))\n\n         contrast     SE\ncontrast 0.044206 0.1472"
  },
  {
    "objectID": "WFH_Models.html#model-2",
    "href": "WFH_Models.html#model-2",
    "title": "Models for Paper",
    "section": "Model 2",
    "text": "Model 2\n\nm3_2019 &lt;- svyglm(did_wfh~occ_2dig_labels*CanWorkFromHome+race_cat+ SEX+ age_cat +CIHISPEED*CINETHH + county_pop_type+NCHILD*NCHLT5, design = dstrata2019)\nm3_2021 &lt;- svyglm(did_wfh~occ_2dig_labels*CanWorkFromHome+race_cat+ SEX+ age_cat +CIHISPEED*CINETHH + county_pop_type+NCHILD*NCHLT5, design = dstrata2021)# %&gt;% summary()\n\nexport_summs(m3_2019, m3_2021,\n             model.names = c(\"2019\", \"2021\"),\n            robust = \"HC3\", statistics = c(N = \"nobs\", R2 = \"r.squared\", adjR2 = \"adj.r.squared\"))\n\n\n\n\n\n2019\n2021\n\n\n(Intercept)\n0.06 ***\n0.29 ***\n\n\n\n(0.01)   \n(0.02)   \n\n\nocc_2dig_labelsMilitary\n-0.03 ***\n-0.02    \n\n\n\n(0.01)   \n(0.04)   \n\n\nocc_2dig_labelsNatural Resources, Construction\n-0.09 ***\n-0.00    \n\n\n\n(0.00)   \n(0.23)   \n\n\nocc_2dig_labelsProduction, Transportation\n-0.08 ***\n-0.25 ***\n\n\n\n(0.00)   \n(0.04)   \n\n\nocc_2dig_labelsSales & Office Jobs\n-0.01    \n-0.08 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nocc_2dig_labelsService Occupations\n-0.01    \n-0.21 ***\n\n\n\n(0.01)   \n(0.02)   \n\n\nCanWorkFromHomeNo WFH\n-0.04 ***\n-0.22 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nCanWorkFromHomeSome WFH\n-0.00    \n-0.01    \n\n\n\n(0.01)   \n(0.01)   \n\n\nrace_catBlack\n-0.01    \n-0.05 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nrace_catOther\n-0.01    \n-0.06 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nrace_catWhite\n0.01 *  \n-0.03 ** \n\n\n\n(0.01)   \n(0.01)   \n\n\nSEX\n-0.00    \n0.00    \n\n\n\n(0.00)   \n(0.00)   \n\n\nage_cat25to34\n0.02 ***\n0.06 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nage_cat35to44\n0.03 ***\n0.07 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nage_cat45to54\n0.04 ***\n0.05 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nage_cat55to64\n0.04 ***\n0.04 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nage_cat65+\n0.06 ***\n0.05 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nCIHISPEED\n-0.00 ***\n-0.00 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\ncounty_pop_typeUrban Counties\n0.01 *  \n0.09 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nNCHILD\n0.00    \n-0.01 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nNCHLT5\n0.02 ** \n0.05 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nocc_2dig_labelsNatural Resources, Construction:CanWorkFromHomeNo WFH\n0.07 ***\n-0.04    \n\n\n\n(0.01)   \n(0.23)   \n\n\nocc_2dig_labelsProduction, Transportation:CanWorkFromHomeNo WFH\n0.06 ***\n0.21 ***\n\n\n\n(0.01)   \n(0.04)   \n\n\nocc_2dig_labelsSales & Office Jobs:CanWorkFromHomeNo WFH\n0.01    \n0.10 ***\n\n\n\n(0.01)   \n(0.01)   \n\n\nocc_2dig_labelsService Occupations:CanWorkFromHomeNo WFH\n0.01    \n0.18 ***\n\n\n\n(0.01)   \n(0.02)   \n\n\nocc_2dig_labelsNatural Resources, Construction:CanWorkFromHomeSome WFH\n0.40    \n-0.30    \n\n\n\n(0.30)   \n(0.23)   \n\n\nocc_2dig_labelsProduction, Transportation:CanWorkFromHomeSome WFH\n0.07    \n0.31    \n\n\n\n(0.05)   \n(0.16)   \n\n\nocc_2dig_labelsSales & Office Jobs:CanWorkFromHomeSome WFH\n0.04 ** \n0.03    \n\n\n\n(0.01)   \n(0.02)   \n\n\nocc_2dig_labelsService Occupations:CanWorkFromHomeSome WFH\n-0.01    \n0.15 ** \n\n\n\n(0.03)   \n(0.06)   \n\n\nNCHILD:NCHLT5\n-0.01 ** \n-0.01 ** \n\n\n\n(0.00)   \n(0.00)   \n\n\nN\n55150       \n53982       \n\n\nR2\n0.02    \n0.12    \n\n\nStandard errors are heteroskedasticity robust. *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05.\n\n\n\n\n\n\nm4_2019 &lt;- svyglm(did_wfh~NCHLT5+factor(SEX) +factor(MARST)+factor(CINETHH) + occ_2dig_labels+county_pop_type, design = dstrata2019 )# %&gt;% summary()\n\nm4_2021 &lt;- svyglm(did_wfh~NCHLT5+factor(SEX) +factor(MARST)+factor(CINETHH) + occ_2dig_labels+county_pop_type, design = dstrata2021)# %&gt;% summary()\n\nexport_summs(m4_2019, m4_2021,\n             model.names = c(\"M4 2019\", \"M4 2021\"),\n            robust = \"HC3\", statistics = c(N = \"nobs\", R2 = \"r.squared\", adjR2 = \"adj.r.squared\"))\n\n\n\n\n\nM4 2019\nM4 2021\n\n\n(Intercept)\n0.07 ***\n0.22 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nNCHLT5\n0.00    \n0.02 ** \n\n\n\n(0.00)   \n(0.01)   \n\n\nfactor(SEX)2\n-0.01 *  \n-0.00    \n\n\n\n(0.00)   \n(0.00)   \n\n\nfactor(MARST)2\n-0.01    \n-0.01    \n\n\n\n(0.01)   \n(0.02)   \n\n\nfactor(MARST)3\n-0.01    \n-0.05 ** \n\n\n\n(0.01)   \n(0.02)   \n\n\nfactor(MARST)4\n-0.00    \n-0.02 *  \n\n\n\n(0.00)   \n(0.01)   \n\n\nfactor(MARST)5\n0.01    \n-0.05 ** \n\n\n\n(0.01)   \n(0.02)   \n\n\nfactor(MARST)6\n-0.02 ***\n-0.02 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nfactor(CINETHH)2\n-0.01    \n-0.01    \n\n\n\n(0.01)   \n(0.02)   \n\n\nfactor(CINETHH)3\n-0.01 *  \n-0.05 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsMilitary\n-0.08 ***\n-0.23 ***\n\n\n\n(0.00)   \n(0.03)   \n\n\nocc_2dig_labelsNatural Resources, Construction\n-0.04 ***\n-0.23 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsProduction, Transportation\n-0.05 ***\n-0.23 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsSales & Office Jobs\n-0.01    \n-0.09 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsService Occupations\n-0.03 ***\n-0.21 ***\n\n\n\n(0.00)   \n(0.01)   \n\n\ncounty_pop_typeUrban Counties\n0.01 *  \n0.10 ***\n\n\n\n(0.00)   \n(0.00)   \n\n\nN\n59242       \n57385       \n\n\nR2\n0.01    \n0.08    \n\n\nStandard errors are heteroskedasticity robust. *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05.\n\n\n\n\n\n\nexport_summs(m3_2019, m3_2021, m4_2019, m4_2021, \n            robust = \"HC3\", statistics = c(N = \"nobs\", R2 = \"r.squared\"))\n\n\n\n\n\nModel 1\nModel 2\nModel 3\nModel 4\n\n\n(Intercept)\n0.06 ***\n0.29 ***\n0.07 ***\n0.22 ***\n\n\n\n(0.01)   \n(0.02)   \n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsMilitary\n-0.03 ***\n-0.02    \n-0.08 ***\n-0.23 ***\n\n\n\n(0.01)   \n(0.04)   \n(0.00)   \n(0.03)   \n\n\nocc_2dig_labelsNatural Resources, Construction\n-0.09 ***\n-0.00    \n-0.04 ***\n-0.23 ***\n\n\n\n(0.00)   \n(0.23)   \n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsProduction, Transportation\n-0.08 ***\n-0.25 ***\n-0.05 ***\n-0.23 ***\n\n\n\n(0.00)   \n(0.04)   \n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsSales & Office Jobs\n-0.01    \n-0.08 ***\n-0.01    \n-0.09 ***\n\n\n\n(0.01)   \n(0.01)   \n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsService Occupations\n-0.01    \n-0.21 ***\n-0.03 ***\n-0.21 ***\n\n\n\n(0.01)   \n(0.02)   \n(0.00)   \n(0.01)   \n\n\nCanWorkFromHomeNo WFH\n-0.04 ***\n-0.22 ***\n       \n       \n\n\n\n(0.00)   \n(0.01)   \n       \n       \n\n\nCanWorkFromHomeSome WFH\n-0.00    \n-0.01    \n       \n       \n\n\n\n(0.01)   \n(0.01)   \n       \n       \n\n\nrace_catBlack\n-0.01    \n-0.05 ***\n       \n       \n\n\n\n(0.01)   \n(0.01)   \n       \n       \n\n\nrace_catOther\n-0.01    \n-0.06 ***\n       \n       \n\n\n\n(0.01)   \n(0.01)   \n       \n       \n\n\nrace_catWhite\n0.01 *  \n-0.03 ** \n       \n       \n\n\n\n(0.01)   \n(0.01)   \n       \n       \n\n\nSEX\n-0.00    \n0.00    \n       \n       \n\n\n\n(0.00)   \n(0.00)   \n       \n       \n\n\nage_cat25to34\n0.02 ***\n0.06 ***\n       \n       \n\n\n\n(0.00)   \n(0.01)   \n       \n       \n\n\nage_cat35to44\n0.03 ***\n0.07 ***\n       \n       \n\n\n\n(0.00)   \n(0.01)   \n       \n       \n\n\nage_cat45to54\n0.04 ***\n0.05 ***\n       \n       \n\n\n\n(0.00)   \n(0.01)   \n       \n       \n\n\nage_cat55to64\n0.04 ***\n0.04 ***\n       \n       \n\n\n\n(0.00)   \n(0.01)   \n       \n       \n\n\nage_cat65+\n0.06 ***\n0.05 ***\n       \n       \n\n\n\n(0.01)   \n(0.01)   \n       \n       \n\n\nCIHISPEED\n-0.00 ***\n-0.00 ***\n       \n       \n\n\n\n(0.00)   \n(0.00)   \n       \n       \n\n\ncounty_pop_typeUrban Counties\n0.01 *  \n0.09 ***\n0.01 *  \n0.10 ***\n\n\n\n(0.00)   \n(0.01)   \n(0.00)   \n(0.00)   \n\n\nNCHILD\n0.00    \n-0.01 ***\n       \n       \n\n\n\n(0.00)   \n(0.00)   \n       \n       \n\n\nNCHLT5\n0.02 ** \n0.05 ***\n0.00    \n0.02 ** \n\n\n\n(0.01)   \n(0.01)   \n(0.00)   \n(0.01)   \n\n\nocc_2dig_labelsNatural Resources, Construction:CanWorkFromHomeNo WFH\n0.07 ***\n-0.04    \n       \n       \n\n\n\n(0.01)   \n(0.23)   \n       \n       \n\n\nocc_2dig_labelsProduction, Transportation:CanWorkFromHomeNo WFH\n0.06 ***\n0.21 ***\n       \n       \n\n\n\n(0.01)   \n(0.04)   \n       \n       \n\n\nocc_2dig_labelsSales & Office Jobs:CanWorkFromHomeNo WFH\n0.01    \n0.10 ***\n       \n       \n\n\n\n(0.01)   \n(0.01)   \n       \n       \n\n\nocc_2dig_labelsService Occupations:CanWorkFromHomeNo WFH\n0.01    \n0.18 ***\n       \n       \n\n\n\n(0.01)   \n(0.02)   \n       \n       \n\n\nocc_2dig_labelsNatural Resources, Construction:CanWorkFromHomeSome WFH\n0.40    \n-0.30    \n       \n       \n\n\n\n(0.30)   \n(0.23)   \n       \n       \n\n\nocc_2dig_labelsProduction, Transportation:CanWorkFromHomeSome WFH\n0.07    \n0.31    \n       \n       \n\n\n\n(0.05)   \n(0.16)   \n       \n       \n\n\nocc_2dig_labelsSales & Office Jobs:CanWorkFromHomeSome WFH\n0.04 ** \n0.03    \n       \n       \n\n\n\n(0.01)   \n(0.02)   \n       \n       \n\n\nocc_2dig_labelsService Occupations:CanWorkFromHomeSome WFH\n-0.01    \n0.15 ** \n       \n       \n\n\n\n(0.03)   \n(0.06)   \n       \n       \n\n\nNCHILD:NCHLT5\n-0.01 ** \n-0.01 ** \n       \n       \n\n\n\n(0.00)   \n(0.00)   \n       \n       \n\n\nfactor(SEX)2\n       \n       \n-0.01 *  \n-0.00    \n\n\n\n       \n       \n(0.00)   \n(0.00)   \n\n\nfactor(MARST)2\n       \n       \n-0.01    \n-0.01    \n\n\n\n       \n       \n(0.01)   \n(0.02)   \n\n\nfactor(MARST)3\n       \n       \n-0.01    \n-0.05 ** \n\n\n\n       \n       \n(0.01)   \n(0.02)   \n\n\nfactor(MARST)4\n       \n       \n-0.00    \n-0.02 *  \n\n\n\n       \n       \n(0.00)   \n(0.01)   \n\n\nfactor(MARST)5\n       \n       \n0.01    \n-0.05 ** \n\n\n\n       \n       \n(0.01)   \n(0.02)   \n\n\nfactor(MARST)6\n       \n       \n-0.02 ***\n-0.02 ***\n\n\n\n       \n       \n(0.00)   \n(0.00)   \n\n\nfactor(CINETHH)2\n       \n       \n-0.01    \n-0.01    \n\n\n\n       \n       \n(0.01)   \n(0.02)   \n\n\nfactor(CINETHH)3\n       \n       \n-0.01 *  \n-0.05 ***\n\n\n\n       \n       \n(0.00)   \n(0.01)   \n\n\nN\n55150       \n53982       \n59242       \n57385       \n\n\nR2\n0.02    \n0.12    \n0.01    \n0.08    \n\n\nStandard errors are heteroskedasticity robust. *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05.\n\n\n\n\n\n\n\nLog-odds are not the most intuitive to interpret. Instead of discussing the change in the log-odds, we can calculate the odds ratio for a given variable by exponentiating the coefficient.\nOdds ratio is read “have x times the odds of the outcome of interest compared to thos in the reference group”.\n\nOR.CI_2019 &lt;- cbind(\"AOR\" = exp(   coef(m4_2019)),\n                       exp(confint(m4_2019,\n                           df.resid=degf(m4_2019$survey.design))))[-1,]\nround(OR.CI_2019, 3)\n\n                                                 AOR 2.5 % 97.5 %\nNCHLT5                                         1.000 0.994  1.006\nfactor(SEX)2                                   0.994 0.989  0.999\nfactor(MARST)2                                 0.991 0.973  1.009\nfactor(MARST)3                                 0.985 0.970  1.002\nfactor(MARST)4                                 0.998 0.989  1.007\nfactor(MARST)5                                 1.014 0.990  1.038\nfactor(MARST)6                                 0.976 0.970  0.981\nfactor(CINETHH)2                               0.986 0.972  1.001\nfactor(CINETHH)3                               0.990 0.981  1.000\nocc_2dig_labelsMilitary                        0.928 0.922  0.933\nocc_2dig_labelsNatural Resources, Construction 0.961 0.952  0.970\nocc_2dig_labelsProduction, Transportation      0.950 0.944  0.956\nocc_2dig_labelsSales & Office Jobs             0.992 0.984  1.000\nocc_2dig_labelsService Occupations             0.975 0.968  0.981\ncounty_pop_typeUrban Counties                  1.007 1.001  1.014\n\nOR.CI_2021 &lt;- cbind(\"AOR\" = exp(   coef(m4_2021)),\n                       exp(confint(m4_2021,\n                           df.resid=degf(m4_2021$survey.design))))[-1,]\nround(OR.CI_2021, 3)\n\n                                                 AOR 2.5 % 97.5 %\nNCHLT5                                         1.018 1.007  1.030\nfactor(SEX)2                                   0.998 0.990  1.007\nfactor(MARST)2                                 0.985 0.953  1.019\nfactor(MARST)3                                 0.955 0.926  0.985\nfactor(MARST)4                                 0.981 0.967  0.996\nfactor(MARST)5                                 0.952 0.924  0.982\nfactor(MARST)6                                 0.982 0.972  0.991\nfactor(CINETHH)2                               0.989 0.960  1.019\nfactor(CINETHH)3                               0.955 0.936  0.975\nocc_2dig_labelsMilitary                        0.797 0.747  0.850\nocc_2dig_labelsNatural Resources, Construction 0.796 0.785  0.806\nocc_2dig_labelsProduction, Transportation      0.791 0.783  0.800\nocc_2dig_labelsSales & Office Jobs             0.917 0.906  0.929\nocc_2dig_labelsService Occupations             0.807 0.798  0.816\ncounty_pop_typeUrban Counties                  1.103 1.093  1.113\n\nlibrary(gtsummary)\nlibrary(car)\nt1 &lt;- m4_2019 %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 # estimate_fun = function(x) style_sigfig(x, digits = 2),\n                 # label  = list('(Intercept)'  ~ \"Intercept\",\n                 #               alc_agefirst   ~ \"Age of first alcohol use (years)\",\n                 #               age_new ~ \"Age (years)\",\n                 #               demog_sex      ~ \"Sex\",\n                 #               demog_income   ~ \"Income\")\n                 ) %&gt;%\n  modify_column_hide(p.value) %&gt;%\n  modify_caption(\"Caption\")\n\nt2 &lt;- m4_2019 %&gt;%\n  tbl_regression(intercept = F,     # No intercept in OR table\n                 exponentiate = T,  # OR = exp(B)\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3),\n                 # label  = list(alc_agefirst   ~ \"Age of first alcohol use (years)\",\n                 #               age_new ~ \"Age (years)\",\n                 #               demog_sex      ~ \"Sex\",\n                 #               demog_income   ~ \"Income\"\n                 #              \n                 #              )\n                 ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\"\n  # Uncomment to use design df for Type III test p-values\n  # (but then they will not match the regression term p-values for\n  #  binary predictors)\n  #             , error.df = degf(fit.ex8.1$survey.design)\n                                 )\n\ntbl_merge(\n  tbls = list(t1, t2),\n  tab_spanner = c(\"**Regression Coefficients**\", \"**Adjusted Odds Ratio**\")\n)\n\n\n\n\n\n  Caption\n  \n    \n    \n      Characteristic\n      \n        Regression Coefficients\n      \n      \n        Adjusted Odds Ratio\n      \n    \n    \n      Beta\n      95% CI1\n      exp(Beta)\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n0.07\n0.07, 0.08\n\n\n\n    Number of own children under age 5 in household\n0.00\n-0.01, 0.01\n1.00\n0.99, 1.01\n0.993\n    factor(SEX)\n\n\n\n\n0.021\n        1\n—\n—\n—\n—\n\n        2\n-0.01\n-0.01, 0.00\n0.99\n0.99, 1.00\n0.021\n    factor(MARST)\n\n\n\n\n&lt;0.001\n        1\n—\n—\n—\n—\n\n        2\n-0.01\n-0.03, 0.01\n0.99\n0.97, 1.01\n0.331\n        3\n-0.01\n-0.03, 0.00\n0.99\n0.97, 1.00\n0.076\n        4\n0.00\n-0.01, 0.01\n1.00\n0.99, 1.01\n0.718\n        5\n0.01\n-0.01, 0.04\n1.01\n0.99, 1.04\n0.262\n        6\n-0.02\n-0.03, -0.02\n0.98\n0.97, 0.98\n&lt;0.001\n    factor(CINETHH)\n\n\n\n\n0.027\n        1\n—\n—\n—\n—\n\n        2\n-0.01\n-0.03, 0.00\n0.99\n0.97, 1.00\n0.064\n        3\n-0.01\n-0.02, 0.00\n0.99\n0.98, 1.00\n0.042\n    occ_2dig_labels\n\n\n\n\n&lt;0.001\n        Management, Business, Science, Arts\n—\n—\n—\n—\n\n        Military\n-0.08\n-0.08, -0.07\n0.93\n0.92, 0.93\n&lt;0.001\n        Natural Resources, Construction\n-0.04\n-0.05, -0.03\n0.96\n0.95, 0.97\n&lt;0.001\n        Production, Transportation\n-0.05\n-0.06, -0.05\n0.95\n0.94, 0.96\n&lt;0.001\n        Sales & Office Jobs\n-0.01\n-0.02, 0.00\n0.99\n0.98, 1.00\n0.054\n        Service Occupations\n-0.03\n-0.03, -0.02\n0.97\n0.97, 0.98\n&lt;0.001\n    county_pop_type\n\n\n\n\n0.020\n        Rural Counties\n—\n—\n—\n—\n\n        Urban Counties\n0.01\n0.00, 0.01\n1.01\n1.00, 1.01\n0.020\n  \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\nt3 &lt;- m4_2021 %&gt;%\n  tbl_regression(intercept = T,\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 # estimate_fun = function(x) style_sigfig(x, digits = 2),\n                 # label  = list('(Intercept)'  ~ \"Intercept\",\n                 #               alc_agefirst   ~ \"Age of first alcohol use (years)\",\n                 #               age_new ~ \"Age (years)\",\n                 #               demog_sex      ~ \"Sex\",\n                 #               demog_income   ~ \"Income\")\n                 ) %&gt;%\n  modify_column_hide(p.value) %&gt;%\n  modify_caption(\"Caption\")\n\nt4 &lt;- m4_2021 %&gt;%\n  tbl_regression(intercept = F,     # No intercept in OR table\n                 exponentiate = T,  # OR = exp(B)\n                 # Use style_number to round to 2 digits (e.g., 1.27)\n                 estimate_fun = function(x) style_number(x, digits = 2),\n                 # Use style_sigfig to keep 2 significant digits (e.g., 1.3)\n                 pvalue_fun   = function(x) style_pvalue(x, digits = 3),\n                 # label  = list(alc_agefirst   ~ \"Age of first alcohol use (years)\",\n                 #               age_new ~ \"Age (years)\",\n                 #               demog_sex      ~ \"Sex\",\n                 #               demog_income   ~ \"Income\"\n                 #              \n                 #              )\n                 ) %&gt;%\n  add_global_p(keep = T, test.statistic = \"F\"\n  # Uncomment to use design df for Type III test p-values\n  # (but then they will not match the regression term p-values for\n  #  binary predictors)\n  #             , error.df = degf(fit.ex8.1$survey.design)\n                                 )\n\ntbl_merge(\n  tbls = list(t3, t4),\n  tab_spanner = c(\"**Regression Coefficients**\", \"**Adjusted Odds Ratio**\")\n)\n\n\n\n\n\n  Caption\n  \n    \n    \n      Characteristic\n      \n        Regression Coefficients\n      \n      \n        Adjusted Odds Ratio\n      \n    \n    \n      Beta\n      95% CI1\n      exp(Beta)\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n0.22\n0.21, 0.23\n\n\n\n    Number of own children under age 5 in household\n0.02\n0.01, 0.03\n1.02\n1.01, 1.03\n0.002\n    factor(SEX)\n\n\n\n\n0.656\n        1\n—\n—\n—\n—\n\n        2\n0.00\n-0.01, 0.01\n1.00\n0.99, 1.01\n0.656\n    factor(MARST)\n\n\n\n\n&lt;0.001\n        1\n—\n—\n—\n—\n\n        2\n-0.01\n-0.05, 0.02\n0.99\n0.95, 1.02\n0.386\n        3\n-0.05\n-0.08, -0.02\n0.95\n0.93, 0.98\n0.003\n        4\n-0.02\n-0.03, 0.00\n0.98\n0.97, 1.00\n0.011\n        5\n-0.05\n-0.08, -0.02\n0.95\n0.92, 0.98\n0.002\n        6\n-0.02\n-0.03, -0.01\n0.98\n0.97, 0.99\n&lt;0.001\n    factor(CINETHH)\n\n\n\n\n&lt;0.001\n        1\n—\n—\n—\n—\n\n        2\n-0.01\n-0.04, 0.02\n0.99\n0.96, 1.02\n0.467\n        3\n-0.05\n-0.07, -0.03\n0.96\n0.94, 0.97\n&lt;0.001\n    occ_2dig_labels\n\n\n\n\n&lt;0.001\n        Management, Business, Science, Arts\n—\n—\n—\n—\n\n        Military\n-0.23\n-0.29, -0.16\n0.80\n0.75, 0.85\n&lt;0.001\n        Natural Resources, Construction\n-0.23\n-0.24, -0.22\n0.80\n0.79, 0.81\n&lt;0.001\n        Production, Transportation\n-0.23\n-0.24, -0.22\n0.79\n0.78, 0.80\n&lt;0.001\n        Sales & Office Jobs\n-0.09\n-0.10, -0.07\n0.92\n0.91, 0.93\n&lt;0.001\n        Service Occupations\n-0.21\n-0.23, -0.20\n0.81\n0.80, 0.82\n&lt;0.001\n    county_pop_type\n\n\n\n\n&lt;0.001\n        Rural Counties\n—\n—\n—\n—\n\n        Urban Counties\n0.10\n0.09, 0.11\n1.10\n1.09, 1.11\n&lt;0.001\n  \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\n\n\nRecode marital status and add back into regression"
  },
  {
    "objectID": "WFH_geographicComparison.html",
    "href": "WFH_geographicComparison.html",
    "title": "Work From Home: Who Can and Who Does?",
    "section": "",
    "text": "I combine the 2019 and 2021 datasets when creating new variables and then separate them by year again before creating the survey design object for each sample year.\n\n\nIPUMS link for Survey package\nSurvey questions for EMPSTAT & LABFORCE:\n\nLast week, did this person work for pay at a job or business? (Yes or no) – Yes becomes coded as EMPSTAT = 1-Employed.\nLast week, did this person do ANY work for pay, even as little as one hour?(Yes or no) – Yes becomes coded as LABFORCE = 2-Yes in the labor force.\n\nSurvey questions for INCEARN:\n\nINCEARN = INCWAGE + INCBUS00\n\nTotal amount earned in last 12 months: Wages, salary, commissions, bonuses, tips. [Yes –&gt; ______ ] is coded as INCWAGE value.\nINCEARN includes self-employment income, INCWAGE does not.\n\nINCWAGE does not include Farming income and self-employment income, but INCEARN does.\n\n\n\nusa_00011.xml and usa_00011.dat.gz are the same as Box files named IL_2021_1yr_ACS.dat.gz and IL_2021_1yr_ACS_datDDI.xml\n\noriginal xml file references the file name that it is called in the download. Either change the XML file to reference the correct .dat.gz files OR just keep track of which extracts are the same as the box file names.\n\n\n# old version with less variables:\n#ddi &lt;- read_ipums_ddi(\"usa_00009.xml\") # 45 variables\n#data &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\n\n# larger version with 147 variables. uses same file as Box file named \"IL_2021_1yr_ACS.dat.gz and IL_2021_1yr_ACS_datDDI.xml\nddi &lt;- read_ipums_ddi(\"usa_00011.xml\") # downloaded April 10 2023\n\ndata2021 &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\n\ndata2021 &lt;- data2021 %&gt;% select(YEAR, INCEARN, INCWAGE, INCTOT, TRANWORK, OCCSOC, CLASSWKR, EMPSTAT, LABFORCE, PERWT, COUNTYFIP, PUMA, PWSTATE2, AGE, STRATA, CLUSTER, RACE, HISPAN, SEX, CIHISPEED, CINETHH, MULTGEN, NCHILD, NCHLT5, MARST, FERTYR, EDUC, DEGFIELD, OCC, IND, OCC2010, METRO, CITY, HHINCOME, SERIAL,HHWT, NUMPREC, SUBSAMP,HHTYPE )\n\n# same sample but with 150+ variables. \n# NEED TO CHANGE XML file that references the data file. currently says usa_00011.dat.gz so these two lines of code do not work. \n\nddi &lt;- read_ipums_ddi(\"C:/Users/aleaw/Box/Fiscal Futures/FY22_Working/WFH/Data/IL_2019_1yearACS_datDDI.xml\") # downloaded April 10 2023\ndata2019 &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\ndata2019 &lt;- data2019 %&gt;% select(YEAR, INCEARN, INCWAGE, INCTOT, TRANWORK, OCCSOC, CLASSWKR, EMPSTAT, LABFORCE, PERWT, COUNTYFIP, PUMA, PWSTATE2, AGE, STRATA, CLUSTER, RACE, HISPAN, SEX, CIHISPEED, CINETHH, MULTGEN, NCHILD, NCHLT5, MARST, FERTYR, EDUC, DEGFIELD, OCC, IND, OCC2010, METRO, CITY, HHINCOME, SERIAL,HHWT, NUMPREC, SUBSAMP,HHTYPE   )\n\ndata &lt;- rbind(data2019, data2021) #125,007 observations before any filtering. \n\n\n# replaces 0 with NA for variables listed. Allows topline to calculate \"Valid Percent\" when it recognizes missing values\n\ndata &lt;- data %&gt;% replace_with_na(replace = list(\n  EMPSTAT= c(0), \n  LABFORCE=c(0), \n  CLASSWKR = c(0),\n  OCCSOC = c(0),\n  CIHISPEED = c(0),\n  CINETHH = c(0),\n  TRANWORK = c(\"N/A\",\"0\"))) %&gt;% \n  filter(LABFORCE == 2 & INCEARN &gt; 0) # in labor force and 18 years old and up abd positive earned incomes. \n\n\ndata &lt;- data %&gt;% mutate(age_cat = \n                              case_when(AGE &lt; 24 ~ \"16to24\",\n                                        AGE &gt; 24 & AGE &lt; 35 ~ \"25to34\",\n                                        AGE &gt; 34 & AGE &lt; 45 ~ \"35to44\",\n                                        AGE &gt; 44 & AGE &lt; 55 ~ \"45to54\",\n                                        AGE &gt; 54 & AGE &lt; 65 ~ \"55to64\",\n                                        AGE &gt; 64 ~ \"65+\"))\n\ndata &lt;-  data %&gt;% mutate(white = if_else(RACE ==1, 1, 0),\n         black = if_else(RACE ==2, 1, 0), \n         asian = if_else(RACE %in% c(4,5,6), 1, 0),\n         otherrace = if_else(RACE %in% c(3,7,8,9),1,0)) %&gt;%\n  group_by(COUNTYFIP,PUMA) %&gt;%\n  mutate(pct_white = sum(white)/n(),\n         pct_black = sum(black)/n()) %&gt;% \n  ungroup() %&gt;%\n  mutate(race_cat = case_when(\n    RACE ==1~\"White\",\n    RACE ==2 ~ \"Black\", \n    RACE %in% c(4,5,6)~\"Asian\",\n    RACE %in% c(3,7,8,9)~\"Other\"))\n\n\n## numbers used for income breaks are calculated in Income Deciles section. \n# created now so that the variable exists in the joined dataset before creating the survey design object\n\ndata &lt;- data %&gt;% \n  mutate(incdecile_w = case_when(\n    INCEARN &lt; 8000 ~ 1, \n    INCEARN &gt;= 8000 & INCEARN &lt; 18000 ~ 2,\n    INCEARN &gt;= 18000 & INCEARN &lt; 26000 ~ 3,\n    INCEARN &gt;= 26000 & INCEARN &lt; 35000 ~ 4,\n    INCEARN &gt;= 35000 & INCEARN &lt; 43000 ~ 5,\n    INCEARN &gt;= 43000 & INCEARN &lt; 54000 ~ 6,\n    INCEARN &gt;= 54000 & INCEARN &lt; 68000 ~ 7,\n    INCEARN &gt;= 68000 & INCEARN &lt; 85000 ~ 8,\n    INCEARN &gt;= 85000 & INCEARN &lt; 120000 ~ 9,\n    INCEARN &gt;= 120000 ~ 10)\n  ) %&gt;%\n  ## Padding FIPS code for merging with spatial geometry later\n  mutate(county_pop_type = if_else(COUNTYFIP==0, \n                                   \"Rural Counties\", \"Urban Counties\")) %&gt;%\n  mutate(PUMA = str_pad(PUMA, 5, pad=\"0\"),\n         countyFIP = str_pad(COUNTYFIP, 3, pad = \"0\"))\n\n\ndata &lt;- data %&gt;%\n  mutate(occ_2digits = substr(OCCSOC,1,2)) %&gt;% \n  mutate(occ_2dig_labels = case_when(\n    occ_2digits %in% c(11,13,19,15,17,19,21,23,25,27,29) ~ \"Management, Business, Science, Arts\",\n    occ_2digits %in% c(31,32,33,34,35,36,37,38,39) ~ \"Service Occupations\",\n    occ_2digits %in% c(41,42,43) ~ \"Sales & Office Jobs\",\n    occ_2digits %in% c(45,46,47,48,49 ) ~\"Natural Resources, Construction\",\n    occ_2digits %in% c(51, 52, 53) ~ \"Production, Transportation\",\n    occ_2digits == 55 ~ \"Military\")) \n\ndata &lt;- data %&gt;%\n  mutate(occ_2digits = substr(OCCSOC,1,2)) %&gt;% \n  mutate(occ_2dig_labels_d = case_when(\n    occ_2digits %in% c(11) ~ \"Management\",\n    occ_2digits %in% c(13) ~ \"Business & Finance\",\n    occ_2digits %in% c(15) ~ \"Computer, Engineering & Science\",\n    occ_2digits %in% c(17) ~ \"Architecture & Engineering\",\n    occ_2digits %in% c(19) ~ \"Life/Social Sciences\",\n    occ_2digits == 21 ~ \"Community & Social Services\",\n    occ_2digits == 23 ~ \"Legal\",\n    occ_2digits == 25 ~ \"Educational Instruction\",\n    occ_2digits == 27 ~ \"Arts, Design, Entertainainment\",\n    occ_2digits == 29 ~ \"Health Practictioners\",\n    occ_2digits == 31 ~ \"Healthcare Support\",\n    occ_2digits == 33 ~ \"Protective services\",\n    occ_2digits == 35 ~ \"Food Services\",\n    occ_2digits == 37 ~ \"Building Cleaning & Maintenance\",\n    occ_2digits == 41 ~ \"Sales\",\n    occ_2digits == 43 ~\"Office & Administration\",\n    occ_2digits == 45 ~ \"Farm, Fish, Forest\",\n    occ_2digits == 47 ~ \"Construction & Extractraction\",\n    occ_2digits == 49 ~\"Installation, Maintenance\",\n    occ_2digits == 51 ~\"Production\",\n    occ_2digits == 53 ~ \"Transportation & Material Moving\",\n    occ_2digits == 55 ~ \"Military\",\n    TRUE~\"Other\") )\n\ndata &lt;- data %&gt;% \n  mutate(did_wfh = if_else(TRANWORK==80, 1, 0)) # 1 = wfh, 0 = did not wfh\n\ndata &lt;- data %&gt;% \n  mutate(\n    PWSTATE2 = ifelse(PWSTATE2 == 0, NA, PWSTATE2),\n    work_in_IL = ifelse(PWSTATE2 == \"17\", \"In Illinois\", \"Out of IL\"),\n    did_wfh_labels = ifelse(did_wfh == 1, \"Did WFH\", \"Did not WFH\"),\n    has_incearn = ifelse(INCEARN &gt; 0, 1, 0), ## has earned income = 1\n    has_occsoc = ifelse(OCCSOC &gt; 0, 1, 0),# has occupation = 1\n    has_incearn_labels = ifelse(INCEARN &gt; 0, \"Has EarnInc\", \"No IncData\"), ## has earned income = 1\n    has_occsoc_labels = ifelse(OCCSOC &gt; 0, \"Has Occ\", \"No Occ\") ## OCCSOC code greater than zero coded as 1\n    )\n\nrm(ddi)\nrm(data2019)\nrm(data2021)"
  },
  {
    "objectID": "WFH_geographicComparison.html#acs-survey-data-notes",
    "href": "WFH_geographicComparison.html#acs-survey-data-notes",
    "title": "Work From Home: Who Can and Who Does?",
    "section": "",
    "text": "IPUMS link for Survey package\nSurvey questions for EMPSTAT & LABFORCE:\n\nLast week, did this person work for pay at a job or business? (Yes or no) – Yes becomes coded as EMPSTAT = 1-Employed.\nLast week, did this person do ANY work for pay, even as little as one hour?(Yes or no) – Yes becomes coded as LABFORCE = 2-Yes in the labor force.\n\nSurvey questions for INCEARN:\n\nINCEARN = INCWAGE + INCBUS00\n\nTotal amount earned in last 12 months: Wages, salary, commissions, bonuses, tips. [Yes –&gt; ______ ] is coded as INCWAGE value.\nINCEARN includes self-employment income, INCWAGE does not.\n\nINCWAGE does not include Farming income and self-employment income, but INCEARN does.\n\n\n\nusa_00011.xml and usa_00011.dat.gz are the same as Box files named IL_2021_1yr_ACS.dat.gz and IL_2021_1yr_ACS_datDDI.xml\n\noriginal xml file references the file name that it is called in the download. Either change the XML file to reference the correct .dat.gz files OR just keep track of which extracts are the same as the box file names.\n\n\n# old version with less variables:\n#ddi &lt;- read_ipums_ddi(\"usa_00009.xml\") # 45 variables\n#data &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\n\n# larger version with 147 variables. uses same file as Box file named \"IL_2021_1yr_ACS.dat.gz and IL_2021_1yr_ACS_datDDI.xml\nddi &lt;- read_ipums_ddi(\"usa_00011.xml\") # downloaded April 10 2023\n\ndata2021 &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\n\ndata2021 &lt;- data2021 %&gt;% select(YEAR, INCEARN, INCWAGE, INCTOT, TRANWORK, OCCSOC, CLASSWKR, EMPSTAT, LABFORCE, PERWT, COUNTYFIP, PUMA, PWSTATE2, AGE, STRATA, CLUSTER, RACE, HISPAN, SEX, CIHISPEED, CINETHH, MULTGEN, NCHILD, NCHLT5, MARST, FERTYR, EDUC, DEGFIELD, OCC, IND, OCC2010, METRO, CITY, HHINCOME, SERIAL,HHWT, NUMPREC, SUBSAMP,HHTYPE )\n\n# same sample but with 150+ variables. \n# NEED TO CHANGE XML file that references the data file. currently says usa_00011.dat.gz so these two lines of code do not work. \n\nddi &lt;- read_ipums_ddi(\"C:/Users/aleaw/Box/Fiscal Futures/FY22_Working/WFH/Data/IL_2019_1yearACS_datDDI.xml\") # downloaded April 10 2023\ndata2019 &lt;- read_ipums_micro(ddi) # 126623 observations before any filtering\ndata2019 &lt;- data2019 %&gt;% select(YEAR, INCEARN, INCWAGE, INCTOT, TRANWORK, OCCSOC, CLASSWKR, EMPSTAT, LABFORCE, PERWT, COUNTYFIP, PUMA, PWSTATE2, AGE, STRATA, CLUSTER, RACE, HISPAN, SEX, CIHISPEED, CINETHH, MULTGEN, NCHILD, NCHLT5, MARST, FERTYR, EDUC, DEGFIELD, OCC, IND, OCC2010, METRO, CITY, HHINCOME, SERIAL,HHWT, NUMPREC, SUBSAMP,HHTYPE   )\n\ndata &lt;- rbind(data2019, data2021) #125,007 observations before any filtering. \n\n\n# replaces 0 with NA for variables listed. Allows topline to calculate \"Valid Percent\" when it recognizes missing values\n\ndata &lt;- data %&gt;% replace_with_na(replace = list(\n  EMPSTAT= c(0), \n  LABFORCE=c(0), \n  CLASSWKR = c(0),\n  OCCSOC = c(0),\n  CIHISPEED = c(0),\n  CINETHH = c(0),\n  TRANWORK = c(\"N/A\",\"0\"))) %&gt;% \n  filter(LABFORCE == 2 & INCEARN &gt; 0) # in labor force and 18 years old and up abd positive earned incomes. \n\n\ndata &lt;- data %&gt;% mutate(age_cat = \n                              case_when(AGE &lt; 24 ~ \"16to24\",\n                                        AGE &gt; 24 & AGE &lt; 35 ~ \"25to34\",\n                                        AGE &gt; 34 & AGE &lt; 45 ~ \"35to44\",\n                                        AGE &gt; 44 & AGE &lt; 55 ~ \"45to54\",\n                                        AGE &gt; 54 & AGE &lt; 65 ~ \"55to64\",\n                                        AGE &gt; 64 ~ \"65+\"))\n\ndata &lt;-  data %&gt;% mutate(white = if_else(RACE ==1, 1, 0),\n         black = if_else(RACE ==2, 1, 0), \n         asian = if_else(RACE %in% c(4,5,6), 1, 0),\n         otherrace = if_else(RACE %in% c(3,7,8,9),1,0)) %&gt;%\n  group_by(COUNTYFIP,PUMA) %&gt;%\n  mutate(pct_white = sum(white)/n(),\n         pct_black = sum(black)/n()) %&gt;% \n  ungroup() %&gt;%\n  mutate(race_cat = case_when(\n    RACE ==1~\"White\",\n    RACE ==2 ~ \"Black\", \n    RACE %in% c(4,5,6)~\"Asian\",\n    RACE %in% c(3,7,8,9)~\"Other\"))\n\n\n## numbers used for income breaks are calculated in Income Deciles section. \n# created now so that the variable exists in the joined dataset before creating the survey design object\n\ndata &lt;- data %&gt;% \n  mutate(incdecile_w = case_when(\n    INCEARN &lt; 8000 ~ 1, \n    INCEARN &gt;= 8000 & INCEARN &lt; 18000 ~ 2,\n    INCEARN &gt;= 18000 & INCEARN &lt; 26000 ~ 3,\n    INCEARN &gt;= 26000 & INCEARN &lt; 35000 ~ 4,\n    INCEARN &gt;= 35000 & INCEARN &lt; 43000 ~ 5,\n    INCEARN &gt;= 43000 & INCEARN &lt; 54000 ~ 6,\n    INCEARN &gt;= 54000 & INCEARN &lt; 68000 ~ 7,\n    INCEARN &gt;= 68000 & INCEARN &lt; 85000 ~ 8,\n    INCEARN &gt;= 85000 & INCEARN &lt; 120000 ~ 9,\n    INCEARN &gt;= 120000 ~ 10)\n  ) %&gt;%\n  ## Padding FIPS code for merging with spatial geometry later\n  mutate(county_pop_type = if_else(COUNTYFIP==0, \n                                   \"Rural Counties\", \"Urban Counties\")) %&gt;%\n  mutate(PUMA = str_pad(PUMA, 5, pad=\"0\"),\n         countyFIP = str_pad(COUNTYFIP, 3, pad = \"0\"))\n\n\ndata &lt;- data %&gt;%\n  mutate(occ_2digits = substr(OCCSOC,1,2)) %&gt;% \n  mutate(occ_2dig_labels = case_when(\n    occ_2digits %in% c(11,13,19,15,17,19,21,23,25,27,29) ~ \"Management, Business, Science, Arts\",\n    occ_2digits %in% c(31,32,33,34,35,36,37,38,39) ~ \"Service Occupations\",\n    occ_2digits %in% c(41,42,43) ~ \"Sales & Office Jobs\",\n    occ_2digits %in% c(45,46,47,48,49 ) ~\"Natural Resources, Construction\",\n    occ_2digits %in% c(51, 52, 53) ~ \"Production, Transportation\",\n    occ_2digits == 55 ~ \"Military\")) \n\ndata &lt;- data %&gt;%\n  mutate(occ_2digits = substr(OCCSOC,1,2)) %&gt;% \n  mutate(occ_2dig_labels_d = case_when(\n    occ_2digits %in% c(11) ~ \"Management\",\n    occ_2digits %in% c(13) ~ \"Business & Finance\",\n    occ_2digits %in% c(15) ~ \"Computer, Engineering & Science\",\n    occ_2digits %in% c(17) ~ \"Architecture & Engineering\",\n    occ_2digits %in% c(19) ~ \"Life/Social Sciences\",\n    occ_2digits == 21 ~ \"Community & Social Services\",\n    occ_2digits == 23 ~ \"Legal\",\n    occ_2digits == 25 ~ \"Educational Instruction\",\n    occ_2digits == 27 ~ \"Arts, Design, Entertainainment\",\n    occ_2digits == 29 ~ \"Health Practictioners\",\n    occ_2digits == 31 ~ \"Healthcare Support\",\n    occ_2digits == 33 ~ \"Protective services\",\n    occ_2digits == 35 ~ \"Food Services\",\n    occ_2digits == 37 ~ \"Building Cleaning & Maintenance\",\n    occ_2digits == 41 ~ \"Sales\",\n    occ_2digits == 43 ~\"Office & Administration\",\n    occ_2digits == 45 ~ \"Farm, Fish, Forest\",\n    occ_2digits == 47 ~ \"Construction & Extractraction\",\n    occ_2digits == 49 ~\"Installation, Maintenance\",\n    occ_2digits == 51 ~\"Production\",\n    occ_2digits == 53 ~ \"Transportation & Material Moving\",\n    occ_2digits == 55 ~ \"Military\",\n    TRUE~\"Other\") )\n\ndata &lt;- data %&gt;% \n  mutate(did_wfh = if_else(TRANWORK==80, 1, 0)) # 1 = wfh, 0 = did not wfh\n\ndata &lt;- data %&gt;% \n  mutate(\n    PWSTATE2 = ifelse(PWSTATE2 == 0, NA, PWSTATE2),\n    work_in_IL = ifelse(PWSTATE2 == \"17\", \"In Illinois\", \"Out of IL\"),\n    did_wfh_labels = ifelse(did_wfh == 1, \"Did WFH\", \"Did not WFH\"),\n    has_incearn = ifelse(INCEARN &gt; 0, 1, 0), ## has earned income = 1\n    has_occsoc = ifelse(OCCSOC &gt; 0, 1, 0),# has occupation = 1\n    has_incearn_labels = ifelse(INCEARN &gt; 0, \"Has EarnInc\", \"No IncData\"), ## has earned income = 1\n    has_occsoc_labels = ifelse(OCCSOC &gt; 0, \"Has Occ\", \"No Occ\") ## OCCSOC code greater than zero coded as 1\n    )\n\nrm(ddi)\nrm(data2019)\nrm(data2021)"
  },
  {
    "objectID": "WFH_geographicComparison.html#comparison-of-women-w-wo-kids-under-5",
    "href": "WFH_geographicComparison.html#comparison-of-women-w-wo-kids-under-5",
    "title": "Work From Home: Who Can and Who Does?",
    "section": "Comparison of Women w/ & w/o Kids under 5",
    "text": "Comparison of Women w/ & w/o Kids under 5\nWomen under 40 who could work from home in the occupation category with large amount of people who could work from home (Management, Business, Science & Arts, all SOC 2-digit codes &lt; 30-0000)\nUnder5 is binary variable: 0 means no children under 5. 1 means at least 1 or more children under 5.\n318,174 women in 2019 worked from home and 1,140,835 women in 2021 worked from home.\n\nchildttest2021&lt;-joined %&gt;% \n  filter(YEAR == 2021)%&gt;%\n  filter(SEX == 2 & AGE &lt; 40) %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\" & occ_2digits &lt;30)  %&gt;%  \n  mutate(under5 = ifelse(NCHLT5 &gt; 0, 1, 0))\nwrite.csv(childttest2021, \"with_kids_comparison.csv\")\n\n\n\nchildttest2019&lt;-joined %&gt;% \n  filter(YEAR == 2019)%&gt;%\n  filter(SEX == 2 & AGE &lt; 40) %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\" & occ_2digits &lt;30)  %&gt;%  \n  mutate(under5 = ifelse(NCHLT5 &gt; 0, 1, 0))\n\nkidsdesign &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~PERWT, data = childttest2021)\n\nkidsdesign2 &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~PERWT, data = childttest2019)\n\n#withkids &lt;- childttest %&gt;% filter(under5 == 1)\n#table(withkids$did_wfh_labels)\n#nokids &lt;- childttest %&gt;% filter(under5==0)\n#table(nokids$did_wfh_labels)\n\n\nsvytable(~under5+did_wfh_labels, kidsdesign) \n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      174904   91658\n     1       49846   29442\n\nsvytable(~under5+did_wfh_labels, kidsdesign) %&gt;% as_tibble() %&gt;%\n #  group_by(did_wfh_labels) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3))\n\n\n\n\nunder5\ndid_wfh_labels\nn\nProp\n\n\n0\nDid not WFH\n1.75e+05\n0.506\n\n\n1\nDid not WFH\n4.98e+04\n0.144\n\n\n0\nDid WFH\n9.17e+04\n0.265\n\n\n1\nDid WFH\n2.94e+04\n0.085\n\n\n\n\n\n\nsvytable(~under5+did_wfh_labels, kidsdesign) %&gt;% summary()\n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      174904   91658\n     1       49846   29442\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, design = kidsdesign, statistic = \"F\")\nF = 1.0905, ndf = 1, ddf = 3182, p-value = 0.2964\n\n# also chi square test?\nsvychisq(~under5+did_wfh_labels, kidsdesign, statistic = \"Chisq\")\n\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, kidsdesign, statistic = \"Chisq\")\nX-squared = 1.9676, df = 1, p-value = 0.2964\n\n# t-test between with kids and without kids group. Weighted.\n# t-test probably isn't right because it isn't a continuous variable.\n# svyttest(under5~did_wfh, kidsdesign)\n\n\n#svytable(~did_wfh_labels+YEAR+under5, design = dstrata)\nsvytable(~under5+did_wfh_labels, design = kidsdesign) %&gt;% summary()\n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      174904   91658\n     1       49846   29442\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, design = kidsdesign, statistic = \"F\")\nF = 1.0905, ndf = 1, ddf = 3182, p-value = 0.2964\n\nsvytable(~under5+did_wfh_labels, design = kidsdesign2) %&gt;% summary()\n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      253418   12702\n     1       66901    6638\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, design = kidsdesign2, statistic = \"F\")\nF = 10.485, ndf = 1, ddf = 3088, p-value = 0.001216\n\n #svychisq(under5~did_wfh_labels, design = kidsdesign)\n#crosstab(did_wfh_labels, under5, weight = PERWT, unwt_n = TRUE, df = childttest2021)\n\n#crosstab(did_wfh_labels,under5, weight = PERWT, unwt_n = TRUE, df = childttest2019)\n\n\n### Switch variable order.\ncrosstab(under5, did_wfh_labels, weight = PERWT, unwt_n = TRUE, df = childttest2021)\n\n\n\n\nunder5\nDid not WFH\nDid WFH\nn\nunweighted_n\n\n\n0\n65.6\n34.4\n2.67e+05\n2438\n\n\n1\n62.9\n37.1\n7.93e+04\n775\n\n\n\n\n\n\ncrosstab(under5,did_wfh_labels, weight = PERWT, unwt_n = TRUE, df = childttest2019)\n\n\n\n\nunder5\nDid not WFH\nDid WFH\nn\nunweighted_n\n\n\n0\n95.2\n4.77\n2.66e+05\n2408\n\n\n1\n91  \n9.03\n7.35e+04\n760\n\n\n\n\n\n\n#crosstab_3way(YEAR, under5, did_wfh_labels, weight = PERWT, unwt_n = TRUE, df = childttest#, pct_type = \"cell\")\n\n#glm(did_wfh~under5, data = childttest2021) %&gt;% summary()\n#svyglm(did_wfh~under5, design = kidsdesign) %&gt;% summary()\n\nFor men in 2019, 7.1% of men without kids worked from home. 7.6% of men with kids worked from home.\n2019:\n21.8% of men who did not WFH had kid under 5.\n22.8% of men who did WFH had a kid under 5.\n7.2% of men who did not have kids under 5 worked from home.\n7.6% of men with kids under 5 worked from home.\nIn 2019:\n22% of women who did not WFH had a kid under 5.\n24% of women who did WFH had a kid under 5.\n5% of women without children under 5 worked from home.\n9% of women with children under 5 worked from home.\nIn 2021:|\n21% of women who did not WFH had a kid under 5.\n34% of women who did WFH had a kid under 5.\n34% of women without children under 5 worked from home.\n37% of women with children under 5 worked from home.\n2021:\n20.4% of men who did not work from home had kids under 5.\n20.45% of men who did work from home had kids under 5.\n40.45% of men without kids under 5 worked from home.\n40.55% of men with kids under 5 worked from home.\nNot a statistically significant difference but still interesting.\nFor women under 45:\n\nchildttest2021&lt;-joined %&gt;% \n  filter(YEAR == 2021)%&gt;%\n  filter(SEX == 2 & AGE &lt; 45) %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\" & occ_2digits &lt;30)  %&gt;%  \n  mutate(under5 = ifelse(NCHLT5 &gt; 0, 1, 0))\n\nchildttest2019&lt;-joined %&gt;% \n  filter(YEAR == 2019)%&gt;%\n  filter(SEX == 2 & AGE &lt; 45) %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\" & occ_2digits &lt;30)  %&gt;%  \n  mutate(under5 = ifelse(NCHLT5 &gt; 0, 1, 0))\n\nkidsdesign &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~PERWT, data = childttest2021)\n\n#withkids &lt;- childttest %&gt;% filter(under5 == 1)\n#table(withkids$did_wfh_labels)\n#nokids &lt;- childttest %&gt;% filter(under5==0)\n#table(nokids$did_wfh_labels)\n\n\nsvytable(~under5+did_wfh_labels, kidsdesign)\n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      228825  121522\n     1       57559   36530\n\nsvychisq(~under5+did_wfh_labels, kidsdesign)\n\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, kidsdesign)\nF = 2.9369, ndf = 1, ddf = 4158, p-value = 0.08665\n\nsvyttest(under5~did_wfh, kidsdesign)\n\n\n    Design-based t-test\n\ndata:  under5 ~ did_wfh\nt = 1.6909, df = 3987, p-value = 0.09094\nalternative hypothesis: true difference in mean is not equal to 0\n95 percent confidence interval:\n -0.004807002  0.065089151\nsample estimates:\ndifference in mean \n        0.03014107 \n\n#svytable(~did_wfh_labels+YEAR+under5, design = dstrata)\n#svytable(~under5+YEAR+did_wfh_labels, design = dstrata)\n\n\n#svychisq(did_wfh_labels~under5+YEAR, design = dstrata)\n#crosstab(did_wfh_labels, under5, weight = PERWT, unwt_n = TRUE, df = childttest2021)\n\n#crosstab(did_wfh_labels,under5, weight = PERWT, unwt_n = TRUE, df = childttest2019)\n#crosstab_3way(YEAR, under5, did_wfh_labels, weight = PERWT, unwt_n = TRUE, df = childttest#, pct_type = \"cell\")\n\n#glm(did_wfh~under5, data = childttest2021) %&gt;% summary()\n\nFor MEN under 40:\nIn 2019:\n20.8% who did not WFH had a kid under 5.\n21.5% who did WFH had a kid under 5.\nIn 2021: 22% of men that did and did not WFH had a kid under 5.\n\nchildttest2021&lt;-joined %&gt;% \n  filter(YEAR == 2021)%&gt;%\n  filter(SEX == 1 & AGE &lt; 40) %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\" & occ_2digits &lt;30)  %&gt;%  \n  mutate(under5 = ifelse(NCHLT5 &gt; 0, 1, 0))\nwrite.csv(childttest2021, \"with_kids_comparison.csv\")\n\n\n\nchildttest2019&lt;-joined %&gt;% \n  filter(YEAR == 2019)%&gt;%\n  filter(SEX == 1 & AGE &lt; 40) %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\" & occ_2digits &lt;30)  %&gt;%  \n  mutate(under5 = ifelse(NCHLT5 &gt; 0, 1, 0))\n\nkidsdesign &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~PERWT, data = childttest2021)\n\nkidsdesign2 &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~PERWT, data = childttest2019)\n\n#withkids &lt;- childttest %&gt;% filter(under5 == 1)\n#table(withkids$did_wfh_labels)\n#nokids &lt;- childttest %&gt;% filter(under5==0)\n#table(nokids$did_wfh_labels)\n\n\nsvytable(~under5+did_wfh_labels, kidsdesign) \n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      149045  101265\n     1       38192   26053\n\nsvytable(~under5+did_wfh_labels, kidsdesign) %&gt;% as_tibble() %&gt;%\n #  group_by(did_wfh_labels) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3))\n\n\n\n\nunder5\ndid_wfh_labels\nn\nProp\n\n\n0\nDid not WFH\n1.49e+05\n0.474\n\n\n1\nDid not WFH\n3.82e+04\n0.121\n\n\n0\nDid WFH\n1.01e+05\n0.322\n\n\n1\nDid WFH\n2.61e+04\n0.083\n\n\n\n\n\n\nsvytable(~under5+did_wfh_labels, kidsdesign) %&gt;% summary()\n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      149045  101265\n     1       38192   26053\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, design = kidsdesign, statistic = \"F\")\nF = 0.0012511, ndf = 1, ddf = 2729, p-value = 0.9718\n\n# also chi square test?\nsvychisq(~under5+did_wfh_labels, kidsdesign, statistic = \"Chisq\")\n\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, kidsdesign, statistic = \"Chisq\")\nX-squared = 0.001837, df = 1, p-value = 0.9718\n\n# t-test between with kids and without kids group. Weighted.\n# t-test probably isn't right because it isn't a continuous variable.\n# svyttest(under5~did_wfh, kidsdesign)\n\n\n#svytable(~did_wfh_labels+YEAR+under5, design = dstrata)\nsvytable(~under5+did_wfh_labels, design = kidsdesign) %&gt;% summary()\n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      149045  101265\n     1       38192   26053\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, design = kidsdesign, statistic = \"F\")\nF = 0.0012511, ndf = 1, ddf = 2729, p-value = 0.9718\n\nsvytable(~under5+did_wfh_labels, design = kidsdesign2) %&gt;% summary()\n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      235335   18234\n     1       65519    5373\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, design = kidsdesign2, statistic = \"F\")\nF = 0.06253, ndf = 1, ddf = 2767, p-value = 0.8026\n\n #svychisq(under5~did_wfh_labels, design = kidsdesign)\n#crosstab(did_wfh_labels, under5, weight = PERWT, unwt_n = TRUE, df = childttest2021)\n\n#crosstab(did_wfh_labels,under5, weight = PERWT, unwt_n = TRUE, df = childttest2019)\n\n\n### Switch variable order.\ncrosstab(under5, did_wfh_labels, weight = PERWT, unwt_n = TRUE, df = childttest2021)\n\n\n\n\nunder5\nDid not WFH\nDid WFH\nn\nunweighted_n\n\n\n0\n59.5\n40.5\n2.5e+05 \n2156\n\n\n1\n59.4\n40.6\n6.42e+04\n671\n\n\n\n\n\n\ncrosstab(under5,did_wfh_labels, weight = PERWT, unwt_n = TRUE, df = childttest2019)\n\n\n\n\nunder5\nDid not WFH\nDid WFH\nn\nunweighted_n\n\n\n0\n92.8\n7.19\n2.54e+05\n2194\n\n\n1\n92.4\n7.58\n7.09e+04\n700\n\n\n\n\n\n\n#crosstab_3way(YEAR, under5, did_wfh_labels, weight = PERWT, unwt_n = TRUE, df = childttest#, pct_type = \"cell\")\n\n#glm(did_wfh~under5, data = childttest2021) %&gt;% summary()\n#svyglm(did_wfh~under5, design = kidsdesign) %&gt;% summary()\n\nFor MEN under 45:\n\nchildttest2021&lt;-joined %&gt;% \n  filter(YEAR == 2021)%&gt;%\n  filter(SEX == 1 & AGE &lt; 45) %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\" & occ_2digits &lt;30)  %&gt;%  \n  mutate(under5 = ifelse(NCHLT5 &gt; 0, 1, 0))\n\nchildttest2019&lt;-joined %&gt;% \n  filter(YEAR == 2019)%&gt;%\n  filter(SEX == 1 & AGE &lt; 45) %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\" & occ_2digits &lt;30)  %&gt;%  \n  mutate(under5 = ifelse(NCHLT5 &gt; 0, 1, 0))\n\nkidsdesign &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~PERWT, data = childttest2021)\n\n#withkids &lt;- childttest %&gt;% filter(under5 == 1)\n#table(withkids$did_wfh_labels)\n#nokids &lt;- childttest %&gt;% filter(under5==0)\n#table(nokids$did_wfh_labels)\n\n\nsvytable(~under5+did_wfh_labels, kidsdesign)\n\n      did_wfh_labels\nunder5 Did not WFH Did WFH\n     0      193236  126685\n     1       50862   34791\n\nsvychisq(~under5+did_wfh_labels, kidsdesign)\n\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  svychisq(~under5 + did_wfh_labels, kidsdesign)\nF = 0.18489, ndf = 1, ddf = 3589, p-value = 0.6672\n\nsvyttest(under5~did_wfh, kidsdesign)\n\n\n    Design-based t-test\n\ndata:  under5 ~ did_wfh\nt = 0.42896, df = 3490, p-value = 0.668\nalternative hypothesis: true difference in mean is not equal to 0\n95 percent confidence interval:\n -0.02531256  0.03949063\nsample estimates:\ndifference in mean \n       0.007089036 \n\n#svytable(~did_wfh_labels+YEAR+under5, design = dstrata)\n#svytable(~under5+YEAR+did_wfh_labels, design = dstrata)\n\n\n#svychisq(did_wfh_labels~under5+YEAR, design = dstrata)\ncrosstab(did_wfh_labels, under5, weight = PERWT, unwt_n = TRUE, df = childttest2021)\n\n\n\n\ndid_wfh_labels\n0\n1\nn\nunweighted_n\n\n\nDid not WFH\n79.2\n20.8\n2.44e+05\n2241\n\n\nDid WFH\n78.5\n21.5\n1.61e+05\n1435\n\n\n\n\n\n\ncrosstab(did_wfh_labels,under5, weight = PERWT, unwt_n = TRUE, df = childttest2019)\n\n\n\n\ndid_wfh_labels\n0\n1\nn\nunweighted_n\n\n\nDid not WFH\n78  \n22  \n3.74e+05\n3424\n\n\nDid WFH\n78.1\n21.9\n3.34e+04\n275\n\n\n\n\n\n\n#crosstab_3way(YEAR, under5, did_wfh_labels, weight = PERWT, unwt_n = TRUE, df = childttest#, pct_type = \"cell\")\n\nglm(did_wfh~under5, data = childttest2021) %&gt;% summary()\n\n\nCall:\nglm(formula = did_wfh ~ under5, data = childttest2021)\n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.392423   0.009225  42.540   &lt;2e-16 ***\nunder5      -0.008596   0.018875  -0.455    0.649    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 0.2380974)\n\n    Null deviance: 874.82  on 3675  degrees of freedom\nResidual deviance: 874.77  on 3674  degrees of freedom\n  (103 observations deleted due to missingness)\nAIC: 5160.7\n\nNumber of Fisher Scoring iterations: 2"
  },
  {
    "objectID": "WFH_geographicComparison.html#household-data",
    "href": "WFH_geographicComparison.html#household-data",
    "title": "Work From Home: Who Can and Who Does?",
    "section": "Household data",
    "text": "Household data\nhhbreaks2019 = (32100, 50000, 65600, 80500, 97300, 115700, 137500, 168000, 225010) and max is 1671000\nhhbreaks2021 = (34000, 51900, 68000, 83600, 1e+05 120,000 142,400 175,000 235,000) and max is 1,797,000.\n\n\nCode\njoined &lt;- joined %&gt;% filter(HHINCOME &gt; 0 & HHINCOME!= 9999999 & HHINCOME != 9999998)  # 105 observations \n\njoined %&gt;%\n  ggplot() + geom_histogram(aes(x=HHINCOME, weight = HHWT))\n\n\n\n\n\nCode\njoined %&gt;% # 122000 observations \nggplot() + geom_histogram(aes(x=HHINCOME))\n\n\n\n\n\nCode\nHHdesign &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~HHWT, data = joined)\n\ninc_quantiles &lt;-survey::svyquantile(~HHINCOME, design=HHdesign, \n                    quantiles = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1) ,\n                    na.rm=TRUE, ci = FALSE  )\ninc_quantiles\n\n\n$HHINCOME\n     0   0.1   0.2   0.3   0.4   0.5    0.6    0.7    0.8    0.9       1\n[1,] 4 32900 50000 66600 82000 99000 117000 140000 171000 230000 1797000\n\nattr(,\"hasci\")\n[1] FALSE\nattr(,\"class\")\n[1] \"newsvyquantile\"\n\n\nCode\n# With  HH Weights:  4 32900 50000 66600 82000 99000 117000 140000 171000 230000 1797000\n# With WRONG weights:  (34000, 51900, 68000, 83600, 1e+05 120,000 142,400 175,000 235,000\n#Code done above when creating variables in beginning chunks.\njoined &lt;- joined %&gt;%\n  mutate(HHincdecile_w = case_when(\n    INCEARN &lt; 32900 ~ 1,\n    INCEARN &gt;= 32900 & INCEARN &lt; 50000 ~ 2,\n    INCEARN &gt;= 50000 & INCEARN &lt; 66600 ~ 3,\n    INCEARN &gt;= 66600 & INCEARN &lt; 82000 ~ 4,\n    INCEARN &gt;= 82000 & INCEARN &lt; 99000 ~ 5,\n    INCEARN &gt;= 99000 & INCEARN &lt; 117000 ~ 6,\n    INCEARN &gt;= 117000 & INCEARN &lt; 140000 ~ 7,\n    INCEARN &gt;= 140000 & INCEARN &lt; 171000 ~ 8,\n    INCEARN &gt;= 171000 & INCEARN &lt; 230000 ~ 9,\n    INCEARN &gt;= 230000 ~ 10)\n  )\n\nHHdesign &lt;- survey::svydesign(id = ~CLUSTER, strata = ~STRATA, weights = ~HHWT, data = joined)\ntable &lt;- svytable(~YEAR+HHincdecile_w+did_wfh_labels,  design = HHdesign) \n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR,HHincdecile_w)%&gt;%\n  mutate(Prop=round(n/sum(n), digits=3)) %&gt;%\n  filter(did_wfh_labels == \"Did WFH\")\n\ntable # has proportions calculated out of TOTAl for both years\n\n\n\n\n  \n\n\n\nCode\ntable %&gt;%\n  ggplot(aes(factor(HHincdecile_w, levels = c(1,2,3,4,5,6,7,8,9,10), labels = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\")), \n                     y=Prop, fill = YEAR, group = factor(YEAR, levels = \"2021\",\"2019\"))) + \n  geom_col(stat=\"identity\", position = \"dodge\")+\n  #geom_col(stat = \"identity\", position = \"stack\") +   # scale_x_discrete(limits = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\"))+\n\n # facet_wrap(~YEAR)+\n   coord_flip()+\n    geom_text(aes(label = scales::percent(Prop, accuracy = 0.1L)), position = position_dodge(width = 0.8), hjust = 1.1,\n              size = 4) + \n  labs(title =\"Percent of each HOUSEHOLD income decile that did WFH\",\n  subtitle = \"2019 vs 2021\",\n       caption = \"ACS 1 year samples for 2019 and 2021. Working from home based on TRANWORK question on commuting and HHINCOME variable.\n       All workers in the labor force, all ages included.\n       Income based on HHINCOME for household income of survey respondents.\", \n       x= \"Income Deciles\", \n       y = \"Percent of workers working from home\") + \n theme(legend.position = \"bottom\", legend.title = element_blank())+\n  theme_classic()+\n    scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\")) +\n  scale_y_continuous(labels = scales::percent)"
  },
  {
    "objectID": "WFH_geographicComparison.html#individual-level-data",
    "href": "WFH_geographicComparison.html#individual-level-data",
    "title": "Work From Home: Who Can and Who Does?",
    "section": "Individual Level Data",
    "text": "Individual Level Data\n\nOccupations\nCombined into 6 major occupation groups. Broadest categories are made up of multiple 2-digit OCCSOC codes.\n\n\nCode\n#table includes observations from BOTH years.\n#table(joined$occ_2dig_labels, joined$did_wfh_labels)\n\n\n#table(joined$occ_2digits)\n\ncrosstab_3way(joined, YEAR, occ_2dig_labels, did_wfh_labels, weight = PERWT)\n\n\n\n\n\nYEAR\ndid_wfh_labels\nManagement, Business, Science, Arts\nMilitary\nNatural Resources, Construction\nProduction, Transportation\nSales & Office Jobs\nService Occupations\nn\n\n\n2019\nDid not WFH\n40.1\n0.16  \n7.49\n14.9 \n20.1\n17.3 \n5.85e+06\n\n\n2019\nDid WFH\n55.3\n0     \n4.34\n4.72\n23.1\n12.6 \n3.18e+05\n\n\n2021\nDid not WFH\n37.8\n0.126 \n7.97\n17   \n19.3\n17.8 \n4.79e+06\n\n\n2021\nDid WFH\n67.5\n0.0353\n2.05\n3.82\n20.8\n5.79\n1.14e+06\n\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Military occupations make up less than 0.5% of the labor force and were removed from the graph. Occupation categories are based on broadest aggregated BLS categories used by the BLS.\n\n\nCode\ntable &lt;- svytable(~YEAR+occ_2dig_labels, design = dstrata) \ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;%\n  arrange(-n)\ntable\n\n\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Military occupations make up less than 0.5% of the labor force and were removed from the graph. Occupation categories are based on broadest aggregated BLS categories used by the BLS.\n\n\nCode\ntable %&gt;% filter(occ_2dig_labels != \"Military\") %&gt;% ggplot(aes(x=fct_rev(fct_inorder(occ_2dig_labels)), y=n, group = YEAR)) + \n  geom_col(stat = \"identity\", fill=\"lightblue\") +\n  facet_wrap(~YEAR)+\n        geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.02,Prop, \"\")), accuracy = .1),accuracy  = .1L ),position = position_stack(vjust=.5), size=3) +\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(\n    title =\"Proportion of Occupation Types in  Illinois\",\n    subtitle = \"By Most Aggregated Occupation Groups used by BLS & ACS\",\n       x = \"\", y = \"Estimated Number of Workers\")+\n scale_y_continuous(labels = scales::comma)+\nscale_x_discrete(labels = function(x) str_wrap(x, width=25))+ # makes labels better on axsis\n\n  coord_flip()\n\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Military occupations make up less than 0.5% of the labor force and were removed from the graph. Occupation categories are based on broadest aggregated BLS categories used by the BLS.\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Military occupations make up less than 0.5% of the labor force and were removed from the graph. Occupation categories are based on broadest aggregated BLS categories used by the BLS.\n\n### Proportion of All Workers in each Occupation Type ###\ntable &lt;- svytable(~YEAR+occ_2dig_labels_d, design = dstrata) \ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;%\n  arrange(-n)\ntable\n\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Occupation categories based on first 2 digits of OCCSOC occupation codes. Labels for occupations that make up less than 2% of the workers were not labeled for legibility reasons.\n\ntable %&gt;% ggplot(aes(x=fct_rev(fct_inorder(occ_2dig_labels_d)), y=n, group = YEAR)) + \n  geom_col(stat = \"identity\", fill=\"lightblue\") +\n  facet_wrap(~YEAR)+\n        geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.02,Prop, \"\")), accuracy = .1),accuracy  = .1L ),position = position_stack(vjust=.5), size=3) +\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"WFH Feasibility by Occupation Type\",\n       #subtitle = \"Little change between 2019 and 2021 Occurred\",\n       x = \"\", y = \"Estimated Number of Workers\") + scale_y_continuous(labels = scales::comma)+\n  coord_flip()\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Occupation categories based on first 2 digits of OCCSOC occupation codes. Labels for occupations that make up less than 2% of the workers were not labeled for legibility reasons.\n\n\n\n### Percent of Workersworking from home within each Broad Occupation type ###\ntable &lt;- svytable(~YEAR+did_wfh_labels+occ_2dig_labels, design = dstrata) \n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, occ_2dig_labels)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;%\n  arrange(did_wfh_labels, -n)\ntable\n\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Occupation categories based on first 2 digits of OCCSOC occupation codes. Labels for occupations that make up less than 2% of the workers were not labeled for legibility reasons.\n\ntable %&gt;% filter(occ_2dig_labels != \"Military\" ) %&gt;%\n  ggplot(aes(x=fct_rev(fct_inorder(occ_2dig_labels)), y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +facet_wrap(~YEAR)+\n        geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.05,Prop, \"\")), accuracy = .1),accuracy  = .1L ),position = position_stack(vjust=.5), size=3) +\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Proportion of Workers in each Occupation Who Did WFH\",\n       subtitle = \"Percentages add to 100% within each occupation\",\n       x = \"\", y = \"Estimated # of People\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates. Military occupations were excluded from graph due to low occurance of observations.\") + scale_y_continuous(labels = scales::comma)+\n  scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\")) +\n  coord_flip()\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Occupation categories based on first 2 digits of OCCSOC occupation codes. Labels for occupations that make up less than 2% of the workers were not labeled for legibility reasons.\n\n\n\n\n\n## Proportion of all workers in each occupation cateogory.## \ntable &lt;- svytable(~YEAR+did_wfh_labels+occ_2dig_labels, design = dstrata) \n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;%\n  arrange(did_wfh_labels, -n)\ntable\n\n\n\n  \n\n\ntable %&gt;% \n  filter(occ_2dig_labels != \"Military\") %&gt;%\n  ggplot(aes(x=fct_rev(fct_inorder(occ_2dig_labels)), y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n  geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.02,Prop, \"\")), accuracy = .1), accuracy  = .1L ),\n            position = position_stack(vjust=.5), size=3) +\n  theme_classic() + \n  theme(legend.position = \"none\", legend.title = element_blank(), \n        plot.title.position = \"plot\",\n         panel.background = element_rect(fill='transparent'), #transparent panel bg\n    plot.background = element_rect(fill='transparent', color=NA) #transparent plot bg\n   )+\n  labs(title =\"Proportion of Illinois Workforce Who Worked From Home\",\n      # subtitle = \"All workers in labor force with occsoc codes in a year add to 100%\",\n       x = \"\", y = \"Estimated Number of Workers\") +#,\n     # caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") \nscale_y_continuous(labels = scales::comma) +\n  \n    scale_x_discrete(labels = function(x) str_wrap(x, width=25))+ # makes labels better on axsis\n\n  scale_fill_manual(values = c(\"#a6bddb\",  \"#2b8cbe\")) + coord_flip()\n\n\n\n#ggsave(\"Figure3.eps\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n#ggsave(\"Figure3.pdf\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\nggsave(\"Figure3.png\", limitsize = FALSE, width = 8, height = 4, units = \"in\")\n\n\n### Detailed Occuation Types ## \ntable &lt;- svytable(~YEAR+did_wfh_labels+occ_2dig_labels_d, design = dstrata) \n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;%\n  arrange(did_wfh_labels, -n)\ntable\n\n\n\n  \n\n\ntable %&gt;%ggplot(aes(x=fct_rev(fct_inorder(occ_2dig_labels_d)), y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.01,Prop, \"\")), accuracy = .1),accuracy  = .1L ),position = position_stack(vjust=.5), size=3) +\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home by 2-digit Occupation type\",\n       x = \"\", y = \"Estimated Number of Workers\") + \n  scale_y_continuous(labels = scales::comma)+\n  scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\")) +\n  coord_flip()\n\n\n\n\nACS 1 year samples for 2019 and 2021 used for weighted population estimates. Graph interpretation: 3.6% of all worker in the labor force in 2021 were in Management occupations and worked from home. 8.3% of all workers were in management and did not work from home. Workers in Management occupations make up 11.9% of the entire workforce.\n\n# Both years, detailed observation types\ntable &lt;- svytable(~YEAR+CanWorkFromHome+occ_2dig_labels_d, design = dstrata) \n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% \n  arrange(CanWorkFromHome,-n) %&gt;%\n  mutate(Prop =round(n/sum(n), digits=3))\ntable\n\n\n\n  \n\n\ntable %&gt;% \n  ggplot(aes(x=fct_rev(fct_inorder(occ_2dig_labels_d)), y=n, fill = CanWorkFromHome, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n  geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.01,Prop, \"\")), accuracy = .1), accuracy= 0.1L ),position = position_stack(vjust=.5), size=3) +\ntheme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent of Illinois Workers that Could WFH by Occupation Type\",\n       x = \"\", y = \"Estimated Number of Workers\") + \n  scale_y_continuous(labels = scales::comma)+\n  scale_fill_manual(values = c( \"#117733\",\"#44AA99\",\"#D8D5C5\")) +\n  coord_flip()\n\n\n\n\nOCCSOC codes and Teleworkable scores from occupation characteristics. 11.6% of all workers in Illinois had management occupations (6.6 Can WFH + 1.8 No WFH + 3.2 Some WFH in 2021). 6.6% of all workers in Illinois had management occupations and could feasibly WFH. ACS 1 year samples for 2019 and 2021 used for weighted population estimates.\n\ntable &lt;- svytable(~YEAR+CanWorkFromHome+occ_2dig_labels_d, design = dstrata) \n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  filter(YEAR==2021)%&gt;% \n  arrange(CanWorkFromHome, -n) %&gt;%\n  mutate(Prop =round(n/sum(n), digits=3))\n\n\ntable %&gt;% \n  ggplot(aes(x=fct_rev(fct_inorder(occ_2dig_labels_d)), y=n, fill = CanWorkFromHome, group=YEAR)) + \n  geom_col(position=\"stack\", stat = \"identity\")+\n  geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.01,Prop, \"\")), accuracy = .1), accuracy= 0.1L ), position = position_stack(vjust=.5), size=3) +\ntheme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent of Workers that Could Feasibily Work From Home in 2021\", \n       x = \"\", y = \"# of People\",\n      caption = \"Occupation codes (OCCSOC)from the 2021 1-year ACS merged with work from home feasibility scores.\") + scale_y_continuous(labels = scales::comma)+\n  scale_fill_manual(values = c( \"#2b8cbe\",\"#a6bddb\",\"gray80\")) +\n  coord_flip()\n\n\n\n\n\n## Proportion of all workers in each occupation cateogory.## \ntable &lt;- svytable(~YEAR+CanWorkFromHome+occ_2dig_labels, design = dstrata) \n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;%\n  arrange(CanWorkFromHome, -n)\ntable\n\n\n\n  \n\n\nFigure1 &lt;- table %&gt;% filter(occ_2dig_labels != \"Military\") %&gt;%\n  ggplot(aes(x=fct_rev(fct_inorder(occ_2dig_labels)), y=n, fill = CanWorkFromHome, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n  geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.02,Prop, \"\")), accuracy = .1),accuracy  = .1L ), \n            position = position_stack(vjust=.5), size=2.5) +\n  theme_classic() +\n  theme(plot.title = element_text(hjust=0), legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Proportion of All WFH Workers by Broad Occupation\",\n     #  subtitle = \"All workers in labor force with occsoc codes in a year add to 100%\",\n       x = \"\", y = \"Number of Workers in Illinois\",\n   #   caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates\"\n     ) + \n  scale_x_discrete(labels = function(x) str_wrap(x, width=25))+ # makes labels better on axsis\n  scale_y_continuous(labels = scales::comma) +\n  scale_fill_manual(values = c( \"#2b8cbe\",\"#a6bddb\", \"gray89\")) +\n  coord_flip()          # = element_text(hjust = 0, vjust=2.12))\n\nFigure1\n\n\n\n#ggsave(\"Figure1.eps\", limitsize = FALSE,width = 8, height = 4, units = \"in\")#\n# ggsave(\"Figure1.pdf\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\nggsave(\"Figure1.png\", limitsize = FALSE, width = 8, height = 4, units = \"in\")\n\n#ggsave(\"Figure1.png\", limitsize=FALSE, dpi = \"retina\")\n\n\n\nCould WFH vs. did WFH\n\n\nCode\n## Totals add up to total number of workers in a year\ntable &lt;- svytable(~CanWorkFromHome+YEAR+did_wfh_labels, design = dstrata) \n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% # will divide by all workers per year\n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;%\n  arrange(did_wfh_labels, -n)\n\ntable\n\n\n\n\n\n\nPercentages add up to 100 when adding all workers together within a year. Did work from home based on TRANWORK==80 variable from ACS surveys. Can Work from home based on teleworkable classification in Dingel & Niemen (2020). ACS 1 year samples for 2019 and 2021 used for weighted population estimates.\n\n\nCode\n## percentages add up to 100 when adding all workers together for a year\ntable %&gt;% ggplot(aes(CanWorkFromHome, y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) +\n  #scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))+\n  theme_classic() + theme(legend.position = \"none\", legend.title = element_blank())+\n  labs(title =\"Did those who could work from home actually work from home?\",subtitle = \"2019 vs 2021\",\n       x = \"\", y = \"Estimated Number of Workers\") + \n  scale_y_continuous(labels = scales::comma) + \n  scale_fill_manual(values = c(\"#a6bddb\",  \"#2b8cbe\"))\n\n\n\n\n\nPercentages add up to 100 when adding all workers together within a year. Did work from home based on TRANWORK==80 variable from ACS surveys. Can Work from home based on teleworkable classification in Dingel & Niemen (2020). ACS 1 year samples for 2019 and 2021 used for weighted population estimates.\n\n\n\n\nCode\n#ggsave(\"Figure1.eps\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n#ggsave(\"Figure1.pdf\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\nggsave(\"Figure8.png\", limitsize = FALSE, width = 7, height = 5, units = \"in\")\n\n\n\ntable &lt;- svytable(~CanWorkFromHome+YEAR+did_wfh_labels, design = dstrata) \n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, CanWorkFromHome)%&gt;% # divides by all workers per year within each categor\n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;% \n  arrange(did_wfh_labels,-n)\ntable\n\n\n\n  \n\n\nxtabs(~did_wfh_labels+CanWorkFromHome+YEAR, data = dstrata)\n\n, , YEAR = 2019\n\n              CanWorkFromHome\ndid_wfh_labels Can WFH No WFH Some WFH\n   Did not WFH   18433  30664     7094\n   Did WFH        1484    971      596\n\n, , YEAR = 2021\n\n              CanWorkFromHome\ndid_wfh_labels Can WFH No WFH Some WFH\n   Did not WFH   13594  27599     5380\n   Did WFH        6217   2225     2370\n\n## percentages add up to 100 when adding all workers together for a year\ntable %&gt;% ggplot(aes(fct_inorder(CanWorkFromHome), y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\")  +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop, accuracy = 0.1L)), position = position_stack(vjust=.5), size=3) +\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Did those who COULD work from home actually work from home:\", subtitle = \"2019 vs 2021\",\n       x = \"\", y = \"# of People\",\n      caption = \"Comparison graph that might feel more correct.\n      Percentages add up to 100 when adding all workers within each CanWorkFromHome category for each a year.\n      Did work from home based on TRANWORK==80 variable from ACS surveys. Can Work from home based on teleworkable classification in Dingel & Niemen (2020).\n            ACS 1 year samples for 2019 and 2021 used for weighted population estimates.\") + scale_y_continuous(labels = scales::comma)+\n  scale_fill_manual(values = c(\"#a6bddb\",  \"#2b8cbe\")) \n\n\n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, CanWorkFromHome)%&gt;% # divides by all workers per year within each categor\n  filter(CanWorkFromHome != \"Some WFH\") %&gt;%\n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;% \n  arrange(did_wfh_labels,-n)\ntable\n\n\n\n  \n\n\nxtabs(~did_wfh_labels+CanWorkFromHome+YEAR, data = dstrata)\n\n, , YEAR = 2019\n\n              CanWorkFromHome\ndid_wfh_labels Can WFH No WFH Some WFH\n   Did not WFH   18433  30664     7094\n   Did WFH        1484    971      596\n\n, , YEAR = 2021\n\n              CanWorkFromHome\ndid_wfh_labels Can WFH No WFH Some WFH\n   Did not WFH   13594  27599     5380\n   Did WFH        6217   2225     2370\n\n## percentages add up to 100 when adding all workers together for a year\ntable %&gt;% ggplot(aes(fct_inorder(CanWorkFromHome), y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\")  +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop, accuracy = 0.1L)), position = position_stack(vjust=.5), size=3) +\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Did those who COULD work from home actually work from home:\", subtitle = \"2019 vs 2021\",\n       x = \"\", y = \"# of People\",\n      caption = \"Comparison graph that might feel more correct.\n      Percentages add up to 100 when adding all workers within each CanWorkFromHome category for each a year.\n      Did work from home based on TRANWORK==80 variable from ACS surveys. Can Work from home based on teleworkable classification in Dingel & Niemen (2020).\n            ACS 1 year samples for 2019 and 2021 used for weighted population estimates.\") + scale_y_continuous(labels = scales::comma)+\n  scale_fill_manual(values = c(\"#a6bddb\",  \"#2b8cbe\")) \n\n\n\n# \n# table &lt;- svytable(~CanWorkFromHome+YEAR+did_wfh_labels, design = dstrata) \n# # proportion of each respondant's sex and if they worked from home for each year in sample\n# table &lt;- table %&gt;% \n#   as_tibble() %&gt;% \n#   group_by(YEAR, did_wfh_labels)%&gt;% # divides by all workers per year within each categor\n#   mutate(Prop =round(n/sum(n), digits=3))\n\n\n## percentages add up to 100 when adding all workers together for a year\n## Don't like this version of the graph ### \n# table %&gt;% ggplot(aes(did_wfh_labels, y=n, fill = CanWorkFromHome, group = YEAR)) + \n#   geom_col(stat = \"identity\", position = \"stack\") +\n#   facet_wrap(~YEAR)+\n#     geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) +\n#   theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n#   labs(title =\"Did those who COULD work from home actually work from home:\", subtitle = \"2019 vs 2021\",\n#        x = \"\", y = \"# of People\",\n#       caption = \"Comparison graph that might feel more correct.\n#       Percentages add up to 100 when adding all workers within each did_wfh category for each a year.\n#       Did work from home based on TRANWORK==80 variable from ACS surveys. Can Work from home based on teleworkable classification in Dingel & Niemen (2020).\n#             ACS 1 year samples for 2019 and 2021 used for weighted population estimates.\") + scale_y_continuous(labels = scales::comma)\n\n\nIdeally switch order of categories so that Did WFH is on the bottom of stack. Allows easier visual comparison.\n\n\n\nCreating Income Deciles\n\n# svyquantile shows the breaks for the quantiles. hypothetically uses weights of observations for calculation of deciles.\n# equal number of people should be in each decile after weights are applied \ninc_quantiles &lt;- survey::svyquantile(~INCEARN, design=dstrata2019, \n    quantiles = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1) , na.rm=TRUE,  ci = FALSE  )\n# $INCEARN for 2019\n#[1,] 4 8000 16000 24000 30900 40000 50000 62000 80000 113000 933000\n# values not adjusted to 2021 values.\ninc_quantiles\n\n$INCEARN\n     0  0.1   0.2   0.3   0.4   0.5   0.6   0.7   0.8    0.9      1\n[1,] 4 8300 16500 25000 31200 40000 50000 62000 80000 114000 933000\n\nattr(,\"hasci\")\n[1] FALSE\nattr(,\"class\")\n[1] \"newsvyquantile\"\n\ninc_quantiles &lt;-survey::svyquantile(~INCEARN, design=dstrata2021, \n                    quantiles = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1) ,\n                    na.rm=TRUE, ci = FALSE  )\ninc_quantiles\n\n$INCEARN\n     0  0.1   0.2   0.3   0.4   0.5   0.6   0.7   0.8    0.9      1\n[1,] 4 8000 17000 25600 35000 42500 53000 68000 85000 120000 949000\n\nattr(,\"hasci\")\n[1] FALSE\nattr(,\"class\")\n[1] \"newsvyquantile\"\n\n# $INCEARN\n# [1,] 4 7200 16000 25000 34000 42000 52000 67000 85000 120000 949000\n\n\n\nbreaks2019 &lt;- c(7200, 16000, 25000, 34000, 42000, 52000, 67000, 85000, 120000)\n\nbreaks2019adjusted &lt;- c(8478, 16956, 25434, 32853, 42390, 52988, 65705, 84781, 120813) \n# from 2021 5 year sample and filtered for just 2019. \n# already adjusted for inflation.\n# included for comparison and to decide to use 5 year ACS or 2019 and 2021 1 year ACS\n\nbreaks2021 &lt;- c(8000, 18000, 26000, 35000, 43000, 54000, 68000, 85000, 120000)\n\n# Code done above when creating variables in beginning chunks. \n# joined &lt;- joined %&gt;% \n#   mutate(incdecile_w = case_when(\n#     INCEARN &lt; 8000 ~ 1, \n#     INCEARN &gt;= 8000 & INCEARN &lt; 18000 ~ 2,\n#     INCEARN &gt;= 18000 & INCEARN &lt; 26000 ~ 3,\n#     INCEARN &gt;= 26000 & INCEARN &lt; 35000 ~ 4,\n#     INCEARN &gt;= 35000 & INCEARN &lt; 43000 ~ 5,\n#     INCEARN &gt;= 43000 & INCEARN &lt; 54000 ~ 6,\n#     INCEARN &gt;= 54000 & INCEARN &lt; 68000 ~ 7,\n#     INCEARN &gt;= 68000 & INCEARN &lt; 85000 ~ 8,\n#     INCEARN &gt;= 85000 & INCEARN &lt; 120000 ~ 9,\n#     INCEARN &gt;= 120000 ~ 10)\n#   )\n# number of observations in each decile after weights used for creating the income deciles\n#table(joined$incdecile_w)\n\n# no major differnce between years in who COULD work from home based on teleworkable codes. Makes sense. \n# ggplot(joined, aes(teleworkable, weight = PERWT)) +\n# geom_histogram()+facet_wrap(~YEAR)\n\n\n\ntable &lt;- svytable(~YEAR+incdecile_w+did_wfh_labels,  design = dstrata) # proportion of each respondants sex in sample\n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR,incdecile_w)%&gt;%\n  mutate(Prop=round(n/sum(n), digits=3)) %&gt;%\n  filter(did_wfh_labels == \"Did WFH\")\n\ntable # has proportions calculated out of TOTAl for both years\n\n\n\n  \n\n\ntable %&gt;%\n  ggplot(aes(factor(incdecile_w, levels = c(1,2,3,4,5,6,7,8,9,10), labels = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\")), \n                     y=Prop, fill = YEAR, group = factor(YEAR, levels = \"2021\",\"2019\"))) + \n  geom_col(stat=\"identity\", position = \"dodge\")+\n  #geom_col(stat = \"identity\", position = \"stack\") +   # scale_x_discrete(limits = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\"))+\n\n # facet_wrap(~YEAR)+\n   coord_flip()+\n    geom_text(aes(label = scales::percent(Prop, accuracy = 0.1L)), position = position_dodge(width = 0.8), hjust = 1.1,\n              size = 4) + \n  labs(title =\"Working From Home by Earned Income Deciles\",\n  subtitle = \"2019 vs 2021\",\n #      caption = \"ACS 1 year samples for 2019 and 2021. Working from home based on TRANWORK question on commuting.\n#       All workers in the labor force, all ages included.\n#       Income based on INCEARN for total earned income of survey respondents.\", \n       x= \"Income Deciles\", \n       y = \"Percent of earners working from home\") + \n theme(legend.position = \"none\", legend.title = element_blank())+\n  theme_classic()+\n    scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\")) +\n  scale_y_continuous(labels = scales::percent)\n\n\n\n#ggsave(\"Figure6.eps\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n#ggsave(\"Figure6.pdf\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\nggsave(\"Figure6.png\", limitsize = FALSE, width = 8, height = 4, units = \"in\")\n\ndecile_labels &lt;- c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\")\n\n\nwho did work from home in lower income brackets???\n\n\n399011 in Service Occupations had 148 observations, 311122 had 86.\nVast Majority of those that did work form home in the bottom 10% of earners had management, business, sales, or office jobs. (specifically 399011, 253041,436014)\noutliers: occupation 537062, 533030, 537065 in production and transportation, 399011 in service occupations which usually need to be in person.\n399011 (2nd and 3rd decile), 311122 (2nd and 3rd decile)\n\n\ndata %&gt;% filter(did_wfh==1 & incdecile_w &lt; 4) %&gt;% group_by(incdecile_w, occ_2digits, occ_2dig_labels, OCCSOC) %&gt;% summarize(obs = n()) %&gt;% arrange(incdecile_w,-obs)\n\n\n\n  \n\n\n\n\n\nGender and Working from home\n19.2% of those in the labor force worked from home in 2021.\n\n10.7% were women, 9.8% were men.\nIn 2021, 17.6% of male workers did WFH and 21% of female workers did WFH.\n\n52.5% of those in the labor force that have occupation codes were Men, 47.5% were Women.\n\n#round(prop.table(svytable(~did_wfh_labels, design=dstrata2019))*100,digits=2) \n#94.7 did not wfh, 5.29 did work from home in 2019\n\nround(prop.table(svytable(~did_wfh_labels, design=dstrata2021))*100,digits=2) \n\ndid_wfh_labels\nDid not WFH     Did WFH \n      80.76       19.24 \n\n# # unweighted attempt at summary table using \"data\" dataframe\n# table &lt;- data %&gt;% \n#  # filter(did_wfh==1) %&gt;%  \n#   mutate(total = n())  %&gt;%\n#   group_by(YEAR, did_wfh_labels, SEX) %&gt;% \n#   dplyr::summarize(n_unweighted=n()) %&gt;% \n#   mutate(Prop = n_unweighted/sum(n_unweighted))\n# # unweighted sex proportions each year\n# # for comparison\n# \n# # of those that did work from home,51% were female in 2019 and 51.9% were female in 2021. \n# table \n\ntable &lt;- svytable(~SEX+YEAR+did_wfh_labels, design = dstrata) \n# proportion of each sex that did or did not work from home \ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, SEX)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=4))\n# 5.4% of women worked at home in 2019 and 21% of women worked at home in 2021.\ntable\n\n\n\n  \n\n\n# # attempt 1, not what I wanted\n# table %&gt;% ggplot(aes(did_wfh_labels, y=Prop, group = YEAR, fill = YEAR)) + \n#   geom_col(stat = \"identity\", position = \"dodge\") +    \n#   geom_text(aes(label = scales::percent(Prop)), position = position_dodge(width = .9), size=3,vjust=1.1) + \n#   theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n#   labs(title =\"First Attempt at WFH graph for each Year\",\n#        x = \"\", y = \"\",\n#       caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::percent)\n\n\n# # attempt 2\n# table %&gt;% ggplot(aes(factor(SEX, labels = c(\"Male\", \"Female\")), y=Prop, fill = did_wfh_labels, group = YEAR)) + \n#   geom_col(stat = \"identity\", position = \"stack\") +\n#   facet_wrap(~YEAR)+\n#     geom_text(aes(label = scales::percent(Prop)), position = position_fill(vjust=.5), size=3) + \n#   theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n#   scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))+\n#   labs(title =\"Percent working from home by Sex: 2019 vs 2021\",\n#        x = \"\", y = \"\",\n#       caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::percent)\n\n\n### Percentages add up to 100% for each gender for each year. \ntable %&gt;% ggplot(aes(factor(SEX, labels = c(\"Male\", \"Female\")), y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) +\n  scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))+\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home by Sex: 2019 vs 2021\",\n       x = \"\", y = \"# of People\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::comma)\n\n\n\n#compare combined strata survey design to single year survey objects:\n# MATCHES\n# table &lt;- svytable(~SEX+did_wfh, design = dstrata2019) # proportion of each respondants sex in sample\n# table &lt;- table %&gt;% \n#   as_tibble() %&gt;% \n#   group_by(SEX) %&gt;%\n#   mutate(Prop = round(n/sum(n), digits=4))\n# table\n# \n# table &lt;- svytable(~SEX+did_wfh, design = dstrata2021, \n#                   round= TRUE) \n# table &lt;- table %&gt;% \n#   as_tibble() %&gt;% group_by(SEX) %&gt;%\n#   mutate(Prop = round(n/sum(n), digits=4))\n# table\n\n\n\n## Totals add up to total number of workers in a year\ntable &lt;- svytable(~SEX+YEAR+did_wfh_labels, design = dstrata) \n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% # grouped by Year and Sex!!\n  mutate(Prop =round(n/sum(n), digits=4))\ntable\n\n\n\n  \n\n\n## percentages add up to 100 when adding all workers together for a year\ntable %&gt;% ggplot(aes(factor(SEX, labels = c(\"Male\", \"Female\")), y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) +\n  scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))+\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home by Sex: 2019 vs 2021\",\n       x = \"\", y = \"# of People\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates.\n      Percentages add up to 100 when adding all workers together each year.\n      Working from home based on TRANWORK==80 variable from ACS surveys.\") + scale_y_continuous(labels = scales::comma)\n\n\n\nsvyttest(formula = SEX~did_wfh_labels, design = dstrata2021)\n\n\n    Design-based t-test\n\ndata:  SEX ~ did_wfh_labels\nt = 8.3, df = 35419, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in mean is not equal to 0\n95 percent confidence interval:\n 0.04071947 0.06589675\nsample estimates:\ndifference in mean \n        0.05330811 \n\nsvychisq(~did_wfh_labels+SEX, dstrata2021, statistic = \"Chisq\")\n\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  NextMethod()\nX-squared = 106.93, df = 1, p-value &lt; 2.2e-16\n\nround(prop.table(svytable(~SEX+did_wfh_labels, design=dstrata2021))*100,digits=2)\n\n   did_wfh_labels\nSEX Did not WFH Did WFH\n  1       43.21    9.27\n  2       37.55    9.97\n\n\n\nround(prop.table(svytable(~has_occsoc+SEX, design=dstrata2019))*100,digits=2)\n\n          SEX\nhas_occsoc     1     2\n         1 51.89 48.11\n\n# slight drop in women in the workforce (technically women with occupations). \nround(prop.table(svytable(~has_occsoc+SEX, design=dstrata2021))*100,digits=2)\n\n          SEX\nhas_occsoc     1     2\n         1 52.45 47.55\n\nCrossTable(data$SEX, data$YEAR)\n\n\n \n   Cell Contents\n|-------------------------|\n|                       N |\n| Chi-square contribution |\n|           N / Row Total |\n|           N / Col Total |\n|         N / Table Total |\n|-------------------------|\n\n \nTotal Observations in Table:  123753 \n\n \n             | data$YEAR \n    data$SEX |      2019 |      2021 | Row Total | \n-------------|-----------|-----------|-----------|\n           1 |     32427 |     31944 |     64371 | \n             |     0.264 |     0.270 |           | \n             |     0.504 |     0.496 |     0.520 | \n             |     0.519 |     0.522 |           | \n             |     0.262 |     0.258 |           | \n-------------|-----------|-----------|-----------|\n           2 |     30092 |     29290 |     59382 | \n             |     0.286 |     0.292 |           | \n             |     0.507 |     0.493 |     0.480 | \n             |     0.481 |     0.478 |           | \n             |     0.243 |     0.237 |           | \n-------------|-----------|-----------|-----------|\nColumn Total |     62519 |     61234 |    123753 | \n             |     0.505 |     0.495 |           | \n-------------|-----------|-----------|-----------|\n\n \n\nxtabs(~SEX+YEAR, data = data) %&gt;% summary()\n\nCall: xtabs(formula = ~SEX + YEAR, data = data)\nNumber of cases in table: 123753 \nNumber of factors: 2 \nTest for independence of all factors:\n    Chisq = 1.113, df = 1, p-value = 0.2914\n\nxtabs(~did_wfh+SEX+YEAR, data = data) %&gt;% summary()\n\nCall: xtabs(formula = ~did_wfh + SEX + YEAR, data = data)\nNumber of cases in table: 118064 \nNumber of factors: 3 \nTest for independence of all factors:\n    Chisq = 5246, df = 4, p-value = 0\n\n## Most interesting change: \nround(prop.table(svytable(~SEX+did_wfh_labels, design=dstrata2019))*100,digits=2) \n\n   did_wfh_labels\nSEX Did not WFH Did WFH\n  1       49.27    2.58\n  2       45.57    2.58\n\n# 1 is Male, 2 is female\nround(prop.table(svytable(~SEX+did_wfh_labels, design=dstrata2021))*100,digits=2) \n\n   did_wfh_labels\nSEX Did not WFH Did WFH\n  1       43.21    9.27\n  2       37.55    9.97\n\n# Chi square goodness of fit\n\n# practice test to see if sex is 52% male and 48% female. For both years. \nchisq.test(table(joined$SEX), p = c(52, 48)/100)\n\n\n    Chi-squared test for given probabilities\n\ndata:  table(joined$SEX)\nX-squared = 0.0049174, df = 1, p-value = 0.9441\n\n# can't reject the null, so the sample represents the population if the known population is 52% male and 48% female.\n\nsvytotal(x = ~interaction(SEX, did_wfh_labels), design = dstrata2021, na.rm=TRUE)\n\n                                                total      SE\ninteraction(SEX, did_wfh_labels)1.Did not WFH 2562380 20128.2\ninteraction(SEX, did_wfh_labels)2.Did not WFH 2226558 18405.0\ninteraction(SEX, did_wfh_labels)1.Did WFH      549602  9349.2\ninteraction(SEX, did_wfh_labels)2.Did WFH      591233  9978.3\n\nsvytotal(x = ~interaction(SEX, did_wfh_labels), design = dstrata2019, na.rm=TRUE)\n\n                                                total      SE\ninteraction(SEX, did_wfh_labels)1.Did not WFH 3039231 21479.7\ninteraction(SEX, did_wfh_labels)2.Did not WFH 2811408 21035.5\ninteraction(SEX, did_wfh_labels)1.Did WFH      159128  5711.1\ninteraction(SEX, did_wfh_labels)2.Did WFH      159046  5242.4\n\n#svymean(x = ~interaction(INCEARN, EMPSTAT), design = dstrata2021, na.rm=TRUE)\n#svymean(x = ~interaction(INCEARN, LABFORCE), design = dstrata2021, na.rm=TRUE)\n\n\nsvyttest(formula = INCEARN~SEX, design = dstrata2021)\n\n\n    Design-based t-test\n\ndata:  INCEARN ~ SEX\nt = -32.274, df = 36475, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in mean is not equal to 0\n95 percent confidence interval:\n -23794.51 -21069.87\nsample estimates:\ndifference in mean \n         -22432.19 \n\nsvyttest(formula = INCEARN~did_wfh_labels, design = dstrata2021)\n\n\n    Design-based t-test\n\ndata:  INCEARN ~ did_wfh_labels\nt = 27.63, df = 35419, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in mean is not equal to 0\n95 percent confidence interval:\n 32054.25 36949.32\nsample estimates:\ndifference in mean \n          34501.79 \n\ntable &lt;- svytable(~SEX+YEAR+did_wfh_labels, design = dstrata) \n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, SEX)%&gt;% # grouped by Year and Sex!!\n  mutate(Prop =round(n/sum(n), digits=4))\ntable\n\n\n\n  \n\n\n\nNull hypothesis: There is no difference in working from home associated with sex.\nAlt. Hyp: Working from home is associated with sex.\n\nsvychisq(~SEX+did_wfh_labels, design = dstrata2021, statistic = \"Chisq\")\n\n\n    Pearson's X^2: Rao & Scott adjustment\n\ndata:  NextMethod()\nX-squared = 106.93, df = 1, p-value &lt; 2.2e-16\n\n\n\nincomebysex&lt;- dstrata2021 %&gt;% \n  mutate(INCEARN = as.numeric(INCEARN) )%&gt;%\n  svyby(formula = ~ INCEARN, by = ~SEX, \n      FUN = svyquantile, \n      na.rm=TRUE,\n        quantiles  = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9) )\n\nincomebysex %&gt;% \n  pivot_longer(cols = c(-SEX),names_to = \"columns\", values_to = \"values\") %&gt;% \n  mutate(values = round(values, digits =2))\n\n\n\n\nSEX\ncolumns\nvalues\n\n\n1\nINCEARN.0\n4       \n\n\n1\nINCEARN.0.1\n1e+04       \n\n\n1\nINCEARN.0.2\n2e+04       \n\n\n1\nINCEARN.0.3\n3e+04       \n\n\n1\nINCEARN.0.4\n4e+04       \n\n\n1\nINCEARN.0.5\n5e+04       \n\n\n1\nINCEARN.0.6\n6.1e+04 \n\n\n1\nINCEARN.0.7\n7.8e+04 \n\n\n1\nINCEARN.0.8\n1e+05       \n\n\n1\nINCEARN.0.9\n1.4e+05 \n\n\n1\nse.INCEARN.0\n4.08    \n\n\n1\nse.INCEARN.0.1\n255       \n\n\n1\nse.INCEARN.0.2\n510       \n\n\n1\nse.INCEARN.0.3\n332       \n\n\n1\nse.INCEARN.0.4\n510       \n\n\n1\nse.INCEARN.0.5\n510       \n\n\n1\nse.INCEARN.0.6\n765       \n\n\n1\nse.INCEARN.0.7\n1.02e+03\n\n\n1\nse.INCEARN.0.8\n918       \n\n\n1\nse.INCEARN.0.9\n2.04e+03\n\n\n2\nINCEARN.0\n4       \n\n\n2\nINCEARN.0.1\n6e+03       \n\n\n2\nINCEARN.0.2\n1.4e+04 \n\n\n2\nINCEARN.0.3\n2.1e+04 \n\n\n2\nINCEARN.0.4\n3e+04       \n\n\n2\nINCEARN.0.5\n3.6e+04 \n\n\n2\nINCEARN.0.6\n4.5e+04 \n\n\n2\nINCEARN.0.7\n5.7e+04 \n\n\n2\nINCEARN.0.8\n7.2e+04 \n\n\n2\nINCEARN.0.9\n1e+05       \n\n\n2\nse.INCEARN.0\n4.08    \n\n\n2\nse.INCEARN.0.1\n204       \n\n\n2\nse.INCEARN.0.2\n306       \n\n\n2\nse.INCEARN.0.3\n408       \n\n\n2\nse.INCEARN.0.4\n306       \n\n\n2\nse.INCEARN.0.5\n587       \n\n\n2\nse.INCEARN.0.6\n510       \n\n\n2\nse.INCEARN.0.7\n765       \n\n\n2\nse.INCEARN.0.8\n1.28e+03\n\n\n2\nse.INCEARN.0.9\n765       \n\n\n\n\n\n\n\n\noutput &lt;- svyby(formula = ~INCEARN, by = ~SEX, design = dstrata2021,\n      FUN = svymean, na.rm=TRUE)\n  \nout_col &lt;- mutate(output, \n                  lower = INCEARN - 2*se, \n                  upper = INCEARN + 2*se)\n\nggplot(out_col, aes(SEX, INCEARN, ymin=lower, ymax=upper)) + geom_col() +geom_errorbar(width = 0.7) + labs( y = \"Average Earned Income\", x = \"Sex\")+ scale_x_discrete(limits = c(\"Male\", \"Female\") )\n\n\n\n\n\ntable &lt;- svytable(~SEX+NCHLT5+YEAR+did_wfh_labels, design = dstrata) \n# proportion of each sex that did or did not work from home \ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, did_wfh_labels)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=4))\n# 5.4% of women worked at home in 2019 and 21% of women worked at home in 2021.\ntable\n\n\n\n  \n\n\n\n\n\nGraphing Income Deciles\n\npercent includes both years for combined strata.\n\n\n\nCode\ntable &lt;- svytable(~YEAR+incdecile_w+CanWorkFromHome,  design = dstrata) # proportion of each respondants sex in sample\n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, incdecile_w)%&gt;%\n  mutate(Prop=round(n/sum(n), digits=3)) %&gt;%\n  mutate(CanWorkFromHome = factor(CanWorkFromHome, levels = c('No WFH', 'Some WFH',  'Can WFH')))\n\ntable \n\n\n\n\n  \n\n\n\nCode\ntable[rev(order(table$CanWorkFromHome)),]%&gt;%\n  ggplot(aes(factor(incdecile_w, levels = c(1,2,3,4,5,6,7,8,9,10), \n                    labels = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\")), \n                     y=Prop, \n            # fill = CanWorkFromHome,\n            fill = factor(CanWorkFromHome, levels = c(\"No WFH\", \"Some WFH\",  \"Can WFH\")), \n             group = factor(YEAR, levels = \"2021\",\"2019\"))) + \n  geom_col(aes(fill = factor(CanWorkFromHome, levels = c(\"No WFH\", \"Some WFH\",  \"Can WFH\")),stat=\"identity\", position = \"stack\"))+\n   coord_flip()+\n\n    geom_text(aes(label = scales::percent(Prop, accuracy = 0.1L)), position = position_fill(vjust =.5), size = 2) + \n    guides(fill = guide_legend(reverse = TRUE))+\n\n  labs(title =\"Percent of each income decile that could potentially work from home\",\n       subtitle = \"2019 vs 2021\",\n       caption = \" Based on occupation codes from ACS 1 year samples for 2019 and 2021. Teleworkable coding based on Dingel & Neimen 2020.\n       All workers in the labor force, all ages included.\n       Income based on INCEARN for total earned income of survey respondents.\", \n       x= \"Income Deciles\", \n       y = \"Percent of workers that can work from home based on occupation characteristics\") +   theme_classic()+\n\n theme(legend.position = \"bottom\", legend.title = element_blank())+\n  scale_y_continuous(labels = scales::percent) +   facet_wrap(~YEAR)\n\n\n\n\n\n\n\nCode\n# summary(as.numeric(data$INCEARN))\n# \n# # using decile made # of observations\n# summary &lt;- dstrata %&gt;% \n#   group_by(YEAR,decile) %&gt;% \n#   summarize(min = min(INCEARN),\n#             max=max(INCEARN),\n#             avg_income = mean(INCEARN),\n#             average_income = survey_mean(INCEARN),\n#             pop_represented = sum(PERWT),\n#             obs_count = n())\n# summary %&gt;% \n#   ggplot(aes(x=decile, y=average_income, label=scales::dollar(average_income))) + \n#   geom_col()+\n#   scale_x_discrete(limits = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\"))+\n#   scale_y_continuous(labels = scales::dollar)+labs(x=\"\",y=\"\", title = \"Average earned income for each income decile\")+\n#   geom_text(vjust = -0.5, size = 3)+\n#   facet_wrap(~YEAR)\n# \n# \n# \n# # with weighted deciles made from # of pop represented\n# summary &lt;- dstrata %&gt;% \n#   group_by(YEAR, incdecile_w) %&gt;% \n#   summarize(min = min(INCEARN),\n#             max=max(INCEARN),\n#             avg_income = mean(INCEARN),\n#             average_income = survey_mean(INCEARN),\n#             pop_represented = sum(PERWT),\n#             obs_count = n())\n# \n# summary %&gt;% \n#   ggplot(aes(x=incdecile_w, y=average_income, label=scales::dollar(average_income))) + \n#   geom_col()+\n#   scale_x_discrete(limits = c(\"Bottom 10%\", \"20%\", \"30%\", \"40%\", \"50%\", \"60%\", \"70%\", \"80%\", \"90%\", \"Top 10%\"))+\n#   scale_y_continuous(labels = scales::dollar)+labs(x=\"\",y=\"\", title = \"Average earned income for each income decile\")+\n#   geom_text(vjust = -0.5, size = 3)+\n#   facet_wrap(~YEAR)\n\n\n\n\noutput &lt;- svyby(formula = ~INCEARN, by = ~YEAR+incdecile_w, design = dstrata, \n      FUN = svymean, na.rm=TRUE)\n  \nout_col &lt;- mutate(output, \n                  lower = INCEARN - 2*se, \n                  upper = INCEARN + 2*se)\n\nggplot(out_col, aes(incdecile_w, INCEARN, ymin=lower, ymax=upper)) + \n  geom_col(stat = \"identity\") +\n  geom_errorbar(width = 0.7) + \n  facet_wrap(~YEAR) + \n  labs(title = \"Average income earned for each decile of income earners\", y = \"Average Earned Income for each Income Decile\", x = \"Deciles of Income Earners\", caption = \"NOT adjusted for inflation\")+ coord_flip() +\n  scale_x_discrete(limits = decile_labels ) + \n # ylim(0,250000)+\n  scale_y_continuous(label = scales::dollar, limits = c(0,275000))+\n   geom_text(aes(label = scales::dollar(INCEARN)), size=3, hjust=-.3)\n\n\n\n\n\n\n# data has 2019 and 2021 observatins TOGETHER\ntopline(data, did_wfh,  weight=PERWT)\n\n\n\n\nResponse\nFrequency\nPercent\nValid Percent\nCumulative Percent\n\n\n0\n1.07e+07\n83.6\n87.9\n87.9\n\n\n1\n1.48e+06\n11.5\n12.1\n100  \n\n\n(Missing)\n6.28e+05\n4.9\n  \n  \n\n\n\n\n\n\n# All members of the labor force could have said they either work from home (TRANWORK=80), go to work using some form of transportation, or didn't answer the question. 8.2% of the labor force did not answer the TRANWORK question and should not be included in calculations.\ndata %&gt;% filter(YEAR == 2021) %&gt;% crosstab(x=RACE, y=did_wfh_labels, weight = PERWT, pct_type = \"row\", unwt_n=TRUE, n=FALSE)  # matches Francis Total Row in Race output\n\n\n\n\nRACE\nDid not WFH\nDid WFH\nunweighted_n\n\n\nWhite\n79.3\n20.7 \n41725\n\n\nBlack/African American\n83.1\n16.9 \n4361\n\n\nAmerican Indian or Alaska Native\n92.8\n7.16\n373\n\n\nChinese\n65.2\n34.8 \n598\n\n\nJapanese\n80.5\n19.5 \n81\n\n\nOther Asian or Pacific Islander\n73.9\n26.1 \n2803\n\n\nOther race, nec\n90.5\n9.52\n3263\n\n\nTwo major races\n84.6\n15.4 \n4616\n\n\nThree or more major races\n82.5\n17.5 \n265\n\n\n\n\n\n\ndata  %&gt;% crosstab_3way(x=YEAR, y=did_wfh, z=race_cat, weight = PERWT)\n\n\n\n\nYEAR\nrace_cat\n0\n1\nn\n\n\n2019\nAsian\n94.6\n5.43\n3.8e+05 \n\n\n2019\nBlack\n96.8\n3.22\n7.56e+05\n\n\n2019\nOther\n97.5\n2.52\n5.29e+05\n\n\n2019\nWhite\n94.1\n5.95\n4.55e+06\n\n\n2021\nAsian\n72.6\n27.4 \n3.84e+05\n\n\n2021\nBlack\n83.1\n16.9 \n6.57e+05\n\n\n2021\nOther\n87.3\n12.7 \n1.11e+06\n\n\n2021\nWhite\n79.3\n20.7 \n3.82e+06\n\n\n\n\n\n\n\n\ncrosstab(data, x=LABFORCE, y=SEX, weight = PERWT, pct_type = \"row\", unwt_n=TRUE, n=FALSE) # matches Francis, 52% male, 48% female in laborforce\n\n\n\n\nLABFORCE\nMale\nFemale\nunweighted_n\n\n\nYes, in the labor force\n52.2\n47.8\n123753\n\n\n\n\n\n\ndata %&gt;% filter(YEAR ==2021) %&gt;% crosstab(x=did_wfh_labels, y=SEX, weight = PERWT, pct_type = \"row\", unwt_n=TRUE, n=FALSE)\n\n\n\n\ndid_wfh_labels\nMale\nFemale\nunweighted_n\n\n\nDid not WFH\n53.5\n46.5\n47136\n\n\nDid WFH\n48.1\n51.9\n10949\n\n\n\n\n\n\ncrosstab_3way(data, x=YEAR, y=did_wfh_labels, z=SEX, weight = PERWT, pct_type = \"row\", unwt_n=TRUE, n=FALSE)\n\n\n\n\nYEAR\nSEX\nDid not WFH\nDid WFH\nunweighted_n\n\n\n2019\nMale\n94.8\n5.16\n31069\n\n\n2019\nFemale\n94.6\n5.43\n28910\n\n\n2021\nMale\n82.4\n17.6 \n30300\n\n\n2021\nFemale\n79  \n21   \n27785\n\n\n\n\n\n\ncrosstab(joined, x=LABFORCE, y=SEX, weight = PERWT, pct_type = \"row\", unwt_n=TRUE, n=FALSE) # matches Francis, 52% male, 48% female in laborforce\n\n\n\n\nLABFORCE\nMale\nFemale\nunweighted_n\n\n\nYes, in the labor force\n52.2\n47.8\n122063\n\n\n\n\n\n\njoined %&gt;% filter(YEAR ==2021) %&gt;% crosstab(x=did_wfh_labels, y=SEX, weight = PERWT, pct_type = \"row\", unwt_n=TRUE, n=FALSE)\n\n\n\n\ndid_wfh_labels\nMale\nFemale\nunweighted_n\n\n\nDid not WFH\n53.5\n46.5\n46573\n\n\nDid WFH\n48.2\n51.8\n10812\n\n\n\n\n\n\ncrosstab_3way(joined, x=YEAR, y=did_wfh_labels, z=SEX, weight = PERWT, pct_type = \"row\", unwt_n=TRUE, n=FALSE)\n\n\n\n\nYEAR\nSEX\nDid not WFH\nDid WFH\nunweighted_n\n\n\n2019\nMale\n95  \n4.98\n30676\n\n\n2019\nFemale\n94.6\n5.35\n28566\n\n\n2021\nMale\n82.3\n17.7 \n29946\n\n\n2021\nFemale\n79  \n21   \n27439\n\n\n\n\n\n\n\n\n# Employment Status\ntable(data$EMPSTAT) # unweighted\n\ndata %&gt;% \n  group_by(YEAR, as_factor(EMPSTAT)) %&gt;%\n  dplyr::summarize(weightedcount=sum(PERWT),\n                   unweightedcount = n()) %&gt;%  #weighted\n  mutate(pct_weight = weightedcount/sum(weightedcount),\n         pct_noweight = unweightedcount/sum(unweightedcount))\n\n# Labor Force\ndata %&gt;% \n  group_by(YEAR, as_factor(LABFORCE)) %&gt;%\n  dplyr::summarize(weightedcount=sum(PERWT),\n                   unweightedcount = n()) %&gt;%  #weighted\n  mutate(pct_weight = weightedcount/sum(weightedcount),\n         pct_noweight = unweightedcount/sum(unweightedcount))\n\n\n# Class of Worker\ndata %&gt;% \n  group_by(YEAR, as_factor(CLASSWKR)) %&gt;%\n  dplyr::summarize(weightedcount=sum(PERWT),\n                   unweightedcount = n()) %&gt;%  #weighted\n  mutate(pct_weight = weightedcount/sum(weightedcount),\n         pct_noweight = unweightedcount/sum(unweightedcount))\n\nUnweighted -\nEMPSTAT: 59,259 observations are employed, 4,194 unemployed observations, and 41,289 observations are not in the workforce (21,881 NAs)\nLABFORCE: 63,453 are in labor force, 41,289 are not. (21,881 NAs)\nCLASSWKR: Of these, 68,388 work for wages and 7183 people are self-employed. (51,052 NA)\ndid_wfh: 10,949 observations worked from home, 47,584 did not work from home. Based on TRANWORK variable: recoded as binary variable (either did wfh or did not wfh).\nWeighted -\nEMPSTAT: 6,102,522 people are employed (49%), 479,879 people are unemployed (3.8%), and 3,624,811 are not in the labor force (29%). There are 2,463,257 missing values; Same as LABFORCE.\nLABFORCE: 6,582,401 people (52%) are in the labor force. 3,625,811 (28%) of people are not in the labor force. 2,463,257 (20%) of observations missing values.\n\nemployed and unemployed equal number of people in labor force - that’s good\n\ndid_wfh: 19.2% did work from home and 80.8% did not work from home in Illinois (when not filtering for age or employment)\nLocation of primary workplace: 5.8 million people located in Illinois.\nFor the counties that can be identified in the data (populations &gt; 100,000 & &lt; 200,000. 1-Year ACS have minimum of 65,000 population), the census summary tables are close but not identical to the tables calculated with the ACS sample data. “In this way more densely populated areas, like Chicago and Cook County will contain many PUMAs within their boundaries, while multiple sparsely populated entire counties, e.g., Jackson, Perry, Franklin, and Williamson, will comprise one PUMA.” - IPUMS v other Geographies\n19 is Champaign, 31 is Cook, 37 is DeKalb, 43 is DuPage, 89 is Kane, 111 is McHenry, etc.\nEconomic Characteristics summary table: link\n\njoined %&gt;% \n  filter(CanWorkFromHome == \"Some WFH\") %&gt;% \n  distinct(OCCSOC)\n\n\n\n\nOCCSOC\n\n\n434051\n\n\n131199\n\n\n2310XX\n\n\n254022\n\n\n29112X\n\n\n414010\n\n\n1191XX\n\n\n252050\n\n\n211029\n\n\n132070\n\n\n131041\n\n\n1721YY\n\n\n439XXX\n\n\n119041\n\n\n113071\n\n\n131030\n\n\n519071\n\n\n172110\n\n\n192030\n\n\n172141\n\n\n21109X\n\n\n271010\n\n\n1910XX\n\n\n391000\n\n\n1940XX\n\n\n434XXX\n\n\n191020\n\n\n119121\n\n\n212099\n\n\n434041\n\n\n419099\n\n\n433021\n\n\n273011\n\n\n272012\n\n\n2590XX\n\n\n191010\n\n\n273023\n\n\n4330XX\n\n\n194010\n\n\n333021\n\n\n2911XX\n\n\n132020\n\n\n339021\n\n\n2740XX\n\n\n1940YY\n\n\n272041\n\n\n1720XX\n\n\n173031\n\n\n171020\n\n\n434031\n\n\n393010\n\n\n1320XX\n\n\n434YYY\n\n\n19204X\n\n\n192010\n\n\n291125\n\n\n273092\n\n\n172121\n\n\n119070\n\n\n1721XX\n\n\n451011\n\n\n\n\n\n\n\n\n\nRace\nGood example of graphing survey data. Make a summary table that has the WEIGHTED Freq and Prop of the variables of interest before passing it to graphing commands. Using svytable to make the weighted table.\n\n\nCode\ntable &lt;- svytable(~race_cat+YEAR+did_wfh_labels, design = dstrata) \n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, race_cat)%&gt;% # grouped by Year and Sex!!\n  mutate(Prop =round(n/sum(n), digits=4)) %&gt;%\n  arrange(did_wfh_labels, -n)\ntable\n\n\n\n\n  \n\n\n\nCode\ntable %&gt;% ggplot(aes(race_cat, y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) +\n # scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))+\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home by race: 2019 vs 2021\",\n       x = \"\", y = \"# of People\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") +    scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\")) +\n scale_y_continuous(labels = scales::comma)\n\n\n\n\n\nCode\ntable &lt;- svytable(~did_wfh_labels+YEAR+race_cat, design = dstrata) \n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, did_wfh_labels)%&gt;% # grouped by Year and Sex!!\n  mutate(Prop =round(n/sum(n), digits=4))\ntable\n\n\n\n\n  \n\n\n\nCode\ntable %&gt;% ggplot(aes(did_wfh_labels, y=n, fill = race_cat, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) +\n # scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))+\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home by race: 2019 vs 2021\",\n       x = \"\", y = \"# of People\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::comma)\n\n\n\n\n\nCode\ntable &lt;- svytable(~did_wfh_labels+YEAR+race_cat, design = dstrata) \n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% # grouped by Year and Sex!!\n  mutate(Prop =round(n/sum(n), digits=4))\n\ntable %&gt;% ggplot(aes(did_wfh_labels, y=n, fill = race_cat, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) +\n # scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))+\n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home by race: 2019 vs 2021\",\n       x = \"\", y = \"# of People\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::comma)\n\n\n\n\n\nCode\nsvyby(~did_wfh, by = ~RACE, design = dstrata2021, svymean, na.rm=TRUE)\n\n\n\n\n\nRACE\ndid_wfh\nse\n\n\n1\n0.207 \n0.00287\n\n\n2\n0.169 \n0.00732\n\n\n3\n0.0718\n0.0156 \n\n\n4\n0.353 \n0.0291 \n\n\n5\n0.195 \n0.0505 \n\n\n6\n0.261 \n0.0114 \n\n\n7\n0.0948\n0.00701\n\n\n8\n0.155 \n0.00719\n\n\n9\n0.173 \n0.028  \n\n\n\n\n\n\n\nCode\nsvyby(~INCEARN, by = ~RACE, design = dstrata2021, FUN = svymean, na.rm=TRUE)\n\n\n\n\n\nRACE\nINCEARN\nse\n\n\n1\n6.77e+04\n502       \n\n\n2\n4.47e+04\n952       \n\n\n3\n3.89e+04\n1.92e+03\n\n\n4\n8.44e+04\n5.35e+03\n\n\n5\n8.43e+04\n1.11e+04\n\n\n6\n7.43e+04\n1.9e+03 \n\n\n7\n3.85e+04\n741       \n\n\n8\n4.92e+04\n1.11e+03\n\n\n9\n4.29e+04\n3.98e+03\n\n\n\n\n\n\n\nCode\njoined %&gt;% crosstab_3way(x=YEAR, y=did_wfh, z=white, weight = PERWT)\n\n\n\n\n\nYEAR\nwhite\n0\n1\nn\n\n\n2019\n0\n96.6\n3.4\n1.65e+06\n\n\n2019\n1\n94.2\n5.8\n4.52e+06\n\n\n2021\n0\n83.4\n16.6\n2.13e+06\n\n\n2021\n1\n79.3\n20.7\n3.8e+06 \n\n\n\n\n\n\n\nCode\njoined %&gt;% crosstab_3way(x=YEAR, y=did_wfh, z=RACE, weight = PERWT)\n\n\n\n\n\nYEAR\nRACE\n0\n1\nn\n\n\n2019\nWhite\n94.2\n5.8 \n4.52e+06\n\n\n2019\nBlack/African American\n96.9\n3.13\n7.47e+05\n\n\n2019\nAmerican Indian or Alaska Native\n98.1\n1.92\n1.58e+04\n\n\n2019\nChinese\n95.5\n4.52\n7.09e+04\n\n\n2019\nJapanese\n95.1\n4.95\n9.36e+03\n\n\n2019\nOther Asian or Pacific Islander\n94.4\n5.57\n2.96e+05\n\n\n2019\nOther race, nec\n98.3\n1.66\n3.73e+05\n\n\n2019\nTwo major races\n95.6\n4.35\n1.26e+05\n\n\n2019\nThree or more major races\n94.9\n5.05\n1.15e+04\n\n\n2021\nWhite\n79.3\n20.7 \n3.8e+06 \n\n\n2021\nBlack/African American\n83.1\n16.9 \n6.5e+05 \n\n\n2021\nAmerican Indian or Alaska Native\n92.8\n7.18\n4.08e+04\n\n\n2021\nChinese\n64.7\n35.3 \n6.32e+04\n\n\n2021\nJapanese\n80.5\n19.5 \n8.95e+03\n\n\n2021\nOther Asian or Pacific Islander\n73.9\n26.1 \n3.09e+05\n\n\n2021\nOther race, nec\n90.5\n9.48\n4.66e+05\n\n\n2021\nTwo major races\n84.5\n15.5 \n5.66e+05\n\n\n2021\nThree or more major races\n82.7\n17.3 \n3.05e+04\n\n\n\n\n\n\n\nCode\n# joined %&gt;% crosstab_3way(x=YEAR, y=did_wfh, z=white, weight = PERWT) %&gt;% \n#   ggplot(aes(x=`1`, y=YEAR, fill = factor(white))) + \n#   geom_col(stat=\"identity\", position = \"fill\") + labs(title = \"Percent of White people that were able to work at home each year\")\n# \n# joined %&gt;% crosstab_3way(x=YEAR, y=did_wfh, z=black, weight = PERWT) %&gt;% \n#   ggplot(aes(x=`1`, y=YEAR, fill = factor(black))) + \n#   geom_col(stat=\"identity\", position = \"fill\") + labs( \"Percent of Black People that were able to work at home each year\")\n\n\ncrosstab(joined, x=RACE, y=did_wfh, weight = PERWT, unwt_n=TRUE, n=FALSE)\n\n\n\n\n\nRACE\n0\n1\nunweighted_n\n\n\nWhite\n87.4\n12.6 \n89387\n\n\nBlack/African American\n90.5\n9.55\n8751\n\n\nAmerican Indian or Alaska Native\n94.3\n5.71\n512\n\n\nChinese\n81  \n19   \n1203\n\n\nJapanese\n88  \n12   \n157\n\n\nOther Asian or Pacific Islander\n83.9\n16.1 \n5217\n\n\nOther race, nec\n94  \n6   \n5489\n\n\nTwo major races\n86.6\n13.4 \n5560\n\n\nThree or more major races\n86.1\n13.9 \n351\n\n\n\n\n\n\n\nCode\ncrosstab(joined, x=RACE, y=did_wfh, weight = PERWT, pct_type = \"column\", unwt_n=TRUE, n=FALSE)\n\n\n\n\n\nRACE\n0\n1\n\n\nWhite\n68.3  \n71.8  \n\n\nBlack/African American\n11.9  \n9.14 \n\n\nAmerican Indian or Alaska Native\n0.501\n0.222\n\n\nChinese\n1.02 \n1.75 \n\n\nJapanese\n0.151\n0.151\n\n\nOther Asian or Pacific Islander\n4.77 \n6.66 \n\n\nOther race, nec\n7.42 \n3.45 \n\n\nTwo major races\n5.64 \n6.38 \n\n\nThree or more major races\n0.34 \n0.401\n\n\n\n\n\n\n\nCode\ncrosstab(joined, x=did_wfh, y=RACE, weight = PERWT, pct_type = \"row\", unwt_n=TRUE, n=FALSE)\n\n\n\n\n\ndid_wfh\nWhite\nBlack/African American\nAmerican Indian or Alaska Native\nChinese\nJapanese\nOther Asian or Pacific Islander\nOther race, nec\nTwo major races\nThree or more major races\nunweighted_n\n\n\n0\n68.3\n11.9 \n0.501\n1.02\n0.151\n4.77\n7.42\n5.64\n0.34 \n102764\n\n\n1\n71.8\n9.14\n0.222\n1.75\n0.151\n6.66\n3.45\n6.38\n0.401\n13863\n\n\n\n\n\n\n\nCode\ncrosstab(joined, x=did_wfh, y=RACE, weight = PERWT)\n\n\n\n\n\ndid_wfh\nWhite\nBlack/African American\nAmerican Indian or Alaska Native\nChinese\nJapanese\nOther Asian or Pacific Islander\nOther race, nec\nTwo major races\nThree or more major races\nn\n\n\n0\n68.3\n11.9 \n0.501\n1.02\n0.151\n4.77\n7.42\n5.64\n0.34 \n1.06e+07\n\n\n1\n71.8\n9.14\n0.222\n1.75\n0.151\n6.66\n3.45\n6.38\n0.401\n1.46e+06\n\n\n\n\n\n\n\nCode\njoined %&gt;% filter(YEAR == 2021) %&gt;%\n  group_by(RACE) %&gt;%\n  summarize(Freq = n()) %&gt;%\n  mutate(Prop = Freq/sum(Freq))\n\n\n\n\n\nRACE\nFreq\nProp\n\n\n1\n43160\n0.715  \n\n\n2\n4683\n0.0775 \n\n\n3\n398\n0.00659\n\n\n4\n599\n0.00992\n\n\n5\n82\n0.00136\n\n\n6\n2867\n0.0475 \n\n\n7\n3442\n0.057  \n\n\n8\n4876\n0.0807 \n\n\n9\n285\n0.00472\n\n\n\n\n\n\n\nCode\nsvytable(~RACE, design=dstrata2021) %&gt;% \n  as.data.frame() %&gt;% # creates a frequency count by default?\n  mutate(Prop =Freq/sum(Freq))\n\n\n\n\n\nRACE\nFreq\nProp\n\n\n1\n3.98e+06\n0.634  \n\n\n2\n7.25e+05\n0.116  \n\n\n3\n4.33e+04\n0.0069 \n\n\n4\n6.52e+04\n0.0104 \n\n\n5\n9.01e+03\n0.00144\n\n\n6\n3.2e+05 \n0.051  \n\n\n7\n4.92e+05\n0.0784 \n\n\n8\n6.07e+05\n0.0967 \n\n\n9\n3.49e+04\n0.00556\n\n\n\n\n\n\n\nCode\ntopline(dstrata2019, RACE, weight = PERWT)\n\n\n\n\n\nResponse\nFrequency\nPercent\nValid Percent\nCumulative Percent\n\n\nWhite\n4.7e+06 \n72.9  \n72.9  \n72.9\n\n\nBlack/African American\n8.04e+05\n12.5  \n12.5  \n85.4\n\n\nAmerican Indian or Alaska Native\n1.69e+04\n0.262\n0.262\n85.7\n\n\nChinese\n7.37e+04\n1.14 \n1.14 \n86.8\n\n\nJapanese\n9.46e+03\n0.147\n0.147\n87  \n\n\nOther Asian or Pacific Islander\n3.06e+05\n4.75 \n4.75 \n91.7\n\n\nOther race, nec\n3.89e+05\n6.03 \n6.03 \n97.7\n\n\nTwo major races\n1.33e+05\n2.06 \n2.06 \n99.8\n\n\nThree or more major races\n1.31e+04\n0.203\n0.203\n100  \n\n\n\n\n\n\n\nCode\ntopline(dstrata2021, RACE, weight = PERWT)\n\n\n\n\n\nResponse\nFrequency\nPercent\nValid Percent\nCumulative Percent\n\n\nWhite\n3.98e+06\n63.4  \n63.4  \n63.4\n\n\nBlack/African American\n7.25e+05\n11.6  \n11.6  \n75  \n\n\nAmerican Indian or Alaska Native\n4.33e+04\n0.69 \n0.69 \n75.6\n\n\nChinese\n6.52e+04\n1.04 \n1.04 \n76.7\n\n\nJapanese\n9.01e+03\n0.144\n0.144\n76.8\n\n\nOther Asian or Pacific Islander\n3.2e+05 \n5.1  \n5.1  \n81.9\n\n\nOther race, nec\n4.92e+05\n7.84 \n7.84 \n89.8\n\n\nTwo major races\n6.07e+05\n9.67 \n9.67 \n99.4\n\n\nThree or more major races\n3.49e+04\n0.556\n0.556\n100  \n\n\n\n\n\n\n\nCode\n#svytotal(x = ~interaction(RACE, did_wfh_labels), design = dstrata2021, na.rm=TRUE)\n\n# need to create race variables before the dstrata survey object.\n#svytotal(x = ~interaction(white, did_wfh_labels), design = dstrata2021, na.rm=TRUE)\n\n\n\n\n\n\nAge\n\ntable(joined$AGE,joined$LABFORCE)\n\njoined%&gt;% filter(YEAR == 2021 & AGE&gt;64 & INCEARN &gt; 0) %&gt;% summary()\n# more then 75% of those under 18 make less than $5,000 a year.Not the kind of workers we are interested in anyways.  \n\n# Even more extreme for less than 17\n\ntable(joined$age_cat, joined$did_wfh_labels)\n\n\n\nInternet Access\nOther variables: CIHISPEED, CINETHH, MULTGEN, NCHILD, NCHLT5, MARST, FERTYR\n\nCINETHH reports whether any member of the household accesses the Internet. Here, “access” refers to whether or not someone in the household uses or connects to the Internet, regardless of whether or not they pay for the service.\nCIHISPEED reports whether the respondent or any member of their household subscribed to the Internet using broadband (high speed) Internet service such as cable, fiber optic, or DSL service.\n\n\n#10 is yes, 20 is no access. 00 is NA\ntable &lt;- svytable(~CIHISPEED +did_wfh_labels+YEAR, design = dstrata) \ntopline(dstrata2019, CIHISPEED, weight = PERWT)\n\n\n\n\nResponse\nFrequency\nPercent\nValid Percent\nCumulative Percent\n\n\nYes (Cable modem, fiber optic or DSL service)\n5.09e+06\n79.1 \n84.2\n84.2\n\n\nNo\n9.55e+05\n14.8 \n15.8\n100  \n\n\n(Missing)\n3.94e+05\n6.11\n  \n  \n\n\n\n\n\n\ntopline(dstrata2021, CIHISPEED, weight = PERWT)\n\n\n\n\nResponse\nFrequency\nPercent\nValid Percent\nCumulative Percent\n\n\nYes (Cable modem, fiber optic or DSL service)\n5.16e+06\n82.3 \n86.3\n86.3\n\n\nNo\n8.2e+05 \n13.1 \n13.7\n100  \n\n\n(Missing)\n2.88e+05\n4.59\n  \n  \n\n\n\n\n\n\ntable\n\n, , YEAR = 2019\n\n         did_wfh_labels\nCIHISPEED Did not WFH Did WFH\n       10     4613288  277027\n       20      878321   29514\n\n, , YEAR = 2021\n\n         did_wfh_labels\nCIHISPEED Did not WFH Did WFH\n       10     3871147 1027194\n       20      683274   82666\n\n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR, CIHISPEED)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;% \n  arrange(did_wfh_labels, -n)\ntable\n\n\n\n  \n\n\ntable %&gt;% ggplot(aes(factor(CIHISPEED, labels = c(\"Has high speed\", \"No high speed\")), y=Prop, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_fill(vjust=.5), size=3) + \n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home & Access to high speed Internet: 2019 vs 2021\",\n       x = \"\", y = \"\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::percent) +scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))\n\n\n\ntable %&gt;% ggplot(aes(factor(CIHISPEED, labels = c(\"Has high speed\", \"No high speed\")), y=n, fill = did_wfh_labels, group = YEAR)) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n  facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) + \n  theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home & Access to high speed Internet: 2019 vs 2021\",\n       x = \"\", y = \"\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") +scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))\n\n\n\n### Access to any type of internet ####\ntable &lt;- #dstrata %&gt;% factor(CIHISPEED,)\n  svytable(~CINETHH+did_wfh_labels+YEAR, design = dstrata) \ntable\n\n, , YEAR = 2019\n\n       did_wfh_labels\nCINETHH Did not WFH Did WFH\n      1     5491609  306541\n      2      109151    3768\n      3      249879    7865\n\n, , YEAR = 2021\n\n       did_wfh_labels\nCINETHH Did not WFH Did WFH\n      1     4554421 1109860\n      2       94608   19191\n      3      139909   11784\n\n# proportion of each respondant's sex and if they worked from home for each year in sample\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3))%&gt;% \n  arrange(did_wfh_labels, -n)\ntable\n\n\n\n  \n\n\ntable %&gt;% #filter(YEAR == 2021) %&gt;%\n  ggplot(aes(factor(CINETHH, labels = c(\"Has Own Access\", \"Has Other Access\", \"No Access\")), y=n, fill = did_wfh_labels,\n                     group = YEAR\n                     )) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n facet_wrap(~YEAR)+\n  geom_text(aes(label = scales::percent(as.numeric(ifelse(Prop&gt;0.05,Prop, \"\")), accuracy = .1),accuracy  = .1L ),position = position_stack(vjust=.5), size=3) +\n  theme_classic() + \n  theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home & Access to Internet: 2019 vs 2021\",\n       x = \"\", y = \"# of people\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::comma)+coord_flip() + scale_fill_manual(values = c(\"#a6bddb\", \"#2b8cbe\"))+\n   annotate(\"text\", label = \"&lt; 3% of labor force\", x = 2, y =1400000, size = 3, colour = \"black\")  + annotate(\"text\", label = \"&lt; 5% of labor force\", x = 3, y =1400000, size = 3, colour = \"black\")\n\n\n\ntable %&gt;% #filter(YEAR == 2021) %&gt;%\n  ggplot(aes(did_wfh_labels, y=n, fill = factor(CINETHH, labels = c(\"Has Own Access\", \"Has Other Access\", \"No Access\")),\n                     group = YEAR\n                     )) + \n  geom_col(stat = \"identity\", position = \"stack\") +\n facet_wrap(~YEAR)+\n    geom_text(aes(label = scales::percent(Prop)), position = position_stack(vjust=.5), size=3) + \n  theme_classic() + \n  theme(legend.position = \"bottom\", legend.title = element_blank())+\n  labs(title =\"Percent working from home & Access to Internet: 2019 vs 2021\",\n       x = \"\", y = \"# of People\",\n      caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::comma)+coord_flip()\n\n\n\n# table %&gt;% ggplot(aes(factor(CINETHH, labels = c(\"Has Own Access\", \"Has Other Access\", \"No Access\")), y=Prop, fill = did_wfh_labels, group = YEAR)) + \n#   geom_col(stat = \"identity\", position = \"fill\") +\n#   facet_wrap(~YEAR)+\n#     geom_text(aes(label = scales::percent(Prop)), position = position_fill(vjust=.5), size=3) + \n#   theme_classic() + theme(legend.position = \"bottom\", legend.title = element_blank())+\n#   labs(title =\"Percent working from home & Access to Internet: 2019 vs 2021\",\n#        x = \"\", y = \"\",\n#       caption = \"ACS 1 year samples for 2019 and 2021 used for weighted population estimates,\") + scale_y_continuous(labels = scales::percent)\n\n\n# Access at home AND access to high speed internet.\ntable &lt;- \n  svytable(~CIHISPEED+ CINETHH+did_wfh_labels+YEAR, design = dstrata) \ntable\n\n, , did_wfh_labels = Did not WFH, YEAR = 2019\n\n         CINETHH\nCIHISPEED       1\n       10 4613288\n       20  878321\n\n, , did_wfh_labels = Did WFH, YEAR = 2019\n\n         CINETHH\nCIHISPEED       1\n       10  277027\n       20   29514\n\n, , did_wfh_labels = Did not WFH, YEAR = 2021\n\n         CINETHH\nCIHISPEED       1\n       10 3871147\n       20  683274\n\n, , did_wfh_labels = Did WFH, YEAR = 2021\n\n         CINETHH\nCIHISPEED       1\n       10 1027194\n       20   82666\n\ntable &lt;- table %&gt;% \n  as_tibble() %&gt;% \n  group_by(YEAR)%&gt;% \n  mutate(Prop =round(n/sum(n), digits=3)) %&gt;% \n  arrange(YEAR, did_wfh_labels)\ntable\n\n\n\n  \n\n\ncrosstab_3way(joined, YEAR, CIHISPEED, CINETHH, weight = PERWT, unwt_n = TRUE)\n\n\n\n\nYEAR\nCINETHH\nYes (Cable modem, fiber optic or DSL service)\nNo\nn\nunweighted_n\n\n\n2019\nYes, with a subscription to an Internet Service\n84.2\n15.8\n6.05e+06\n58332\n\n\n2021\nYes, with a subscription to an Internet Service\n86.3\n13.7\n5.98e+06\n57808\n\n\n\n\n\n\n\nIn 2019, an estimated 277,000 people worked from home and had highspeed internet and 29,500 did not have high speed internet .\nIn 2021, an estimated1,027,000 people worked from home and had high speed internet and 83,000 did not have high speed internet.\n\nThere is a chance that people realized that their internet was not as fast as they thought it was when they had multiple people using the internet at the same time during COVID-19.\n\n\ntable(joined$NCHILD)\n\n\n    0     1     2     3     4     5     6     7     8     9 \n70975 21828 19138  7485  1986   463   119    35    17    17 \n\ntable(joined$NCHLT5)\n\n\n     0      1      2      3      4      5 \n108636   9881   3201    327     16      2"
  },
  {
    "objectID": "WFH_geographicComparison.html#puma-level",
    "href": "WFH_geographicComparison.html#puma-level",
    "title": "Work From Home: Who Can and Who Does?",
    "section": "PUMA Level",
    "text": "PUMA Level\nPUMAs contain around 100,000 people.\nFor the counties that can be identified in the data (populations &gt; 100,000 & &lt; 200,000. 1-Year ACS have minimum of 65,000 population), the census summary tables are close but not identical to the tables calculated with the ACS sample data. “In this way more densely populated areas, like Chicago and Cook County will contain many PUMAs within their boundaries, while multiple sparsely populated entire counties, e.g., Jackson, Perry, Franklin, and Williamson, will comprise one PUMA.” - IPUMS v other Geographies\n\n\nobs_perPUMA&lt;- joined %&gt;% \n   group_by(PUMA, YEAR) %&gt;% \n   dplyr::summarize(weightedcount=sum(PERWT), #weighted \n                    unweightedcount = n()) %&gt;%\n  arrange(unweightedcount)\n### Minimimum observations are 271 in PUMA area 03528\nobs_perPUMA\n\n\n\n  \n\n\n\n\njoined %&gt;% \n   group_by(county_pop_type, YEAR, did_wfh_labels) %&gt;% \n   dplyr::summarize(weightedcount=sum(PERWT), #weighted \n                    unweightedcount = n()) %&gt;% \n   mutate(pct_weight = weightedcount/sum(weightedcount), \n          pct_noweight = unweightedcount/sum(unweightedcount)) %&gt;% arrange(unweightedcount)\n\n\n\n  \n\n\n\nEconomic Characteristics summary table: link\n\n# PUMA shapefiles\npumasIL &lt;- pumas(\"IL\", cb=T, year=2019)\n\n#pumasIL %&gt;% select(PUMACE10, GEOID10, NAME10) %&gt;% write_csv(\"PUMAsIL.csv\")\n#county shapefiles\ncountyIL &lt;- counties(\"IL\", cb=T, year=2019)\n\n#pumasdf &lt;- fortify(pumasIL, region = 'PUMACE10')\n\n\nDid WFH\n\nmapPUMAboth &lt;- svytable(~YEAR+PUMA+did_wfh_labels, design = dstrata)\nmapPUMAboth &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     filter(did_wfh_labels == \"Did WFH\") %&gt;%\n     full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\"))\n\n\nfigure5a &lt;- mapPUMAboth %&gt;% \n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Where Did People Work from Home?\", \n      # subtitle = \"Percent of PUMA population in 2019 & 2021 that did WFH\"\n      ) +\n  theme_classic() + \n  theme(axis.ticks = element_blank(), axis.text = element_blank())+\n   scale_fill_steps2(\n                         high = \"darkblue\", low = \"black\", \n\n                       limits = c(0,.6),\n                       n.breaks =4,\n                       show.limits=TRUE,\n                       nice.breaks=FALSE,\n\n                        name = \"Percent of Workers\", \n                       label = scales::percent)+\n  facet_wrap(~YEAR) \n \nmapPUMAboth %&gt;% select(YEAR, PUMA, Prop, n, NAME10)\n\n\n\n  \n\n\n\n\nmapPUMAboth &lt;- svytable(~YEAR+PUMA+did_wfh_labels, design = dstrata)\n\nmapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     filter(did_wfh_labels == \"Did WFH\") %&gt;%\n  pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n    mutate(pct_change= `2021`-`2019`) %&gt;%\n       full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\"))%&gt;%\n  arrange(-pct_change) %&gt;% select(-c(STATEFP10:GEOID10)) %&gt;% head()\nmapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     filter(did_wfh_labels == \"Did WFH\") %&gt;%\n  pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n    mutate(pct_change= `2021`-`2019`) %&gt;%\n       full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\"))%&gt;%\n  arrange(pct_change) %&gt;% select(-c(STATEFP10:GEOID10)) %&gt;% head()\n\n\n\n\n\n  \n\n\n\n\n\n  \n\n\n\n\n\n\n\nCode\nfigure5b &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     filter(did_wfh_labels == \"Did WFH\") %&gt;%\n  pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n    mutate(pct_change= `2021`-`2019`) %&gt;%\n       full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\")) %&gt;%\n  ggplot(aes(fill = pct_change)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Change in Population that Did Work from Home\", \n       subtitle = \"2019 vs 2021\", \n       caption = \n         \"The did_WFH variable based on TRANWORK==80 from\n         ACS 2019 & 2021 1-Year Survey individual level data. \n       Each geographic region has between 100K and 200K people. \") +\n  theme_classic() + \n  theme(axis.ticks = element_blank(), axis.text = element_blank())+\n  \n     scale_fill_steps2(#colors = c(\"white\", \"darkblue\"), \n                         high = \"darkblue\", low = \"black\", \n\n                       limits = c(0,.6),\n                       n.breaks =4,\n                       show.limits=TRUE,\n                       nice.breaks=FALSE,\n\n                        name = \"% change in WFH\", \n                       label = scales::percent)\n\n\ncloseupFIPs&lt;- c(\"097\", \"111\", \"089\",\"043\", \"197\", \"031\"#,\"093\"\n             #   ,\"007\"\n                )\n\n\n\nmapPUMAboth &lt;- svytable(~YEAR+countyFIP+PUMA+\n                          did_wfh_labels, design = dstrata)\n\nmapPUMAboth &lt;- mapPUMAboth %&gt;% \n  as_tibble() %&gt;%\n  filter(countyFIP %in% closeupFIPs) %&gt;%\n\n  group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     filter(did_wfh_labels == \"Did WFH\" & n != \"0\") %&gt;%\n     inner_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\"))\n \n#mapPUMAboth %&gt;% select(YEAR, countyFIP, PUMA, Prop, n, NAME10)\n\n\n\n\ncountyborders&lt;- countyIL %&gt;% \n  filter(COUNTYFP %in% closeupFIPs)\n#countyborders\n\n\nfigure5c &lt;- ggplot(mapPUMAboth, aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n # labs(title = \"Where Did People Work from Home?: Close up View\", \n  #     subtitle = \"Percent of PUMA population in 2019 & 2021 that did WFH\") +\n  theme_classic() + \n  theme(axis.ticks = element_blank(), axis.text = element_blank())+\n\n     scale_fill_binned(#colors = c(\"white\", \"darkblue\"), \n                         high = \"darkblue\", low = \"white\", \n\n                       limits = c(0,.6),\n                       n.breaks =4,\n                       show.limits=TRUE,\n                       nice.breaks=FALSE,\n\n                        name = \"% that did WFH\",\n                       label = scales::percent)+\n  facet_wrap(~YEAR) \n\nfigure5c &lt;- figure5c +\n  geom_sf(data = countyborders, fill=NA, color=\"black\", lwd = 1) + theme_classic()+\n  theme(axis.ticks = element_blank(), axis.text = element_blank())+ facet_wrap(~YEAR)\n\n\n\n# as a dot graph ## \nmapPUMAboth &lt;- svytable(~YEAR+PUMA+did_wfh_labels, design = dstrata)\n\nmapPUMAboth &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     filter(did_wfh_labels == \"Did WFH\") %&gt;%\n     full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\"))\n\norder &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n filter(YEAR == 2021  & did_wfh_labels == \"Did WFH\") %&gt;% \n    filter(Prop &gt; 0.25 | Prop &lt; 0.1) %&gt;%\n  select(NAME10, Prop_2021 = Prop)\n\nmapPUMAboth &lt;- inner_join(mapPUMAboth, order) %&gt;% filter()\n\nmapPUMAboth %&gt;% \n  ungroup() %&gt;%\n  filter(#did_wfh_labels == \"Did WFH\" #& NAME10 != \"NA\" & YEAR != \"NA\"\n         )%&gt;% \n # filter(YEAR == 2021 & (Prop &gt; 0.25 | Prop &lt; 0.1) ) %&gt;%\n  select(NAME10, PUMA, Prop) %&gt;% \n  distinct() %&gt;% arrange(desc(Prop)) %&gt;% head()\n\n\n\n\n\nNAME10\nPUMA\nProp\n\n\nChicago City (North)--Lake View & Lincoln Park\n03502\n0.519\n\n\nChicago City (Central)--Near North Side, Loop & Near South Side\n03525\n0.447\n\n\nChicago City (West)--West Town, Near West Side & Lower West Side\n03524\n0.439\n\n\nChicago City (North)--Edgewater, Uptown & Rogers Park\n03501\n0.367\n\n\nLake County--Vernon, Moraine, West Deerfield & Libertyville (Southeast) Townships\n03310\n0.366\n\n\nChicago City (Northwest)--Logan Square, Avondale & Hermosa\n03522\n0.363\n\n\n\n\n\n\n\nCode\nfigure5d &lt;- mapPUMAboth %&gt;%\n  filter(did_wfh_labels == \"Did WFH\" #& NAME10 != \"NA\" & YEAR != \"NA\"\n         )%&gt;% \n  filter(Prop &gt; 0.25 | Prop &lt; 0.1) %&gt;%\n  ggplot(aes(x = Prop*100, y= reorder(PUMA, Prop_2021*100)))+\n  geom_line(aes(group = PUMA))+\n  theme_classic()+\n   geom_point(aes(color=YEAR), size = 3) +\n      scale_color_brewer(palette=\"Paired\", labels = c(\"% WFH in 2019\", \"% WFH in 2021\"), direction = 1)+\n  labs(title = \"Change in PUMA Labor Force that did WFH\",\n       subtitle = \"Percent of Labor Force within PUMA that Did Work from Home\", \n#  caption = \"Graph includes PUMAs with Proportions of WFH Workers greater \n#  than 25% or less than 10%. Filtered PUMAs to increase legibility. \n#  DuPage had around 8% of the labor force working from home in 2019 and \n#  around 27% of its labor force working from home in 2021. \n#       There was ~20 percentage point increase between 2019 and 2021 for DuPage County. \n#  Working from home is based on TRANWORK variable from ACS 1-year surveys.\", \nx = \"Percentage Points\", y = \"\" \n)\n\n\nmapPUMAboth &lt;- svytable(~YEAR+PUMA+countyFIP+did_wfh_labels, design = dstrata)\n\nfigure5e &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n    filter(countyFIP %in% closeupFIPs) %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     filter(did_wfh_labels == \"Did WFH\" & n != \"0\") %&gt;%\n  pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n    mutate(pct_change= `2021`-`2019`) %&gt;%\n       inner_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\")) %&gt;%\n\n  ggplot(aes(fill = pct_change)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Change in Population that Did Work from Home\", \n       subtitle = \"2019 vs 2021\") +\n  theme_classic() + \n  theme(axis.ticks = element_blank(), axis.text = element_blank()) +\n    scale_fill_steps2( high = \"darkblue\", low = \"black\", \n                       limits = c(0,.6),\n                       n.breaks =4,\n                       show.limits=TRUE,\n                       nice.breaks=FALSE,\n\n                        name =\" Pct Pt change  that did WFH\",\n                       label = scales::percent)\n\n\n\n\n\n\n\n\nThe did_WFH variable is based on TRANWORK==80 from ACS 2019 & 2021 1-Year Survey individual level data. Each geographic region has between 100K and 200K people.\n\n\n\n\n\n\n\nZoom in on Cook and Surrounding Counties\n\n\n\n\n\n\nPercent of Workers who Did Work From Home: 2019 & 2021\n\n\n\n\n\n\n\n\n\nGraph includes PUMAs with Proportions of WFH Workers greater than 25% or less than 10%. Filtered PUMAs to increase legibility. DuPage had around 8% of the labor force working from home in 2019 and around 27% of its labor force working from home in 2021. There was ~20 percentage point increase between 2019 and 2021 for DuPage County. Working from home is based on TRANWORK variable from ACS 1-year surveys.\n\n\n\n\n\n\n\nA dot plot of change\n\n\n\n\n\n\nChange from 2019 to 2021 in who did WFH\n\n\n\n\n\nWFH Feasibility\nWe compute these shares using our O*NET-derived classification of occupations that can be done at home and the occupational composition using ACS responses in each PUMA by 6-digit SOC in the BLS’s 2018 Occupational Employment Statistics.\n\nmapPUMAboth &lt;- svytable(~YEAR+PUMA+CanWorkFromHome, design = dstrata)\nmapPUMAboth &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     filter(CanWorkFromHome == \"Can WFH\") %&gt;%\n     full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\"))\n \nmapPUMAboth %&gt;%\nggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry=geometry), color = \"black\")+ \n  labs(title = \"Percent of PUMA area population that COULD work from home\", \n       subtitle = \" based on occupation characteristics: 2019 vs 2021\", \n       caption = \"Teleworkability based on D&N 2020 methodology. \n       OCCSOC codes from ACS 1 year Survey data at individual level.\") +\n  theme_classic() + \n  theme(axis.ticks = element_blank(), axis.text = element_blank())+\n  scale_fill_steps2(#colors = c(\"white\", \"darkblue\"), \n                         high = \"darkblue\", low = \"black\", \n\n                       limits = c(0,.6),\n                       n.breaks =4,\n                       show.limits=TRUE,\n                       nice.breaks=FALSE,\n                        name = \"% Potentially Could WFH\", \n                       label = scales::percent) +\n  facet_wrap(~YEAR)\nFigure2b &lt;- mapPUMAboth %&gt;%\nfilter(YEAR == 2021)%&gt;%  \n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  # labs(title = \"Work from Home Feasibility Rate\", \n  #      subtitle = \" Based on Occupation Characteristics\", \n  #      caption = \"Teleworkability based on D&N 2020 methodology. \n  #      OCCSOC codes from ACS 1 year Survey data at individual level.\") +\n  theme_void() + \n  theme(axis.ticks = element_blank(), axis.text = element_blank(),   \n        plot.title = element_text(hjust = 0.5), plot.caption = element_text(hjust=.5),  plot.subtitle = element_text(hjust = 0.5)) +\n                           scale_fill_steps2(#colors = c(\"white\", \"darkblue\"), \n                         high = \"darkblue\", low = \"black\", \n\n                       limits = c(0,.6),\n                       n.breaks =4,\n                       show.limits=TRUE,\n                       nice.breaks=FALSE,\n                        name = \"Labor force with\\nWFH Feasibility\", label = scales::percent)\nFigure2b\n#ggsave(Figure2b, \"Figure2bV2.png\", width=3, height=3, units = \"in\")\n\n\n\n\n\n\n\n\n\n\n\n\n\nInternet Access\nMake a subset of dstrata that only includes people who answered the TRANWORK/ did_WFH questions.\n\n\nCode\n## CINETHH is for access to internet \n# (either at home, somewhere else, or no access)\n# from joined dataframe. Not using survey objects or survey package\nmapPUMAboth &lt;- joined %&gt;% \n   group_by(YEAR, PUMA, CINETHH) %&gt;% \n   dplyr::summarize(weightedcount=sum(PERWT), #weighted \n                    unweightedcount = n()) %&gt;% \n   mutate(pct_weight = weightedcount/sum(weightedcount), \n          pct_noweight = unweightedcount/sum(unweightedcount))%&gt;%\n  full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\")) \nmapPUMAboth\n## identical to graph below made using svytable()\n# mapPUMAboth %&gt;%\n#   filter(CINETHH ==3) %&gt;% \n#   ggplot(aes(fill = pct_weight)) +\n#   geom_sf(aes(geometry = geometry), color = \"black\")+ \n#     scale_fill_continuous(low = \"gray\", high = \"red\", name = \"% of Population\", label = scales::percent)+\n#     theme_minimal()+\n#     theme(legend.title = element_blank(), axis.text.x = element_blank(), axis.text.y = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position=\"right\")+\n#   labs(title = \"Percent of population that did NOT have access to Internet\", \n#        subtitle = \"Geography = PUMAs\", \n#        ) +   theme(legend.title = element_blank())+\n#  scale_fill_gradientn(colors = c(\"white\", \"red4\"), \n#                     #   limits = c(-.1,.1),\n#                        n = 7,\n#                         name = \"Change in Access\", label = scales::percent)+\n#   facet_wrap(~YEAR)\n\n\n\n## Access internet using survey objects\nmapPUMAboth &lt;- svytable(~YEAR+PUMA+CINETHH, design = HHdesign)\n\nmapPUMAboth &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%   \n     full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\"))\n\nmapPUMAboth %&gt;%\n  filter(CINETHH == 3 ) %&gt;% \n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+   \n  scale_fill_binned(low = \"white\", high = \"red4\", name = \"% of Population\", label = scales::percent,\n                    n.breaks=4,nice.breaks=FALSE,show.limits=TRUE)+\n  labs(title = \"Percent of population that lacked access to Internet\", \n       caption = \"Geography = PUMAs. Includes all dstrata responses for CINETHH.\n       Does not subset for people who answered the commuting or occsoc questions.\") + \n  facet_wrap(~YEAR) +  theme_minimal()+\n    theme(legend.title = element_blank(), axis.text.x = element_blank(), axis.text.y = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position=\"right\")\n# mapPUMAboth %&gt;%   \n#   select(YEAR,Prop,CINETHH,geometry) %&gt;%\n#   filter(CINETHH ==3) %&gt;% \n#   pivot_wider( names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n#   mutate(pct_change = `2021`-`2019`) %&gt;%\n#   ggplot(aes(fill = pct_change)) +\n#   geom_sf(aes(geometry = geometry), color = \"black\")+ \n#   theme_minimal()+\n#     theme(legend.title = element_blank(), axis.text.x = element_blank(), axis.text.y = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position=\"right\")+\n#                            scale_fill_gradientn(colors = c(\"green4\", \"white\", \"red4\"), \n#                        limits = c(-.15,.15),\n#                        n = 7,\n#                         name = \"Change in Access\", label = scales::percent)+\n#   labs(title = \"Decrease in Lack of Internet Access\", \n#        subtitle = \"Needs to be flipped so not double negative\",\n#        caption = \"Rural areas were more likely to increase their access to internet at home. \n#        Change in Percentage points = 2021 % - 2019 %.\n#        Access to internet at home or another location is considered having Access to internet\")\n\nmapPUMAboth %&gt;%   \n  filter(CINETHH ==1) %&gt;% \n  pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n  mutate(pct_change = `2021`-`2019`) %&gt;%\n  ggplot(aes(fill = pct_change)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  theme_minimal()+\n  theme(legend.title = element_blank(), axis.text.x = element_blank(), axis.text.y = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), legend.position=\"right\")+\n  scale_fill_steps2(low=\"red4\", mid= \"white\", high= \"forestgreen\", \n                 #   limits = c(-.15,.15),\n                    n.breaks=4,\n                    show.limits=TRUE,\n                    nice.breaks=FALSE,\n                    name = \"Chance in Access\", label = scales::percent)+\n  labs(title = \"Change in Labor Force with Internet at home\",\n       subtitle = \"2019 to 2021\") \n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHigh Speed Internet\nHigh speed internet is not the best measurement of due to them including DSL in their definition of “high speed.”\nFCC standards say minimum 25Mbps for download and 3Mbps for upload. “traditionally, the way to determine if a connection is high speed is to test its ability to connect multiple devices that allow streaming and access to modern applications at the same time.\nHigh speed internet allows teleworkers the ability to live and work in locations of their choosing without commuting to work. Also important for education, especially during COVID and online classes. Many families did not have the bandwidth necessary to support someone working from home and having children in online classes at the same time (let alone multiple children in online classes).\nThe Infrastructure Investment and Jobs Act (IIJA) defines “underserved” broadband as an Internet speed &lt; 100 Mbps downstream and 20Mbps upstream.\nZoom needs between 2 and 3 Mbps for group video calls that look good.\n1.0 Mbps to 1.5 Mbps for lower quality video calls that should still work.\nSource\n\n\n\n\n\n\n\nFor areas that had a decrease in access to high speed internet: Is it possible that they realized that their internet sucked when multiple people tried to use it? Most people didn’t know internet speeds before the pandemic. They thought they had high speed internet precovid and then when multiple people were at home, they realized they didn’t have enough bandwith for their internet demand?\n\n\n\n\n\n\nCode\n### Access to Hi speed internet ###\n\n# from joined dataframe. Not using survey objects or survey package\nmapPUMAboth &lt;- joined %&gt;% \n   group_by(county_pop_type, YEAR, PUMA, CIHISPEED) %&gt;% \n   dplyr::summarize(weightedcount=sum(PERWT), #weighted \n                    unweightedcount = n()) %&gt;% \n   mutate(pct_weight = weightedcount/sum(weightedcount), \n          pct_noweight = unweightedcount/sum(unweightedcount))%&gt;%\n  full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\")) \nmapPUMAboth\n\n\n\n\n  \n\n\n\n\n## Access to Hi speed internet using survey objects\nmapPUMAboth &lt;- svytable(~YEAR+PUMA+CIHISPEED, design = HHdesign)\n\nmapPUMAboth &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, PUMA) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n     full_join(pumasIL, by = c(\"PUMA\" = \"PUMACE10\"))\n\nmapPUMAboth %&gt;%\n  filter(CIHISPEED == 10) %&gt;% \n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Percent of population WITH High Speed Internet\", \n       subtitle = \"\", caption = \"Each PUMA has &gt;100K & &lt; 200K people.\") + \n  facet_wrap(~YEAR)+\n scale_fill_binned(low =\"white\", high =\"forestgreen\", \n                       n.breaks = 4,\n                   show.limits = TRUE,\n                  # nice.breaks =FALSE,\n                        name = \"Population %\", label = scales::percent)+Alea_theme()\n\n\n\nmapPUMAboth %&gt;% pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n  mutate(pct_change = `2021`-`2019`) %&gt;%\n  ggplot(aes(fill = pct_change)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Change in Access to High Speed Internet\",\n       subcaption = \"2019 to 2021\",\n       caption = \"Percentage point change:\n       2021 PUMA% with CIHISPEED=10 - 2019 PUMA% \n       for ACS variable CIHISPEED=10.\") +\n  scale_fill_steps2(high = \"forestgreen\", mid =  \"white\",  low = \"red4\", \n                       n.breaks=4,\n                  nice.breaks = FALSE,\n                  show.limits = TRUE,\n                        name = \"Change in Access\", label = scales::percent) + Alea_theme()\n\n\n\n\n\n\nFigure 1: ?(caption)\n\n\n\n\n\n\n\nFigure 2: ?(caption)"
  },
  {
    "objectID": "WFH_geographicComparison.html#county-level",
    "href": "WFH_geographicComparison.html#county-level",
    "title": "Work From Home: Who Can and Who Does?",
    "section": "County Level",
    "text": "County Level\n19 is Champaign, 31 is Cook, 37 is DeKalb, 43 is DuPage, 89 is Kane, 111 is McHenry, etc.\n\nInternet Access\n\n## Access internet using survey objects\nmapPUMAboth &lt;- svytable(~CINETHH+YEAR+countyFIP, design = HHdesign)\n\nmapPUMAboth &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, countyFIP) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n   # filter(CINETHH == 3 ) %&gt;% \n     full_join(countyIL, by = c(\"countyFIP\" = \"COUNTYFP\"))\n\nmapPUMAboth %&gt;%\n      filter(CINETHH == 3 ) %&gt;% \n\n  filter(YEAR != \"NA\") %&gt;%\n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Percent of population that lacked access to Internet\", \n       caption = \"Geography = Counties with populations &gt; ~60K\") + \n  facet_wrap(~YEAR)  +\n    theme(legend.title = element_blank())+\n  scale_fill_steps2( low =  \"white\",  high = \"red4\", \n                       n.breaks=4,\n                  nice.breaks = FALSE,\n                  show.limits = TRUE,\n                        \"Population %\", label = scales::percent) + Alea_theme()\n### Change in LACK OF ACCESS\nmapPUMAboth %&gt;% \n  pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n  mutate(pct_change = `2021`-`2019`) %&gt;%\n  ggplot(aes(fill = pct_change)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Change in access to Internet\",\n       caption = \"Change in Percentage points = 2021 % lacking access - 2019 % lacking access.\n       Uses CINETHH == 3 for not having internet access. A decrease is a good thing!\" ) +\n  scale_fill_steps2(low = \"forestgreen\", mid =  \"white\",  high = \"red4\", \n                       n.breaks=5,\n                 # nice.breaks = FALSE,\n                  show.limits = TRUE,\n                        name = \"Change in Access\", label = scales::percent) + Alea_theme()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n### Access to Hi speed internet ###\n\n# from joined dataframe. Not using survey objects or survey package\n# mapPUMAboth &lt;- joined %&gt;% \n#    group_by(YEAR, countyFIP, CINETHH) %&gt;% \n#    dplyr::summarize(weightedcount=sum(PERWT), #weighted \n#                     unweightedcount = n()) %&gt;% \n#    mutate(pct_weight = weightedcount/sum(weightedcount), \n#           pct_noweight = unweightedcount/sum(unweightedcount))%&gt;%   \n#   filter(CINETHH ==3) %&gt;% \n#   full_join(countyIL, by = c(\"countyFIP\" = \"COUNTYFP\")) \n# mapPUMAboth\n# \n# mapPUMAboth %&gt;%\n#   ggplot(aes(fill = pct_weight)) +\n#   geom_sf(aes(geometry = geometry), color = \"black\")+ \n#   labs(title = \"Percent of population that did NOT have access to Internet\", \n#        subtitle = \"Geography = County\", \n#        ) +  \n#   Alea_theme() +theme(legend.title = element_blank())+\n#   scale_fill_gradientn(colors = c( \"white\", \"red4\"), \n#                        n = 5,\n#                         name = \"Population %\", label = scales::percent)+facet_wrap(~YEAR)\n\n\n\n\n\n## Access to High speed internet using survey objects\nmapPUMAboth &lt;- svytable(~YEAR+countyFIP+CIHISPEED, design = HHdesign)\n\nmapPUMAboth &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, countyFIP) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n    filter(CIHISPEED != 20 )  %&gt;%   full_join(countyIL, by = c(\"countyFIP\" = \"COUNTYFP\")) \n\n\nmapPUMAboth %&gt;%\n  filter(CIHISPEED == 10) %&gt;%\n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Percent of population with High-speed Internet\"  ) + \n  facet_wrap(~YEAR)+\n  scale_fill_binned(low  = \"white\", high = \"green4\", \n                    na.value = NA,\n                    n.breaks = 4,\n                    show.limits=TRUE,\n                    nice.breaks = FALSE,\n                    name = \"Percent of Population\", label = scales::percent)+ Alea_theme()\nmapPUMAboth %&gt;% pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n  mutate(pct_change = `2021`-`2019`) %&gt;%\n  ggplot(aes(fill = pct_change)) +\n  geom_sf(aes(geometry = geometry), color = \"black\") + \n  theme_void()+ \n   scale_fill_steps2(low =\"red4\", mid= \"white\", high = \"forestgreen\", \n                       n.breaks = 7,\n                     na.value=\"gray\",\n                   #  nice.breaks=FALSE,\n                     show.limits = TRUE,\n             #          limits = c(-.2,.2),\n                        name = \"Percent of Population\", label = scales::percent)#+labs(title = \"Change in access to High Speed Internet\")\nggsave(\"Figure7bV2.png\", limitsize = FALSE, width = 5, height = 4, units = \"in\")\n\n#ggsave(\"Figure7b.eps\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n#ggsave(\"Figure7b.pdf\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# as a bar graph ## \nmapPUMAboth %&gt;%\n  filter(YEAR==2021) %&gt;%\nggplot(aes(group = countyFIP)) +\n  geom_bar(aes(y = Prop, x= reorder(NAME, Prop)), stat = \"identity\") +\n  #Alea_theme() + \n  labs(title = \"Proportion with High Speed Internet\", subtitle = \"In 2021\", x = \"\", y = \"\" )+\n  coord_flip()\n# as a dot graph ## \n\norder &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n filter(YEAR == 2019 & NAME != \"NA\" & CIHISPEED == \"10\") %&gt;% \n  select(NAME, Prop_2019= Prop)\n\nmapPUMAboth &lt;- left_join(mapPUMAboth, order)\n\nmapPUMAboth %&gt;%\n  filter(NAME != \"NA\" & YEAR != \"NA\")%&gt;%\n  ggplot(aes(x = Prop, y= reorder(NAME, Prop_2019)))+\n  geom_line(aes(group = NAME))+\n   geom_point(aes(color=YEAR), size = 3) +\n  theme_minimal() + \n  theme(legend.position = \"none\", legend.title = element_blank(),\n               plot.title.position = \"plot\",\n     #   panel.background = element_rect(fill='transparent'), #transparent panel bg\n    plot.background = element_rect(fill='transparent', color=NA) #transparent plot bg\n   )+\n        scale_color_brewer(palette=\"Paired\", labels = c(\"2019\", \"2021\"), direction = 1)+\n\n  labs(title = \"Change in Access to High-speed Internet\", x = \"\", y = \"\" ) +\n  scale_x_continuous(label = scales::percent)\nggsave(\"Figure7v2.png\", limitsize = FALSE, width = 5, height = 4, units = \"in\")\n\n#ggsave(\"Figure7.eps\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n#ggsave(\"Figure7.pdf\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDid work from home\n\n\nCode\nmapPUMAboth &lt;- svytable(~did_wfh_labels+YEAR+countyFIP, design = dstrata)\n\nmapPUMAboth &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, countyFIP) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n  full_join(countyIL, by = c(\"countyFIP\" = \"COUNTYFP\"))\n\nmapPUMAboth %&gt;%\n      filter(did_wfh_labels == \"Did WFH\") %&gt;%\n\n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Percent of Labor  Force that Worked from Home\", \n       caption = \"Geography = Counties with populations &gt; ~60K\") + \n  facet_wrap(~YEAR)  +\n scale_fill_binned(low= \"white\", high =\"darkblue\", \n                   na.value = \"gray\",\n                   show.limits=TRUE,\n                       n.breaks = 4,\n                        name = \"Population %\", label = scales::percent) + Alea_theme()\nmapPUMAboth %&gt;% pivot_wider(id_cols = -c(n), names_from =\"YEAR\", values_from = \"Prop\") %&gt;%\n  mutate(pct_change = `2021`-`2019`) %&gt;%\n  ggplot(aes(fill = pct_change)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ Alea_theme()+ \n scale_fill_binned(low= \"white\", high =\"darkblue\", \n                   na.value = \"gray\",\n                   show.limits=TRUE,\n                   nice.breaks=FALSE,\n                       n.breaks = 4,\n                       limits = c(0,.20),\n                        name = \"Percentage Point\\nIncrease\", label = scales::percent)#+\n # labs(title = \"Percentage Point Change in Labor Force that Did WFH\")\n\nggsave(\"Figure4bV2.eps\", limitsize = FALSE, width = 8, height = 5, units = \"in\")\nggsave(\"Figure4bV2.pdf\", limitsize = FALSE,width = 8, height = 5, units = \"in\")\nggsave(\"Figure4bV2.png\", limitsize = FALSE, width = 8, height = 5, units = \"in\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\n# as a dot graph ## \norder &lt;- mapPUMAboth %&gt;% as_tibble() %&gt;%\n filter(YEAR == 2021 & did_wfh_labels == \"Did WFH\") %&gt;% \n  select(countyFIP, Prop_2021 = Prop)\n\nmapPUMAboth &lt;- left_join(mapPUMAboth, order)\n\n\nmapPUMAboth %&gt;%\n  filter(did_wfh_labels == \"Did WFH\" & NAME != \"NA\" & YEAR != \"NA\")%&gt;%\n  ggplot(aes(x = Prop*100, y= reorder(NAME, Prop_2021*100)))+\n  geom_line(aes(group = NAME))+\n  theme_classic()+\n   geom_point(aes(color=YEAR), size = 3) +\n      scale_color_brewer(palette=\"Paired\",\n                         # labels = c(\"% WFH in 2019\", \"% WFH in 2021\"), \n                         direction = 1)+\n  labs(title = \"Change in County Labor Force that did WFH\",\n#  caption = \"DuPage had around 8% of the labor force working from home in 2019 and \n#  around 27% of its labor force working from home in 2021. \n#       There was ~20 percentage point increase between 2019 and 2021 for DuPage County. \n#  Working from home is based on TRANWORK variable from ACS 1-year surveys.\", \nx = \"Labor force that WFH (%)\", \ny = \"\" \n)#+  scale_x_continuous(label = scales::percent)\nggsave(\"Figure4a.eps\", limitsize = FALSE,width = 8, height = 5, units = \"in\")\nggsave(\"Figure4a.pdf\", limitsize = FALSE,width = 8, height = 5, units = \"in\")\nggsave(\"Figure4a.png\", limitsize = FALSE, width = 8, height = 5, units = \"in\")\n\n\n\n\n\n\n\n\n\n\n\nCould work from home\nBased on Dingel & Niemen paper. A person’s occupation indicates the likelihood of if they could work from home.\n\n\nCode\n# teleworkable is numeric\n# CanWorkFromHome is categorical variable with 3 options. \n\n\nmapdataboth &lt;- joined %&gt;% \n  filter(CanWorkFromHome != \"NA\" )%&gt;% # create percentages withing missing values included. aka valid percent.\n   group_by(county_pop_type, YEAR, countyFIP, CanWorkFromHome) %&gt;% \n   dplyr::summarize(weightedcount=sum(PERWT), #weighted \n                    unweightedcount = n()\n                    ) %&gt;% \n   mutate(pct_weight = weightedcount/sum(weightedcount), \n          pct_noweight = unweightedcount/sum(unweightedcount))%&gt;%\n  full_join(countyIL, by = c(\"countyFIP\" = \"COUNTYFP\")) # %&gt;%\n    #mutate(pct_weight = ifelse(is.na(county_pop_type), 0.04486351, pct_weight))%&gt;%\n #  mutate(pct_weight = ifelse(is.na(county_pop_type), 0.09237573, pct_weight))# %&gt;%\n # mutate(did_wfh_labels = ifelse(is.na(did_wfh_labels),\"Rural\", did_wfh_labels))\nmapdataboth \nmapdataboth &lt;- svytable(~CanWorkFromHome+YEAR+countyFIP, design = dstrata)\n\nmapdataboth &lt;- mapdataboth %&gt;% as_tibble() %&gt;%\n   group_by(YEAR, countyFIP) %&gt;% \n     mutate(Prop = round(n/sum(n), digits =3)) %&gt;%\n   # filter(CanWorkFromHome == \"Can WFH\") %&gt;%\nfilter(YEAR == 2021 & CanWorkFromHome == \"Can WFH\")%&gt;%  \n\n     full_join(countyIL, by = c(\"countyFIP\" = \"COUNTYFP\"))\n\nmapdataboth %&gt;%\n  filter(CanWorkFromHome == \"Can WFH\") %&gt;%\n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  labs(title = \"Percent of county population that COULD work from home\", subtitle = \"Countyfips != 000\", caption = \"Note: Shows all counties with populations large enough to have their own values.\n                                                           Rural counties went from ...\n                                                           Counties had very small changes in occupations that COULD be done at work.\") + \n  facet_wrap(~YEAR)+\n  Alea_theme()+ \n scale_fill_binned(low= \"white\", high =\"darkblue\", \n                   na.value = \"gray\",\n                   show.limits=TRUE,\n                   nice.breaks=FALSE,\n                       n.breaks = 4,\n                        limits = c(0,.45),\n      label = scales::percent)\nFigure2a &lt;- mapdataboth %&gt;%\n#filter(YEAR == 2021 & CanWorkFromHome == \"Can WFH\")%&gt;%  \n  ggplot(aes(fill = Prop)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ \n  # labs(title = \"Work from Home Feasibility Rate\", \n  #      subtitle = \" Based on Occupation Characteristics\", \n  #      caption = \"Teleworkability based on D&N 2020 methodology. \n  #      OCCSOC codes from ACS 1 year Survey data at individual level.\") +\n theme_void() + \n  theme(axis.ticks = element_blank(), axis.text = element_blank(),   \n        plot.title = element_text(hjust = 0.5), plot.caption = element_text(hjust=.5),  \n        plot.subtitle = element_text(hjust = 0.5)) +\n scale_fill_binned(low= \"white\", high =\"darkblue\", \n                   na.value = \"gray\",\n                   show.limits=TRUE,\n                   nice.breaks=FALSE,\n                       n.breaks = 4,\n                       limits = c(0,.6),\n                        name = \"Labor Force with\\nWFH Feasibility\", \n                       label = scales::percent)\n\nFigure2a\n# ggsave(\"Figure2a.eps\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n# ggsave(\"Figure2a.pdf\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\nggsave(\"Figure2a.png\", limitsize = FALSE, width = 8, height = 4, units = \"in\")\n\nFigure2b\n# ggsave(\"Figure2b.eps\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\n# ggsave(\"Figure2b.pdf\", limitsize = FALSE,width = 8, height = 4, units = \"in\")\nggsave(\"Figure2b.png\", limitsize = FALSE, width = 8, height = 4, units = \"in\")\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmapdataboth &lt;- joined %&gt;% \n # filter(CanWorkFromHome != \"NA\" )%&gt;% # create percentages withing missing values included. aka valid percent.\n   group_by(county_pop_type, YEAR, countyFIP) %&gt;% \n   dplyr::summarize(weightedcount=sum(PERWT), #weighted \n                    unweightedcount = n(),\n                    mean_telework = mean(teleworkable, na.rm=TRUE, weight = PERWT)\n                    ) %&gt;% \n   mutate(pct_weight = weightedcount/sum(weightedcount), \n          pct_noweight = unweightedcount/sum(unweightedcount)) %&gt;%\n  full_join(countyIL, by = c(\"countyFIP\" = \"COUNTYFP\"))  %&gt;%\n    mutate(mean_telework = ifelse(is.na(county_pop_type), 0.2941470, mean_telework))\n #  mutate(pct_weight = ifelse(is.na(county_pop_type), 0.09237573, pct_weight))# %&gt;%\n # mutate(did_wfh_labels = ifelse(is.na(did_wfh_labels),\"Rural\", did_wfh_labels))\nmapdataboth\n\n\n\n  \n\n\nmapdataboth %&gt;%\n  filter(YEAR != \"NA\") %&gt;%\n  ggplot(aes(fill = mean_telework)) +\n  geom_sf(aes(geometry = geometry), color = \"black\")+ labs(title = \"Average teleworkable score for each County\", subtitle = \"Countyfips != 000\", caption = \"Note: Shows all counties with populations large enough to have their own values.\n                                                           Uses teleworkable, a continuous variable, instead of CanWorkFromHome.\n                                                           Counties had very small changes in occupations that COULD be done at work.\") + \n  facet_wrap(~YEAR)+ \n  Alea_theme()+\n scale_fill_binned(low= \"white\", high =\"darkblue\", \n                   na.value = \"gray\",\n                   show.limits=TRUE,\n                   nice.breaks=FALSE,\n                       n.breaks = 4, \n                   label = scales::percent)\n\n\n\n\n\n\nGeography Variable Notes\nPUMAS vs COMMZONE vs COUNTIES\nLink from Francis on COMZONE variable (Commuter Zones)\nInteractive ESRI Map of all PUMA outlines\nArticle on calculating mean income for groups of geographies with ACS data\n\n# State worked in:\n#0=NA, 17=Illinois\n\n\n\n# ipums_var_desc(data, PWSTATE2)\n\njoined &lt;- joined %&gt;% \n  mutate(PWSTATE2_clean = as_factor(lbl_na_if(PWSTATE2, ~.val %in% c(0))))\n\njoined %&gt;% \n dplyr::group_by(YEAR) %&gt;%\n  dplyr::summarize(workers=sum(PERWT)) %&gt;% #number of people that match that observation\n  dplyr::ungroup()%&gt;%\n dplyr:: group_by(YEAR,PWSTATE2_clean)%&gt;%\n  mutate(pct = n()/workers)%&gt;% \n  arrange(desc(pct))"
  }
]